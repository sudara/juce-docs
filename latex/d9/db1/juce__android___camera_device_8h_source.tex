\hypertarget{juce__android___camera_device_8h_source}{}\doxysection{juce\+\_\+android\+\_\+\+Camera\+Device.\+h}
\label{juce__android___camera_device_8h_source}\index{build/juce\_video/native/juce\_android\_CameraDevice.h@{build/juce\_video/native/juce\_android\_CameraDevice.h}}
\mbox{\hyperlink{juce__android___camera_device_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{   This file is part of the JUCE library.}}
\DoxyCodeLine{5 \textcolor{comment}{   Copyright (c) 2020 -\/ Raw Material Software Limited}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{   JUCE is an open source library subject to commercial or open-\/source}}
\DoxyCodeLine{8 \textcolor{comment}{   licensing.}}
\DoxyCodeLine{9 \textcolor{comment}{}}
\DoxyCodeLine{10 \textcolor{comment}{   By using JUCE, you agree to the terms of both the JUCE 6 End-\/User License}}
\DoxyCodeLine{11 \textcolor{comment}{   Agreement and JUCE Privacy Policy (both effective as of the 16th June 2020).}}
\DoxyCodeLine{12 \textcolor{comment}{}}
\DoxyCodeLine{13 \textcolor{comment}{   End User License Agreement: www.juce.com/juce-\/6-\/licence}}
\DoxyCodeLine{14 \textcolor{comment}{   Privacy Policy: www.juce.com/juce-\/privacy-\/policy}}
\DoxyCodeLine{15 \textcolor{comment}{}}
\DoxyCodeLine{16 \textcolor{comment}{   Or: You may also use this code under the terms of the GPL v3 (see}}
\DoxyCodeLine{17 \textcolor{comment}{   www.gnu.org/licenses).}}
\DoxyCodeLine{18 \textcolor{comment}{}}
\DoxyCodeLine{19 \textcolor{comment}{   JUCE IS PROVIDED "{}AS IS"{} WITHOUT ANY WARRANTY, AND ALL WARRANTIES, WHETHER}}
\DoxyCodeLine{20 \textcolor{comment}{   EXPRESSED OR IMPLIED, INCLUDING MERCHANTABILITY AND FITNESS FOR PURPOSE, ARE}}
\DoxyCodeLine{21 \textcolor{comment}{   DISCLAIMED.}}
\DoxyCodeLine{22 \textcolor{comment}{}}
\DoxyCodeLine{23 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{24 \textcolor{comment}{*/}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{27 \textcolor{comment}{// This byte-\/code is generated from:}}
\DoxyCodeLine{28 \textcolor{comment}{//}}
\DoxyCodeLine{29 \textcolor{comment}{// native/java/com/rmsl/juce/CameraCaptureSessionCaptureCallback.java}}
\DoxyCodeLine{30 \textcolor{comment}{// native/java/com/rmsl/juce/CameraCaptureSessionStateCallback.java}}
\DoxyCodeLine{31 \textcolor{comment}{// native/java/com/rmsl/juce/CameraDeviceStateCallback.java}}
\DoxyCodeLine{32 \textcolor{comment}{// native/java/com/rmsl/juce/JuceOrientationEventListener.java}}
\DoxyCodeLine{33 \textcolor{comment}{//}}
\DoxyCodeLine{34 \textcolor{comment}{// files with min sdk version 21}}
\DoxyCodeLine{35 \textcolor{comment}{// See juce\_core/native/java/README.txt on how to generate this byte-\/code.}}
\DoxyCodeLine{36 \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{juce__box2d_8cpp_a4a0dc603b03692b2e16aca65cd3f7c35}{uint8}} CameraSupportByteCode[] =}
\DoxyCodeLine{37 \{31,139,8,8,187,110,161,94,0,3,67,97,109,101,114,97,83,117,112,112,111,114,116,66,121,116,101,67,111,100,101,46,100,101,120,0,}
\DoxyCodeLine{38 149,152,93,108,28,213,21,199,207,157,157,221,89,239,174,215,227,181,243,217,36,56,95,182,3,113,54,137,227,40,101,29,59,198,113,}
\DoxyCodeLine{39 192,102,133,169,215,182,34,3,45,147,221,73,188,176,222,89,102,215,139,171,86,37,68,84,208,151,42,80,90,168,4,136,170,20,181,15,}
\DoxyCodeLine{40 84,110,9,132,7,30,82,21,149,240,0,10,136,190,165,18,84,133,7,154,7,132,42,20,85,60,244,127,63,198,158,93,175,93,99,233,183,}
\DoxyCodeLine{41 255,51,115,206,61,247,222,115,239,140,103,38,103,47,68,14,246,246,209,213,103,22,174,255,247,133,96,249,25,246,233,195,151,255,}
\DoxyCodeLine{42 18,189,241,193,31,255,57,248,226,196,252,238,238,4,81,137,136,22,166,143,192,146,127,79,181,18,157,38,121,190,13,92,99,68,91,}
\DoxyCodeLine{43 160,219,52,162,32,244,174,0,81,55,247,67,117,232,34,126,110,198,136,14,194,249,86,152,232,10,248,2,36,154,136,14,131,62,112,12,}
\DoxyCodeLine{44 220,7,170,224,50,248,26,116,69,136,190,15,158,4,127,6,255,0,70,148,232,40,248,1,120,22,188,11,190,2,29,200,191,27,116,129,219,}
\DoxyCodeLine{45 120,95,160,15,164,192,9,112,39,24,7,167,193,131,32,7,242,192,1,85,240,99,240,24,120,18,252,22,188,7,110,128,182,102,162,65,48,7,}
\DoxyCodeLine{46 158,6,175,129,143,192,87,160,57,78,212,9,70,192,3,160,10,30,3,191,6,47,131,63,128,55,193,219,224,93,240,33,248,12,124,13,162,}
\DoxyCodeLine{47 45,68,123,193,16,200,128,7,64,9,252,4,252,28,60,7,126,3,46,131,43,224,125,112,29,124,6,254,13,254,3,190,1,97,147,168,21,236,2,}
\DoxyCodeLine{48 221,166,172,55,95,3,3,160,196,132,50,18,202,70,40,17,97,58,132,97,19,186,39,52,37,132,19,150,146,18,106,29,219,193,6,176,17,}
\DoxyCodeLine{49 116,42,109,85,107,190,73,217,139,72,188,89,217,111,25,114,221,185,125,5,246,119,148,125,21,246,86,101,127,236,179,175,251,98,}
\DoxyCodeLine{50 254,5,123,155,178,191,132,189,93,217,55,97,239,80,182,142,9,220,162,236,118,216,29,202,222,227,179,143,248,236,147,176,119,41,}
\DoxyCodeLine{51 123,18,246,78,101,223,239,59,159,131,189,91,217,5,216,123,148,189,0,123,175,178,159,240,217,23,125,246,11,190,156,191,247,229,}
\DoxyCodeLine{52 92,12,243,186,50,234,23,245,77,208,184,168,177,60,110,81,106,42,13,168,122,234,74,67,74,99,98,69,120,251,176,210,56,237,19,26,}
\DoxyCodeLine{53 163,91,133,54,211,109,66,155,104,191,208,8,245,8,141,210,1,161,27,105,80,104,59,157,16,186,129,134,132,182,210,29,106,92,195,66,}
\DoxyCodeLine{54 219,232,164,24,159,38,250,137,99,183,116,43,77,42,61,168,244,144,210,195,66,77,26,80,58,162,244,148,210,59,149,166,197,124,}
\DoxyCodeLine{55 101,222,22,204,172,87,233,17,161,6,245,169,227,163,66,55,137,60,92,239,18,186,153,70,213,241,152,168,151,172,144,137,138,29,83,}
\DoxyCodeLine{56 245,187,155,228,254,101,190,58,50,165,31,155,164,230,35,207,121,245,213,148,38,212,70,110,81,126,175,238,94,158,83,202,111,}
\DoxyCodeLine{57 42,127,172,110,125,92,229,15,34,51,247,247,154,242,250,42,153,60,126,6,151,208,253,237,12,189,199,224,231,215,222,113,83,230,}
\DoxyCodeLine{58 200,92,32,154,122,130,145,241,184,241,75,227,85,227,114,213,8,146,63,238,212,170,113,161,154,184,241,85,227,12,17,23,193,76,248,}
\DoxyCodeLine{59 88,79,155,242,90,207,184,136,171,32,238,17,227,167,236,87,213,80,88,68,201,245,228,227,126,208,203,247,52,226,126,129,184,139,}
\DoxyCodeLine{60 198,43,236,13,253,111,213,112,147,136,74,160,87,126,223,200,155,178,166,153,63,33,238,117,196,45,26,239,24,127,215,63,15,226,}
\DoxyCodeLine{61 198,83,141,68,68,172,142,190,121,77,202,166,172,87,201,100,162,38,154,240,105,98,45,126,164,124,153,14,141,74,39,18,164,29,90,}
\DoxyCodeLine{62 246,93,168,241,181,213,248,126,86,227,107,175,241,93,172,241,109,168,241,61,87,227,219,168,124,114,156,47,45,141,83,19,227,12,}
\DoxyCodeLine{63 248,198,249,234,82,187,0,218,109,175,201,249,90,141,111,135,240,5,145,147,223,111,47,249,125,147,183,212,180,123,187,166,93,}
\DoxyCodeLine{64 135,240,133,68,75,162,191,122,99,57,24,160,161,224,76,66,247,141,229,253,165,118,58,218,117,138,118,222,126,103,10,205,119,61,}
\DoxyCodeLine{65 48,181,219,229,185,160,82,67,249,12,159,47,33,242,115,13,146,252,127,225,217,222,181,33,143,155,136,137,76,203,199,225,154,248,}
\DoxyCodeLine{66 38,177,71,252,199,81,213,135,55,174,160,178,131,106,140,94,31,242,255,148,204,31,80,118,120,41,70,230,245,236,168,106,99,168,}
\DoxyCodeLine{67 92,92,67,253,249,98,190,50,64,221,195,214,156,237,90,195,86,169,50,239,218,25,187,92,206,59,69,117,52,108,21,10,103,172,236,195,}
\DoxyCodeLine{68 7,30,178,170,22,117,54,138,204,84,172,74,93,220,14,25,119,210,174,230,179,118,3,63,27,37,54,70,59,199,230,179,246,184,155,}
\DoxyCodeLine{69 183,139,136,64,162,145,42,172,116,190,92,177,139,182,43,3,183,164,173,98,206,117,242,185,100,214,41,226,124,37,57,204,117,161,}
\DoxyCodeLine{70 146,162,193,37,215,172,229,230,30,181,92,59,153,21,189,30,78,54,26,229,158,186,9,165,232,248,183,76,80,51,143,20,37,191,93,243,}
\DoxyCodeLine{71 20,245,253,191,6,178,92,245,253,116,173,175,89,138,246,173,21,40,134,114,202,202,23,32,235,9,157,176,31,153,183,203,40,115,247,}
\DoxyCodeLine{72 58,66,203,243,5,68,246,172,30,57,233,84,172,66,93,248,242,188,170,121,251,209,228,106,251,32,69,189,233,172,51,151,116,231,}
\DoxyCodeLine{73 202,133,228,67,216,48,13,171,187,98,113,15,173,163,81,93,161,247,53,108,210,96,15,167,104,127,93,232,90,27,57,69,108,154,180,}
\DoxyCodeLine{74 233,81,48,70,129,233,177,81,254,147,38,29,63,194,156,161,32,126,96,135,132,140,145,193,53,61,54,38,79,164,211,104,152,70,32,34,}
\DoxyCodeLine{75 244,105,238,15,78,11,47,14,224,99,51,20,146,85,166,173,217,6,115,28,202,86,242,85,155,246,52,242,121,69,115,230,74,5,187,98,231,}
\DoxyCodeLine{76 104,231,26,81,124,239,32,100,239,26,33,247,186,206,57,23,103,16,118,235,26,97,25,190,181,138,89,123,232,140,227,242,94,247,}
\DoxyCodeLine{77 175,35,118,121,140,187,214,138,174,88,34,99,195,74,12,23,28,62,178,221,13,125,78,241,108,254,220,242,44,119,172,25,148,163,45,}
\DoxyCodeLine{78 141,252,19,182,149,251,33,109,202,174,216,54,178,227,237,43,28,39,243,101,220,213,138,118,150,143,121,227,10,247,136,235,58,}
\DoxyCodeLine{79 110,131,124,227,37,108,171,28,25,89,121,39,164,205,57,225,243,237,191,225,89,171,120,14,33,65,91,164,48,206,202,235,158,162,103,}
\DoxyCodeLine{80 93,36,187,103,126,238,140,237,146,62,235,148,43,212,196,127,39,157,169,178,77,225,165,221,146,104,176,55,90,234,119,66,91,}
\DoxyCodeLine{81 163,117,223,188,234,42,111,93,99,77,205,21,43,24,94,90,175,214,149,171,19,171,89,139,184,83,172,41,164,129,235,79,76,27,57,84,}
\DoxyCodeLine{82 169,218,97,173,172,142,225,45,89,212,89,118,82,115,9,35,200,91,5,121,155,34,163,228,218,252,254,68,186,139,210,147,225,202,251,}
\DoxyCodeLine{83 34,133,92,233,143,148,213,108,70,145,176,44,55,2,181,148,103,157,249,66,238,14,84,70,53,174,204,230,203,212,84,201,207,161,173,}
\DoxyCodeLine{84 53,87,162,30,109,96,218,136,247,247,244,208,209,192,212,68,198,136,95,162,126,24,41,110,12,195,24,231,198,168,54,53,105,196,}
\DoxyCodeLine{85 127,71,227,129,169,201,126,126,98,90,159,154,56,13,235,35,218,207,6,120,115,234,101,83,70,124,134,190,43,101,80,202,136,148,187,}
\DoxyCodeLine{86 165,116,169,208,3,172,155,31,30,145,114,187,214,125,59,215,19,242,176,51,48,112,236,123,70,252,56,15,187,135,159,32,13,15,}
\DoxyCodeLine{87 207,26,211,244,243,231,245,197,8,187,128,167,188,6,68,217,181,8,99,55,193,203,81,198,174,130,47,193,243,49,98,161,160,166,181,}
\DoxyCodeLine{88 162,237,59,177,70,237,54,177,79,98,140,125,3,158,111,102,236,18,184,134,151,191,160,30,208,182,161,205,141,230,250,248,157,236,}
\DoxyCodeLine{89 169,56,99,175,128,43,224,58,30,225,52,166,107,123,31,63,175,223,140,115,127,23,123,182,69,190,215,120,207,117,158,122,223,88,}
\DoxyCodeLine{90 248,51,143,247,157,133,63,19,121,223,90,188,119,125,254,189,133,171,247,205,37,68,203,223,93,88,135,124,175,231,223,94,152,41,}
\DoxyCodeLine{91 223,221,249,59,188,214,33,243,243,239,49,1,21,195,223,105,248,203,52,111,43,222,167,76,57,14,254,189,231,127,249,28,121,55,40,18,}
\DoxyCodeLine{92 0,0,0,0\};}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK)    \(\backslash\)}}
\DoxyCodeLine{95 \textcolor{preprocessor}{ STATICMETHOD (valueOf, "{}valueOf"{}}, "{}(Ljava/lang/String;)Landroid/graphics/Bitmap\$CompressFormat;"{})}
\DoxyCodeLine{96 }
\DoxyCodeLine{97 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidBitmapCompressFormat, \textcolor{stringliteral}{"{}android/graphics/Bitmap\$CompressFormat"{}}, 21)}
\DoxyCodeLine{98 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{101 \textcolor{preprocessor}{ METHOD (close,                "{}close"{}},                "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{102  METHOD (createCaptureRequest, "{}createCaptureRequest"{}, "{}(I)Landroid/hardware/camera2/CaptureRequest\$Builder;"{}) \(\backslash\)}
\DoxyCodeLine{103  METHOD (createCaptureSession, "{}createCaptureSession"{}, "{}(Ljava/util/List;Landroid/hardware/camera2/CameraCaptureSession\$StateCallback;Landroid/os/Handler;)V"{})}
\DoxyCodeLine{104 }
\DoxyCodeLine{105 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidCameraDevice, \textcolor{stringliteral}{"{}android/hardware/camera2/CameraDevice"{}}, 21)}
\DoxyCodeLine{106 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{109 \textcolor{preprocessor}{ METHOD (close,     "{}close"{}},     "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{110  METHOD (getPlanes, "{}getPlanes"{}, "{}()[Landroid/media/Image\$Plane;"{})}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidImage, \textcolor{stringliteral}{"{}android/media/Image"{}}, 21)}
\DoxyCodeLine{113 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{116 \textcolor{preprocessor}{ METHOD (getBuffer, "{}getBuffer"{}}, "{}()Ljava/nio/ByteBuffer;"{})}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidImagePlane, \textcolor{stringliteral}{"{}android/media/Image\$Plane"{}}, 21)}
\DoxyCodeLine{119 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{122 \textcolor{preprocessor}{ METHOD (acquireLatestImage,          "{}acquireLatestImage"{}},          "{}()Landroid/media/Image;"{}) \(\backslash\)}
\DoxyCodeLine{123  METHOD (close,                       "{}close"{},                       "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{124  METHOD (getSurface,                  "{}getSurface"{},                  "{}()Landroid/view/Surface;"{}) \(\backslash\)}
\DoxyCodeLine{125  METHOD (setOnImageAvailableListener, "{}setOnImageAvailableListener"{}, "{}(Landroid/media/ImageReader\$OnImageAvailableListener;Landroid/os/Handler;)V"{}) \(\backslash\)}
\DoxyCodeLine{126  STATICMETHOD (newInstance, "{}newInstance"{}, "{}(IIII)Landroid/media/ImageReader;"{})}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidImageReader, \textcolor{stringliteral}{"{}android/media/ImageReader"{}}, 21)}
\DoxyCodeLine{129 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{132 \textcolor{preprocessor}{ METHOD (constructor,             "{}<init>"{}},                  "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{133  METHOD (getSurface,              "{}getSurface"{},              "{}()Landroid/view/Surface;"{}) \(\backslash\)}
\DoxyCodeLine{134  METHOD (prepare,                 "{}prepare"{},                 "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{135  METHOD (release,                 "{}release"{},                 "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{136  METHOD (setAudioEncoder,         "{}setAudioEncoder"{},         "{}(I)V"{}) \(\backslash\)}
\DoxyCodeLine{137  METHOD (setAudioSource,          "{}setAudioSource"{},          "{}(I)V"{}) \(\backslash\)}
\DoxyCodeLine{138  METHOD (setOnErrorListener,      "{}setOnErrorListener"{},      "{}(Landroid/media/MediaRecorder\$OnErrorListener;)V"{}) \(\backslash\)}
\DoxyCodeLine{139  METHOD (setOnInfoListener,       "{}setOnInfoListener"{},       "{}(Landroid/media/MediaRecorder\$OnInfoListener;)V"{}) \(\backslash\)}
\DoxyCodeLine{140  METHOD (setOrientationHint,      "{}setOrientationHint"{},      "{}(I)V"{}) \(\backslash\)}
\DoxyCodeLine{141  METHOD (setOutputFile,           "{}setOutputFile"{},           "{}(Ljava/lang/String;)V"{}) \(\backslash\)}
\DoxyCodeLine{142  METHOD (setOutputFormat,         "{}setOutputFormat"{},         "{}(I)V"{}) \(\backslash\)}
\DoxyCodeLine{143  METHOD (setVideoEncoder,         "{}setVideoEncoder"{},         "{}(I)V"{}) \(\backslash\)}
\DoxyCodeLine{144  METHOD (setVideoEncodingBitRate, "{}setVideoEncodingBitRate"{}, "{}(I)V"{}) \(\backslash\)}
\DoxyCodeLine{145  METHOD (setVideoFrameRate,       "{}setVideoFrameRate"{},       "{}(I)V"{}) \(\backslash\)}
\DoxyCodeLine{146  METHOD (setVideoSize,            "{}setVideoSize"{},            "{}(II)V"{}) \(\backslash\)}
\DoxyCodeLine{147  METHOD (setVideoSource,          "{}setVideoSource"{},          "{}(I)V"{}) \(\backslash\)}
\DoxyCodeLine{148  METHOD (start,                   "{}start"{},                   "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{149  METHOD (stop,                    "{}stop"{},                    "{}()V"{})}
\DoxyCodeLine{150 }
\DoxyCodeLine{151 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidMediaRecorder, \textcolor{stringliteral}{"{}android/media/MediaRecorder"{}}, 21)}
\DoxyCodeLine{152 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{155 \textcolor{preprocessor}{ METHOD (constructor,               "{}<init>"{}},                    "{}(Landroid/content/Context;)V"{}) \(\backslash\)}
\DoxyCodeLine{156  METHOD (getSurfaceTexture,         "{}getSurfaceTexture"{},         "{}()Landroid/graphics/SurfaceTexture;"{}) \(\backslash\)}
\DoxyCodeLine{157  METHOD (isAvailable,               "{}isAvailable"{},               "{}()Z"{}) \(\backslash\)}
\DoxyCodeLine{158  METHOD (setSurfaceTextureListener, "{}setSurfaceTextureListener"{}, "{}(Landroid/view/TextureView\$SurfaceTextureListener;)V"{}) \(\backslash\)}
\DoxyCodeLine{159  METHOD (setTransform,              "{}setTransform"{},              "{}(Landroid/graphics/Matrix;)V"{})}
\DoxyCodeLine{160 }
\DoxyCodeLine{161 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidTextureView, \textcolor{stringliteral}{"{}android/view/TextureView"{}}, 21)}
\DoxyCodeLine{162 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{165 \textcolor{preprocessor}{ METHOD (constructor, "{}<init>"{}}, "{}(Landroid/graphics/SurfaceTexture;)V"{})}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidSurface, \textcolor{stringliteral}{"{}android/view/Surface"{}}, 21)}
\DoxyCodeLine{168 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{169 }
\DoxyCodeLine{170 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{171 \textcolor{preprocessor}{ METHOD (setDefaultBufferSize, "{}setDefaultBufferSize"{}}, "{}(II)V"{})}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidSurfaceTexture, \textcolor{stringliteral}{"{}android/graphics/SurfaceTexture"{}}, 21)}
\DoxyCodeLine{174 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{175 }
\DoxyCodeLine{176 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{177 \textcolor{preprocessor}{ METHOD (getOutputSizesForClass,      "{}getOutputSizes"{}},       "{}(Ljava/lang/Class;)[Landroid/util/Size;"{}) \(\backslash\)}
\DoxyCodeLine{178  METHOD (getOutputSizesForFormat,     "{}getOutputSizes"{},       "{}(I)[Landroid/util/Size;"{}) \(\backslash\)}
\DoxyCodeLine{179  METHOD (isOutputSupportedFor,        "{}isOutputSupportedFor"{}, "{}(I)Z"{}) \(\backslash\)}
\DoxyCodeLine{180  METHOD (isOutputSupportedForSurface, "{}isOutputSupportedFor"{}, "{}(Landroid/view/Surface;)Z"{})}
\DoxyCodeLine{181 }
\DoxyCodeLine{182 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (AndroidStreamConfigurationMap, \textcolor{stringliteral}{"{}android/hardware/camera2/params/StreamConfigurationMap"{}}, 21)}
\DoxyCodeLine{183 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{184 }
\DoxyCodeLine{185 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{186 \textcolor{preprocessor}{ METHOD (constructor, "{}<init>"{}},      "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{187  METHOD (toByteArray, "{}toByteArray"{}, "{}()[B"{}) \(\backslash\)}
\DoxyCodeLine{188  METHOD (size,        "{}size"{},        "{}()I"{})}
\DoxyCodeLine{189 }
\DoxyCodeLine{190 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (ByteArrayOutputStream, \textcolor{stringliteral}{"{}java/io/ByteArrayOutputStream"{}}, 21)}
\DoxyCodeLine{191 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{192 }
\DoxyCodeLine{193 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{194 \textcolor{preprocessor}{ METHOD (abortCaptures,       "{}abortCaptures"{}},       "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{195  METHOD (capture,             "{}capture"{},             "{}(Landroid/hardware/camera2/CaptureRequest;Landroid/hardware/camera2/CameraCaptureSession\$CaptureCallback;Landroid/os/Handler;)I"{}) \(\backslash\)}
\DoxyCodeLine{196  METHOD (close,               "{}close"{},               "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{197  METHOD (setRepeatingRequest, "{}setRepeatingRequest"{}, "{}(Landroid/hardware/camera2/CaptureRequest;Landroid/hardware/camera2/CameraCaptureSession\$CaptureCallback;Landroid/os/Handler;)I"{}) \(\backslash\)}
\DoxyCodeLine{198  METHOD (stopRepeating,       "{}stopRepeating"{},       "{}()V"{})}
\DoxyCodeLine{199 }
\DoxyCodeLine{200 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CameraCaptureSession, \textcolor{stringliteral}{"{}android/hardware/camera2/CameraCaptureSession"{}}, 21)}
\DoxyCodeLine{201 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{202 }
\DoxyCodeLine{203 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{204 \textcolor{preprocessor}{ METHOD (get,     "{}get"{}},     "{}(Landroid/hardware/camera2/CameraCharacteristics\$Key;)Ljava/lang/Object;"{}) \(\backslash\)}
\DoxyCodeLine{205  METHOD (getKeys, "{}getKeys"{}, "{}()Ljava/util/List;"{}) \(\backslash\)}
\DoxyCodeLine{206  STATICFIELD (CONTROL\_AF\_AVAILABLE\_MODES,      "{}CONTROL\_AF\_AVAILABLE\_MODES"{},      "{}Landroid/hardware/camera2/CameraCharacteristics\$Key;"{}) \(\backslash\)}
\DoxyCodeLine{207  STATICFIELD (LENS\_FACING,                     "{}LENS\_FACING"{},                     "{}Landroid/hardware/camera2/CameraCharacteristics\$Key;"{}) \(\backslash\)}
\DoxyCodeLine{208  STATICFIELD (SCALER\_STREAM\_CONFIGURATION\_MAP, "{}SCALER\_STREAM\_CONFIGURATION\_MAP"{}, "{}Landroid/hardware/camera2/CameraCharacteristics\$Key;"{}) \(\backslash\)}
\DoxyCodeLine{209  STATICFIELD (SENSOR\_ORIENTATION,              "{}SENSOR\_ORIENTATION"{},              "{}Landroid/hardware/camera2/CameraCharacteristics\$Key;"{})}
\DoxyCodeLine{210 }
\DoxyCodeLine{211 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CameraCharacteristics, \textcolor{stringliteral}{"{}android/hardware/camera2/CameraCharacteristics"{}}, 21)}
\DoxyCodeLine{212 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{213 }
\DoxyCodeLine{214 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{215 \textcolor{preprocessor}{ METHOD (getName, "{}getName"{}}, "{}()Ljava/lang/String;"{})}
\DoxyCodeLine{216 }
\DoxyCodeLine{217 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CameraCharacteristicsKey, \textcolor{stringliteral}{"{}android/hardware/camera2/CameraCharacteristics\$Key"{}}, 21)}
\DoxyCodeLine{218 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{219 }
\DoxyCodeLine{220 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{221 \textcolor{preprocessor}{ METHOD (getCameraCharacteristics, "{}getCameraCharacteristics"{}}, "{}(Ljava/lang/String;)Landroid/hardware/camera2/CameraCharacteristics;"{}) \(\backslash\)}
\DoxyCodeLine{222  METHOD (getCameraIdList,          "{}getCameraIdList"{},          "{}()[Ljava/lang/String;"{}) \(\backslash\)}
\DoxyCodeLine{223  METHOD (openCamera,               "{}openCamera"{},               "{}(Ljava/lang/String;Landroid/hardware/camera2/CameraDevice\$StateCallback;Landroid/os/Handler;)V"{})}
\DoxyCodeLine{224 }
\DoxyCodeLine{225 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CameraManager, \textcolor{stringliteral}{"{}android/hardware/camera2/CameraManager"{}}, 21)}
\DoxyCodeLine{226 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{229 \textcolor{preprocessor}{ STATICFIELD (CONTROL\_AE\_PRECAPTURE\_TRIGGER, "{}CONTROL\_AE\_PRECAPTURE\_TRIGGER"{}}, "{}Landroid/hardware/camera2/CaptureRequest\$Key;"{}) \(\backslash\)}
\DoxyCodeLine{230  STATICFIELD (CONTROL\_AF\_MODE,               "{}CONTROL\_AF\_MODE"{},               "{}Landroid/hardware/camera2/CaptureRequest\$Key;"{}) \(\backslash\)}
\DoxyCodeLine{231  STATICFIELD (CONTROL\_AF\_TRIGGER,            "{}CONTROL\_AF\_TRIGGER"{},            "{}Landroid/hardware/camera2/CaptureRequest\$Key;"{}) \(\backslash\)}
\DoxyCodeLine{232  STATICFIELD (CONTROL\_MODE,                  "{}CONTROL\_MODE"{},                  "{}Landroid/hardware/camera2/CaptureRequest\$Key;"{})}
\DoxyCodeLine{233 }
\DoxyCodeLine{234 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CaptureRequest, \textcolor{stringliteral}{"{}android/hardware/camera2/CaptureRequest"{}}, 21)}
\DoxyCodeLine{235 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{236 }
\DoxyCodeLine{237 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{238 \textcolor{preprocessor}{ METHOD (addTarget, "{}addTarget"{}}, "{}(Landroid/view/Surface;)V"{}) \(\backslash\)}
\DoxyCodeLine{239  METHOD (build,     "{}build"{},     "{}()Landroid/hardware/camera2/CaptureRequest;"{}) \(\backslash\)}
\DoxyCodeLine{240  METHOD (set,       "{}set"{},       "{}(Landroid/hardware/camera2/CaptureRequest\$Key;Ljava/lang/Object;)V"{})}
\DoxyCodeLine{241 }
\DoxyCodeLine{242 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CaptureRequestBuilder, \textcolor{stringliteral}{"{}android/hardware/camera2/CaptureRequest\$Builder"{}}, 21)}
\DoxyCodeLine{243 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{244 }
\DoxyCodeLine{245 \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{246 \textcolor{preprocessor}{ METHOD (get, "{}get"{}}, "{}(Landroid/hardware/camera2/CaptureResult\$Key;)Ljava/lang/Object;"{}) \(\backslash\)}
\DoxyCodeLine{247  STATICFIELD (CONTROL\_AE\_STATE, "{}CONTROL\_AE\_STATE"{}, "{}Landroid/hardware/camera2/CaptureResult\$Key;"{}) \(\backslash\)}
\DoxyCodeLine{248  STATICFIELD (CONTROL\_AF\_STATE, "{}CONTROL\_AF\_STATE"{}, "{}Landroid/hardware/camera2/CaptureResult\$Key;"{})}
\DoxyCodeLine{249 }
\DoxyCodeLine{250 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CaptureResult, \textcolor{stringliteral}{"{}android/hardware/camera2/CaptureResult"{}}, 21)}
\DoxyCodeLine{251 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{254 \textcolor{keyword}{class }\mbox{\hyperlink{class_android_runnable}{AndroidRunnable}}  : \textcolor{keyword}{public} \mbox{\hyperlink{classjuce_1_1_android_interface_implementer}{juce::AndroidInterfaceImplementer}}}
\DoxyCodeLine{255 \{}
\DoxyCodeLine{256 \textcolor{keyword}{public}:}
\DoxyCodeLine{257     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_android_runnable_1_1_owner}{Owner}}}
\DoxyCodeLine{258     \{}
\DoxyCodeLine{259         \textcolor{keyword}{virtual} \mbox{\hyperlink{struct_android_runnable_1_1_owner_a7cf2f4e7a23b6503aa4b04f803db16ba}{\string~Owner}}() \{\}}
\DoxyCodeLine{260 }
\DoxyCodeLine{261         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_android_runnable_1_1_owner_a94ad1101de8d1f6f6a65e5b741552ed3}{run}}() = 0;}
\DoxyCodeLine{262     \};}
\DoxyCodeLine{263 }
\DoxyCodeLine{264     \mbox{\hyperlink{class_android_runnable_ac951d4ffd3848cf47b6453f8336b89d1}{AndroidRunnable}} (\mbox{\hyperlink{struct_android_runnable_1_1_owner}{Owner}}\& ownerToUse)}
\DoxyCodeLine{265         : owner (ownerToUse)}
\DoxyCodeLine{266     \{\}}
\DoxyCodeLine{267 }
\DoxyCodeLine{268 \textcolor{keyword}{private}:}
\DoxyCodeLine{269     Owner\& owner;}
\DoxyCodeLine{270 }
\DoxyCodeLine{271     jobject invoke (jobject proxy, jobject method, jobjectArray args)\textcolor{keyword}{ override}}
\DoxyCodeLine{272 \textcolor{keyword}{    }\{}
\DoxyCodeLine{273         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{274         \textcolor{keyword}{auto} methodName = juce::juceString ((jstring) env-\/>CallObjectMethod (method, JavaMethod.getName));}
\DoxyCodeLine{275 }
\DoxyCodeLine{276         \textcolor{keywordflow}{if} (methodName == \textcolor{stringliteral}{"{}run"{}})}
\DoxyCodeLine{277         \{}
\DoxyCodeLine{278             owner.run();}
\DoxyCodeLine{279             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{280         \}}
\DoxyCodeLine{281 }
\DoxyCodeLine{282         \textcolor{comment}{// invoke base class}}
\DoxyCodeLine{283         \textcolor{keywordflow}{return} AndroidInterfaceImplementer::invoke (proxy, method, args);}
\DoxyCodeLine{284     \}}
\DoxyCodeLine{285 \};}
\DoxyCodeLine{286 }
\DoxyCodeLine{287 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{288 \textcolor{keyword}{class }\mbox{\hyperlink{class_texture_view_surface_texture_listener}{TextureViewSurfaceTextureListener}}     : \textcolor{keyword}{public} AndroidInterfaceImplementer}
\DoxyCodeLine{289 \{}
\DoxyCodeLine{290 \textcolor{keyword}{public}:}
\DoxyCodeLine{291     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_texture_view_surface_texture_listener_1_1_owner}{Owner}}}
\DoxyCodeLine{292     \{}
\DoxyCodeLine{293         \textcolor{keyword}{virtual} \mbox{\hyperlink{struct_texture_view_surface_texture_listener_1_1_owner_a8974f1e161f8189c4903dac07a68c7f1}{\string~Owner}}() \{\}}
\DoxyCodeLine{294 }
\DoxyCodeLine{295         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_texture_view_surface_texture_listener_1_1_owner_a58e3a75b6f266d56eec5daa556b7f2fe}{onSurfaceTextureAvailable}} (LocalRef<jobject>\& surface, \textcolor{keywordtype}{int} \mbox{\hyperlink{png_8h_ad46179dbe9c68fdcea52b34c3480ec0f}{width}}, \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacegl_a33074d1196a1300c7cee5c0e42fa5cf8}{height}}) = 0;}
\DoxyCodeLine{296         \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} \mbox{\hyperlink{struct_texture_view_surface_texture_listener_1_1_owner_a637e683bf33bedd802a9f2379f5ef73d}{onSurfaceTextureDestroyed}} (LocalRef<jobject>\& surface) = 0;}
\DoxyCodeLine{297         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_texture_view_surface_texture_listener_1_1_owner_a3521fc806c6b0e3e92efcb9a892b92a4}{onSurfaceTextureSizeChanged}} (LocalRef<jobject>\& surface, \textcolor{keywordtype}{int} \mbox{\hyperlink{png_8h_ad46179dbe9c68fdcea52b34c3480ec0f}{width}}, \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacegl_a33074d1196a1300c7cee5c0e42fa5cf8}{height}}) = 0;}
\DoxyCodeLine{298         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_texture_view_surface_texture_listener_1_1_owner_a5de09a0f4e72abc41456b5d1fc3a84d9}{onSurfaceTextureUpdated}} (LocalRef<jobject>\& surface) = 0;}
\DoxyCodeLine{299     \};}
\DoxyCodeLine{300 }
\DoxyCodeLine{301     \mbox{\hyperlink{class_texture_view_surface_texture_listener_ad20b94f762331455d2a518d8021feda3}{TextureViewSurfaceTextureListener}} (\mbox{\hyperlink{struct_texture_view_surface_texture_listener_1_1_owner}{Owner}}\& ownerToUse)}
\DoxyCodeLine{302         : owner (ownerToUse)}
\DoxyCodeLine{303     \{\}}
\DoxyCodeLine{304 }
\DoxyCodeLine{305     jobject \mbox{\hyperlink{class_texture_view_surface_texture_listener_ac7a4b9c5e14cca96745477e4286853ef}{invoke}} (jobject proxy, jobject method, jobjectArray args)\textcolor{keyword}{ override}}
\DoxyCodeLine{306 \textcolor{keyword}{    }\{}
\DoxyCodeLine{307         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{308 }
\DoxyCodeLine{309         \textcolor{keyword}{auto} methodName = juceString ((jstring) env-\/>CallObjectMethod (method, JavaMethod.getName));}
\DoxyCodeLine{310 }
\DoxyCodeLine{311         \textcolor{keywordtype}{int} numArgs = args != \textcolor{keyword}{nullptr} ? env-\/>GetArrayLength (args) : 0;}
\DoxyCodeLine{312 }
\DoxyCodeLine{313         \textcolor{keywordflow}{if} (methodName == \textcolor{stringliteral}{"{}onSurfaceTextureAvailable"{}} \&\& numArgs == 3)}
\DoxyCodeLine{314         \{}
\DoxyCodeLine{315             \textcolor{keyword}{auto} surface = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 0));}
\DoxyCodeLine{316             \textcolor{keyword}{auto} \mbox{\hyperlink{png_8h_ad46179dbe9c68fdcea52b34c3480ec0f}{width}}   = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 1));}
\DoxyCodeLine{317             \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a33074d1196a1300c7cee5c0e42fa5cf8}{height}}  = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 2));}
\DoxyCodeLine{318 }
\DoxyCodeLine{319             \textcolor{keyword}{auto} widthInt  = env-\/>CallIntMethod (\mbox{\hyperlink{png_8h_ad46179dbe9c68fdcea52b34c3480ec0f}{width}}, JavaInteger.intValue);}
\DoxyCodeLine{320             \textcolor{keyword}{auto} heightInt = env-\/>CallIntMethod (\mbox{\hyperlink{namespacegl_a33074d1196a1300c7cee5c0e42fa5cf8}{height}}, JavaInteger.intValue);}
\DoxyCodeLine{321 }
\DoxyCodeLine{322             owner.onSurfaceTextureAvailable (surface, widthInt, heightInt);}
\DoxyCodeLine{323             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{324         \}}
\DoxyCodeLine{325         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (methodName == \textcolor{stringliteral}{"{}onSurfaceTextureDestroyed"{}} \&\& numArgs == 1)}
\DoxyCodeLine{326         \{}
\DoxyCodeLine{327             \textcolor{keyword}{auto} surface = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 0));}
\DoxyCodeLine{328             \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} = owner.onSurfaceTextureDestroyed (surface);}
\DoxyCodeLine{329 }
\DoxyCodeLine{330             \textcolor{keywordflow}{return} env-\/>CallStaticObjectMethod (JavaBoolean, JavaBoolean.valueOf, \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{331         \}}
\DoxyCodeLine{332         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (methodName == \textcolor{stringliteral}{"{}onSurfaceTextureSizeChanged"{}} \&\& numArgs == 3)}
\DoxyCodeLine{333         \{}
\DoxyCodeLine{334             \textcolor{keyword}{auto} surface = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 0));}
\DoxyCodeLine{335             \textcolor{keyword}{auto} \mbox{\hyperlink{png_8h_ad46179dbe9c68fdcea52b34c3480ec0f}{width}}   = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 1));}
\DoxyCodeLine{336             \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a33074d1196a1300c7cee5c0e42fa5cf8}{height}}  = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 2));}
\DoxyCodeLine{337 }
\DoxyCodeLine{338             \textcolor{keyword}{auto} widthInt  = env-\/>CallIntMethod (\mbox{\hyperlink{png_8h_ad46179dbe9c68fdcea52b34c3480ec0f}{width}}, JavaInteger.intValue);}
\DoxyCodeLine{339             \textcolor{keyword}{auto} heightInt = env-\/>CallIntMethod (\mbox{\hyperlink{namespacegl_a33074d1196a1300c7cee5c0e42fa5cf8}{height}}, JavaInteger.intValue);}
\DoxyCodeLine{340 }
\DoxyCodeLine{341             owner.onSurfaceTextureSizeChanged (surface, widthInt, heightInt);}
\DoxyCodeLine{342             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{343         \}}
\DoxyCodeLine{344         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (methodName == \textcolor{stringliteral}{"{}onSurfaceTextureUpdated"{}} \&\& numArgs == 1)}
\DoxyCodeLine{345         \{}
\DoxyCodeLine{346             \textcolor{keyword}{auto} surface = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 0));}
\DoxyCodeLine{347 }
\DoxyCodeLine{348             owner.onSurfaceTextureUpdated (surface);}
\DoxyCodeLine{349             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{350         \}}
\DoxyCodeLine{351 }
\DoxyCodeLine{352         \textcolor{keywordflow}{return} AndroidInterfaceImplementer::invoke (proxy, method, args);}
\DoxyCodeLine{353     \}}
\DoxyCodeLine{354 }
\DoxyCodeLine{355 \textcolor{keyword}{private}:}
\DoxyCodeLine{356     Owner\& owner;}
\DoxyCodeLine{357 \};}
\DoxyCodeLine{358 }
\DoxyCodeLine{359 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{360 \textcolor{keyword}{class }\mbox{\hyperlink{class_image_reader_on_image_available_listener}{ImageReaderOnImageAvailableListener}}     : \textcolor{keyword}{public} AndroidInterfaceImplementer}
\DoxyCodeLine{361 \{}
\DoxyCodeLine{362 \textcolor{keyword}{public}:}
\DoxyCodeLine{363     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_image_reader_on_image_available_listener_1_1_owner}{Owner}}}
\DoxyCodeLine{364     \{}
\DoxyCodeLine{365         \textcolor{keyword}{virtual} \mbox{\hyperlink{struct_image_reader_on_image_available_listener_1_1_owner_a14aae936e5ec52f2be5de1046ded411d}{\string~Owner}}() \{\}}
\DoxyCodeLine{366 }
\DoxyCodeLine{367         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_image_reader_on_image_available_listener_1_1_owner_a54b225e213f258726da0ca7aa0f1f674}{onImageAvailable}} (LocalRef<jobject>\& imageReader) = 0;}
\DoxyCodeLine{368     \};}
\DoxyCodeLine{369 }
\DoxyCodeLine{370     \mbox{\hyperlink{class_image_reader_on_image_available_listener_a9eedd60a4046b17b841a5d1c897ce683}{ImageReaderOnImageAvailableListener}} (\mbox{\hyperlink{struct_image_reader_on_image_available_listener_1_1_owner}{Owner}}\& ownerToUse)}
\DoxyCodeLine{371         : owner (ownerToUse)}
\DoxyCodeLine{372     \{\}}
\DoxyCodeLine{373 }
\DoxyCodeLine{374     jobject \mbox{\hyperlink{class_image_reader_on_image_available_listener_a58b1d9eed9a377c82be472d5923a3474}{invoke}} (jobject proxy, jobject method, jobjectArray args)\textcolor{keyword}{ override}}
\DoxyCodeLine{375 \textcolor{keyword}{    }\{}
\DoxyCodeLine{376         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{377 }
\DoxyCodeLine{378         \textcolor{keyword}{auto} methodName = juceString ((jstring) env-\/>CallObjectMethod (method, JavaMethod.getName));}
\DoxyCodeLine{379 }
\DoxyCodeLine{380         \textcolor{keywordtype}{int} numArgs = args != \textcolor{keyword}{nullptr} ? env-\/>GetArrayLength (args) : 0;}
\DoxyCodeLine{381 }
\DoxyCodeLine{382         \textcolor{keywordflow}{if} (methodName == \textcolor{stringliteral}{"{}onImageAvailable"{}} \&\& numArgs == 1)}
\DoxyCodeLine{383         \{}
\DoxyCodeLine{384             \textcolor{keyword}{auto} imageReader = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 0));}
\DoxyCodeLine{385 }
\DoxyCodeLine{386             owner.onImageAvailable (imageReader);}
\DoxyCodeLine{387             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{388         \}}
\DoxyCodeLine{389 }
\DoxyCodeLine{390         \textcolor{keywordflow}{return} AndroidInterfaceImplementer::invoke (proxy, method, args);}
\DoxyCodeLine{391     \}}
\DoxyCodeLine{392 }
\DoxyCodeLine{393 \textcolor{keyword}{private}:}
\DoxyCodeLine{394     Owner\& owner;}
\DoxyCodeLine{395 \};}
\DoxyCodeLine{396 }
\DoxyCodeLine{397 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{398 \textcolor{keyword}{class }\mbox{\hyperlink{class_media_recorder_on_info_listener}{MediaRecorderOnInfoListener}}     : \textcolor{keyword}{public} AndroidInterfaceImplementer}
\DoxyCodeLine{399 \{}
\DoxyCodeLine{400 \textcolor{keyword}{public}:}
\DoxyCodeLine{401     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_media_recorder_on_info_listener_1_1_owner}{Owner}}}
\DoxyCodeLine{402     \{}
\DoxyCodeLine{403         \textcolor{keyword}{virtual} \mbox{\hyperlink{struct_media_recorder_on_info_listener_1_1_owner_a85223aa34c6f4c5a5119c52e617dbf93}{\string~Owner}}() \{\}}
\DoxyCodeLine{404 }
\DoxyCodeLine{405         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_media_recorder_on_info_listener_1_1_owner_aeb3b3ef134bc03a52ea49d2da353fc59}{onInfo}} (LocalRef<jobject>\& mediaRecorder, \textcolor{keywordtype}{int} what, \textcolor{keywordtype}{int} extra) = 0;}
\DoxyCodeLine{406     \};}
\DoxyCodeLine{407 }
\DoxyCodeLine{408     \mbox{\hyperlink{class_media_recorder_on_info_listener_a64b2607a132ef186ded9325ae71ce419}{MediaRecorderOnInfoListener}} (\mbox{\hyperlink{struct_media_recorder_on_info_listener_1_1_owner}{Owner}}\& ownerToUse)}
\DoxyCodeLine{409         : owner (ownerToUse)}
\DoxyCodeLine{410     \{\}}
\DoxyCodeLine{411 }
\DoxyCodeLine{412     jobject \mbox{\hyperlink{class_media_recorder_on_info_listener_a3880da57b889ebacfbdf3ef33a5893d1}{invoke}} (jobject proxy, jobject method, jobjectArray args)\textcolor{keyword}{ override}}
\DoxyCodeLine{413 \textcolor{keyword}{    }\{}
\DoxyCodeLine{414         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{415 }
\DoxyCodeLine{416         \textcolor{keyword}{auto} methodName = juceString ((jstring) env-\/>CallObjectMethod (method, JavaMethod.getName));}
\DoxyCodeLine{417 }
\DoxyCodeLine{418         \textcolor{keywordtype}{int} numArgs = args != \textcolor{keyword}{nullptr} ? env-\/>GetArrayLength (args) : 0;}
\DoxyCodeLine{419 }
\DoxyCodeLine{420         \textcolor{keywordflow}{if} (methodName == \textcolor{stringliteral}{"{}onInfo"{}} \&\& numArgs == 3)}
\DoxyCodeLine{421         \{}
\DoxyCodeLine{422             \textcolor{keyword}{auto} mediaRecorder = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 0));}
\DoxyCodeLine{423             \textcolor{keyword}{auto} what   = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 1));}
\DoxyCodeLine{424             \textcolor{keyword}{auto} extra  = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 2));}
\DoxyCodeLine{425 }
\DoxyCodeLine{426             \textcolor{keyword}{auto} whatInt  = (\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}}) env-\/>CallIntMethod (what, JavaInteger.intValue);}
\DoxyCodeLine{427             \textcolor{keyword}{auto} extraInt = (\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}}) env-\/>CallIntMethod (extra, JavaInteger.intValue);}
\DoxyCodeLine{428 }
\DoxyCodeLine{429             owner.onInfo (mediaRecorder, whatInt, extraInt);}
\DoxyCodeLine{430             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{431         \}}
\DoxyCodeLine{432 }
\DoxyCodeLine{433         \textcolor{keywordflow}{return} AndroidInterfaceImplementer::invoke (proxy, method, args);}
\DoxyCodeLine{434     \}}
\DoxyCodeLine{435 }
\DoxyCodeLine{436 \textcolor{keyword}{private}:}
\DoxyCodeLine{437     Owner\& owner;}
\DoxyCodeLine{438 \};}
\DoxyCodeLine{439 }
\DoxyCodeLine{440 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{441 \textcolor{keyword}{class }\mbox{\hyperlink{class_media_recorder_on_error_listener}{MediaRecorderOnErrorListener}}     : \textcolor{keyword}{public} AndroidInterfaceImplementer}
\DoxyCodeLine{442 \{}
\DoxyCodeLine{443 \textcolor{keyword}{public}:}
\DoxyCodeLine{444     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_media_recorder_on_error_listener_1_1_owner}{Owner}}}
\DoxyCodeLine{445     \{}
\DoxyCodeLine{446         \textcolor{keyword}{virtual} \mbox{\hyperlink{struct_media_recorder_on_error_listener_1_1_owner_ac65f6570adcba6b963b1da10715950bf}{\string~Owner}}() \{\}}
\DoxyCodeLine{447 }
\DoxyCodeLine{448         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_media_recorder_on_error_listener_1_1_owner_a07eb778934fb5ffa8243dda5fdb68729}{onError}} (LocalRef<jobject>\& mediaRecorder, \textcolor{keywordtype}{int} what, \textcolor{keywordtype}{int} extra) = 0;}
\DoxyCodeLine{449     \};}
\DoxyCodeLine{450 }
\DoxyCodeLine{451     \mbox{\hyperlink{class_media_recorder_on_error_listener_a35f955b99eb6f3969cf269f94ab0010a}{MediaRecorderOnErrorListener}} (\mbox{\hyperlink{struct_media_recorder_on_error_listener_1_1_owner}{Owner}}\& ownerToUse)}
\DoxyCodeLine{452         : owner (ownerToUse)}
\DoxyCodeLine{453     \{\}}
\DoxyCodeLine{454 }
\DoxyCodeLine{455     jobject \mbox{\hyperlink{class_media_recorder_on_error_listener_a80704de58f361e0c37de1c6ab5363f41}{invoke}} (jobject proxy, jobject method, jobjectArray args)\textcolor{keyword}{ override}}
\DoxyCodeLine{456 \textcolor{keyword}{    }\{}
\DoxyCodeLine{457         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{458 }
\DoxyCodeLine{459         \textcolor{keyword}{auto} methodName = juceString ((jstring) env-\/>CallObjectMethod (method, JavaMethod.getName));}
\DoxyCodeLine{460 }
\DoxyCodeLine{461         \textcolor{keywordtype}{int} numArgs = args != \textcolor{keyword}{nullptr} ? env-\/>GetArrayLength (args) : 0;}
\DoxyCodeLine{462 }
\DoxyCodeLine{463         \textcolor{keywordflow}{if} (methodName == \textcolor{stringliteral}{"{}onError"{}} \&\& numArgs == 3)}
\DoxyCodeLine{464         \{}
\DoxyCodeLine{465             \textcolor{keyword}{auto} mediaRecorder = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 0));}
\DoxyCodeLine{466             \textcolor{keyword}{auto} what   = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 1));}
\DoxyCodeLine{467             \textcolor{keyword}{auto} extra  = LocalRef<jobject> (env-\/>GetObjectArrayElement (args, 2));}
\DoxyCodeLine{468 }
\DoxyCodeLine{469             \textcolor{keyword}{auto} whatInt  = (\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}}) env-\/>CallIntMethod (what, JavaInteger.intValue);}
\DoxyCodeLine{470             \textcolor{keyword}{auto} extraInt = (\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}}) env-\/>CallIntMethod (extra, JavaInteger.intValue);}
\DoxyCodeLine{471 }
\DoxyCodeLine{472             owner.onError (mediaRecorder, whatInt, extraInt);}
\DoxyCodeLine{473             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{474         \}}
\DoxyCodeLine{475 }
\DoxyCodeLine{476         \textcolor{keywordflow}{return} AndroidInterfaceImplementer::invoke (proxy, method, args);}
\DoxyCodeLine{477     \}}
\DoxyCodeLine{478 }
\DoxyCodeLine{479 \textcolor{keyword}{private}:}
\DoxyCodeLine{480     Owner\& owner;}
\DoxyCodeLine{481 \};}
\DoxyCodeLine{482 }
\DoxyCodeLine{483 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{484 \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_pimpl}{CameraDevice::Pimpl}}}
\DoxyCodeLine{485     : \textcolor{keyword}{private} ActivityLifecycleCallbacks}
\DoxyCodeLine{486 \{}
\DoxyCodeLine{487     \textcolor{keyword}{using} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_aee53ed6db5b8ec3bdb39289775eabb76}{InternalOpenCameraResultCallback}} = \mbox{\hyperlink{namespacejuce_a7959b0b488fde11032d8151bf10669a4}{std::function}}<\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \textcolor{comment}{/*cameraId*/}, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \textcolor{comment}{/*error*/})>;}
\DoxyCodeLine{488 }
\DoxyCodeLine{489     \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}} (CameraDevice\& ownerToUse, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& cameraIdToUse, \textcolor{keywordtype}{int} \textcolor{comment}{/*index*/},}
\DoxyCodeLine{490            \textcolor{keywordtype}{int} minWidthToUse, \textcolor{keywordtype}{int} minHeightToUse, \textcolor{keywordtype}{int} maxWidthToUse, \textcolor{keywordtype}{int} maxHeightToUse,}
\DoxyCodeLine{491            \textcolor{keywordtype}{bool} \textcolor{comment}{/*useHighQuality*/})}
\DoxyCodeLine{492         : owner (ownerToUse),}
\DoxyCodeLine{493           minWidth (minWidthToUse),}
\DoxyCodeLine{494           minHeight (minHeightToUse),}
\DoxyCodeLine{495           maxWidth (maxWidthToUse),}
\DoxyCodeLine{496           maxHeight (maxHeightToUse),}
\DoxyCodeLine{497           cameraId (cameraIdToUse),}
\DoxyCodeLine{498           activityLifeListener (\mbox{\hyperlink{namespacejuce_aa5d43f5b68766ba8c811e4e17df96a3e}{CreateJavaInterface}} (this, \textcolor{stringliteral}{"{}android/app/Application\$ActivityLifecycleCallbacks"{}})),}
\DoxyCodeLine{499           cameraManager (initialiseCameraManager()),}
\DoxyCodeLine{500           cameraCharacteristics (initialiseCameraCharacteristics (cameraManager, cameraId)),}
\DoxyCodeLine{501           streamConfigurationMap (cameraCharacteristics),}
\DoxyCodeLine{502           previewDisplay (streamConfigurationMap.getPreviewBufferSize()),}
\DoxyCodeLine{503           deviceOrientationChangeListener (previewDisplay)}
\DoxyCodeLine{504     \{}
\DoxyCodeLine{505         startBackgroundThread();}
\DoxyCodeLine{506     \}}
\DoxyCodeLine{507 }
\DoxyCodeLine{508     \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a392bee8383a5acfa23ae7e7a1ad04b59}{\string~Pimpl}}()\textcolor{keyword}{ override}}
\DoxyCodeLine{509 \textcolor{keyword}{    }\{}
\DoxyCodeLine{510         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{511 }
\DoxyCodeLine{512         env-\/>CallVoidMethod (\mbox{\hyperlink{namespacejuce_ae270c2dd4b358c3482f8950a283a36af}{getAppContext}}().\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}(), AndroidApplication.unregisterActivityLifecycleCallbacks, activityLifeListener.get());}
\DoxyCodeLine{513         activityLifeListener.clear();}
\DoxyCodeLine{514     \}}
\DoxyCodeLine{515 }
\DoxyCodeLine{516     \mbox{\hyperlink{group__juce__core-memory_ga557fa9dbf924a150e27f0cf0dad368b0}{JUCE\_DECLARE\_WEAK\_REFERENCEABLE}} (\mbox{\hyperlink{struct_camera_device_1_1_pimpl}{Pimpl}})}
\DoxyCodeLine{517 }
\DoxyCodeLine{518     \mbox{\hyperlink{class_string}{String}} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a27ab46e6132462619815357d87b313d9}{getCameraId}}() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} cameraId; \}}
\DoxyCodeLine{519 }
\DoxyCodeLine{520     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6d14f00cad5a3be6c3490d6cb4d1dd28}{open}} (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_aee53ed6db5b8ec3bdb39289775eabb76}{InternalOpenCameraResultCallback}} cameraOpenCallbackToUse)}
\DoxyCodeLine{521     \{}
\DoxyCodeLine{522         cameraOpenCallback = \mbox{\hyperlink{namespacedsp_1_1detail_afe40dd96c3100ef2d29a2c0ab7947423}{std::move}} (cameraOpenCallbackToUse);}
\DoxyCodeLine{523 }
\DoxyCodeLine{524         \textcolor{comment}{// A valid camera open callback must be passed.}}
\DoxyCodeLine{525         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (cameraOpenCallback != \textcolor{keyword}{nullptr});}
\DoxyCodeLine{526 }
\DoxyCodeLine{527         \textcolor{comment}{// The same camera can be opened only once!}}
\DoxyCodeLine{528         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (scopedCameraDevice == \textcolor{keyword}{nullptr});}
\DoxyCodeLine{529 }
\DoxyCodeLine{530         \textcolor{keywordflow}{if} (cameraOpenCallback == \textcolor{keyword}{nullptr} || scopedCameraDevice != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{531             \textcolor{keywordflow}{return};}
\DoxyCodeLine{532 }
\DoxyCodeLine{533         \mbox{\hyperlink{class_runtime_permissions_a3f2cbc9cdf2bdd520ba7a864da2998e5}{RuntimePermissions::request}} (\mbox{\hyperlink{class_runtime_permissions_ae35d63b8c00dab34a1546fd1eef90878afa0b39e22fde29c5810ac23f0ea5c95c}{RuntimePermissions::camera}},}
\DoxyCodeLine{534                                      [safeThis = \mbox{\hyperlink{class_weak_reference}{WeakReference<Pimpl>}} \{ \textcolor{keyword}{this} \}] (\textcolor{keywordtype}{bool} granted) \textcolor{keyword}{mutable}}
\DoxyCodeLine{535                                      \{}
\DoxyCodeLine{536                                          \textcolor{keywordflow}{if} (safeThis != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{537                                              safeThis-\/>continueOpenRequest (granted);}
\DoxyCodeLine{538                                      \});}
\DoxyCodeLine{539     \}}
\DoxyCodeLine{540 }
\DoxyCodeLine{541     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_afca918006961283e4239b366cc83e0e3}{continueOpenRequest}} (\textcolor{keywordtype}{bool} granted)}
\DoxyCodeLine{542     \{}
\DoxyCodeLine{543         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacejuce_a5f3f814b10a0af4c725415ceacdfde7c}{getAndroidSDKVersion}}() >= 21)}
\DoxyCodeLine{544         \{}
\DoxyCodeLine{545             \textcolor{keywordflow}{if} (granted)}
\DoxyCodeLine{546             \{}
\DoxyCodeLine{547                 \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (\mbox{\hyperlink{namespacejuce_ae270c2dd4b358c3482f8950a283a36af}{getAppContext}}().\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}(), AndroidApplication.registerActivityLifecycleCallbacks, activityLifeListener.get());}
\DoxyCodeLine{548                 scopedCameraDevice.reset (\textcolor{keyword}{new} ScopedCameraDevice (*\textcolor{keyword}{this}, cameraId, cameraManager, handler, getAutoFocusModeToUse()));}
\DoxyCodeLine{549             \}}
\DoxyCodeLine{550             \textcolor{keywordflow}{else}}
\DoxyCodeLine{551             \{}
\DoxyCodeLine{552                 invokeCameraOpenCallback (\textcolor{stringliteral}{"{}Camera permission not granted"{}});}
\DoxyCodeLine{553             \}}
\DoxyCodeLine{554         \}}
\DoxyCodeLine{555         \textcolor{keywordflow}{else}}
\DoxyCodeLine{556         \{}
\DoxyCodeLine{557             invokeCameraOpenCallback (\textcolor{stringliteral}{"{}Camera requires android sdk version 21 or greater"{}});}
\DoxyCodeLine{558         \}}
\DoxyCodeLine{559     \}}
\DoxyCodeLine{560 }
\DoxyCodeLine{561     \textcolor{keywordtype}{bool} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} scopedCameraDevice-\/>openedOk(); \}}
\DoxyCodeLine{562 }
\DoxyCodeLine{563     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5167029331352275c3f62be288392d93}{takeStillPicture}} (\mbox{\hyperlink{namespacejuce_a7959b0b488fde11032d8151bf10669a4}{std::function}}<\textcolor{keywordtype}{void} (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\&)> pictureTakenCallbackToUse)}
\DoxyCodeLine{564     \{}
\DoxyCodeLine{565         \textcolor{keywordflow}{if} (pictureTakenCallbackToUse == \textcolor{keyword}{nullptr} || currentCaptureSessionMode == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{566         \{}
\DoxyCodeLine{567             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{568             \textcolor{keywordflow}{return};}
\DoxyCodeLine{569         \}}
\DoxyCodeLine{570 }
\DoxyCodeLine{571         \textcolor{keywordflow}{if} (currentCaptureSessionMode-\/>isVideoRecordSession())}
\DoxyCodeLine{572         \{}
\DoxyCodeLine{573             \textcolor{comment}{// Taking still pictures while recording video is not supported on Android.}}
\DoxyCodeLine{574             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{575             \textcolor{keywordflow}{return};}
\DoxyCodeLine{576         \}}
\DoxyCodeLine{577 }
\DoxyCodeLine{578         pictureTakenCallback = \mbox{\hyperlink{namespacedsp_1_1detail_afe40dd96c3100ef2d29a2c0ab7947423}{std::move}} (pictureTakenCallbackToUse);}
\DoxyCodeLine{579 }
\DoxyCodeLine{580         triggerStillPictureCapture();}
\DoxyCodeLine{581     \}}
\DoxyCodeLine{582 }
\DoxyCodeLine{583     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_afb3d92c684c0bc97a6e2eca8cbb3fa05}{startRecordingToFile}} (\textcolor{keyword}{const} \mbox{\hyperlink{class_file}{File}}\& file, \textcolor{keywordtype}{int} \textcolor{comment}{/*quality*/})}
\DoxyCodeLine{584     \{}
\DoxyCodeLine{585         \textcolor{keywordflow}{if} (! \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}())}
\DoxyCodeLine{586         \{}
\DoxyCodeLine{587             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{588             \textcolor{keywordflow}{return};}
\DoxyCodeLine{589         \}}
\DoxyCodeLine{590 }
\DoxyCodeLine{591         \textcolor{keywordflow}{if} (! previewDisplay.isReady())}
\DoxyCodeLine{592         \{}
\DoxyCodeLine{593             \textcolor{comment}{// Did you remember to create and show a preview display?}}
\DoxyCodeLine{594             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{595             \textcolor{keywordflow}{return};}
\DoxyCodeLine{596         \}}
\DoxyCodeLine{597 }
\DoxyCodeLine{598         file.\mbox{\hyperlink{class_file_adc64f67a869db306afd65a67758e5a3e}{deleteFile}}();}
\DoxyCodeLine{599         file.\mbox{\hyperlink{class_file_abafe426da97eb12e8c445b16dae8a4cd}{create}}();}
\DoxyCodeLine{600         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (file.\mbox{\hyperlink{class_file_a2d79c296f148b00041aeeac0013716d9}{existsAsFile}}());}
\DoxyCodeLine{601 }
\DoxyCodeLine{602         \textcolor{comment}{// MediaRecorder can't handle videos larger than 1080p}}
\DoxyCodeLine{603         \textcolor{keyword}{auto} videoSize = chooseBestSize (minWidth, minHeight, \mbox{\hyperlink{group__juce__core-maths_gae8394cdf11279b266f4aa741758c1669}{jmin}} (maxWidth, 1080), maxHeight,}
\DoxyCodeLine{604                                          streamConfigurationMap.getSupportedVideoRecordingOutputSizes());}
\DoxyCodeLine{605 }
\DoxyCodeLine{606         mediaRecorder.reset (\textcolor{keyword}{new} MediaRecorder (file.\mbox{\hyperlink{class_file_ab46bb1ff1b9e41ebd907c51d4d6e8743}{getFullPathName}}(), videoSize.getWidth(), videoSize.getHeight(),}
\DoxyCodeLine{607                                                 getCameraSensorOrientation(), getCameraLensFacing()));}
\DoxyCodeLine{608 }
\DoxyCodeLine{609         firstRecordedFrameTimeMs = \mbox{\hyperlink{class_time_a9acf1454101b83bc3c77b435778d698e}{Time::getCurrentTime}}();}
\DoxyCodeLine{610 }
\DoxyCodeLine{611         currentCaptureSessionMode.reset();}
\DoxyCodeLine{612         startVideoRecordingMode (*mediaRecorder);}
\DoxyCodeLine{613     \}}
\DoxyCodeLine{614 }
\DoxyCodeLine{615     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac33ca230910ae42b3171bd149ef0f84e}{stopRecording}}()}
\DoxyCodeLine{616     \{}
\DoxyCodeLine{617         currentCaptureSessionMode.reset();}
\DoxyCodeLine{618         mediaRecorder.reset();}
\DoxyCodeLine{619 }
\DoxyCodeLine{620         startPreviewMode (*imageReader);}
\DoxyCodeLine{621     \}}
\DoxyCodeLine{622 }
\DoxyCodeLine{623     \mbox{\hyperlink{class_time}{Time}} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a140af780d9abb52ff7f4408c47a69beb}{getTimeOfFirstRecordedFrame}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{624 \textcolor{keyword}{    }\{}
\DoxyCodeLine{625         \textcolor{keywordflow}{return} firstRecordedFrameTimeMs;}
\DoxyCodeLine{626     \}}
\DoxyCodeLine{627 }
\DoxyCodeLine{628     \textcolor{keyword}{static} \mbox{\hyperlink{class_string_array}{StringArray}} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac9188d9367c011ba618a1fade6f01401}{getAvailableDevices}}()}
\DoxyCodeLine{629     \{}
\DoxyCodeLine{630         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacejuce_a5f3f814b10a0af4c725415ceacdfde7c}{getAndroidSDKVersion}}() < 21)}
\DoxyCodeLine{631             \textcolor{keywordflow}{return} \mbox{\hyperlink{class_string_array}{StringArray}}(); \textcolor{comment}{// Camera requires SDK version 21 or later}}
\DoxyCodeLine{632 }
\DoxyCodeLine{633         \mbox{\hyperlink{class_string_array}{StringArray}} results;}
\DoxyCodeLine{634 }
\DoxyCodeLine{635         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{636 }
\DoxyCodeLine{637         \textcolor{keyword}{auto} cameraManagerToUse = initialiseCameraManager();}
\DoxyCodeLine{638         \textcolor{keyword}{auto} cameraIdArray = LocalRef<jobjectArray> ((jobjectArray) env-\/>CallObjectMethod (cameraManagerToUse,}
\DoxyCodeLine{639                                                                                            CameraManager.getCameraIdList));}
\DoxyCodeLine{640 }
\DoxyCodeLine{641         results = javaStringArrayToJuce (cameraIdArray);}
\DoxyCodeLine{642 }
\DoxyCodeLine{643         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} : results)}
\DoxyCodeLine{644             printDebugCameraInfo (cameraManagerToUse, \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{645 }
\DoxyCodeLine{646         \textcolor{keywordflow}{return} results;}
\DoxyCodeLine{647     \}}
\DoxyCodeLine{648 }
\DoxyCodeLine{649     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a631a4ade218dfddc56d588c5b03fd1ca}{addListener}} (CameraDevice::Listener* listenerToAdd)}
\DoxyCodeLine{650     \{}
\DoxyCodeLine{651         \textcolor{keyword}{const} \mbox{\hyperlink{class_generic_scoped_lock}{ScopedLock}} sl (listenerLock);}
\DoxyCodeLine{652         listeners.add (listenerToAdd);}
\DoxyCodeLine{653 }
\DoxyCodeLine{654         \textcolor{keywordflow}{if} (listeners.size() == 1)}
\DoxyCodeLine{655             triggerStillPictureCapture();}
\DoxyCodeLine{656     \}}
\DoxyCodeLine{657 }
\DoxyCodeLine{658     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a39c0df63795c33e8e22f16451349a36f}{removeListener}} (CameraDevice::Listener* listenerToRemove)}
\DoxyCodeLine{659     \{}
\DoxyCodeLine{660         \textcolor{keyword}{const} \mbox{\hyperlink{class_generic_scoped_lock}{ScopedLock}} sl (listenerLock);}
\DoxyCodeLine{661         listeners.remove (listenerToRemove);}
\DoxyCodeLine{662     \}}
\DoxyCodeLine{663 }
\DoxyCodeLine{664 \textcolor{keyword}{private}:}
\DoxyCodeLine{665     \textcolor{keyword}{enum}}
\DoxyCodeLine{666     \{}
\DoxyCodeLine{667         ERROR\_CAMERA\_IN\_USE = 1,}
\DoxyCodeLine{668         ERROR\_MAX\_CAMERAS\_IN\_USE = 2,}
\DoxyCodeLine{669         ERROR\_CAMERA\_DISABLED = 3,}
\DoxyCodeLine{670         ERROR\_CAMERA\_DEVICE = 4,}
\DoxyCodeLine{671         ERROR\_CAMERA\_SERVICE = 5}
\DoxyCodeLine{672     \};}
\DoxyCodeLine{673 }
\DoxyCodeLine{674     \textcolor{keyword}{static} \mbox{\hyperlink{class_string}{String}} cameraErrorCodeToString (\textcolor{keywordtype}{int} errorCode)}
\DoxyCodeLine{675     \{}
\DoxyCodeLine{676         \textcolor{keywordflow}{switch} (errorCode)}
\DoxyCodeLine{677         \{}
\DoxyCodeLine{678             \textcolor{keywordflow}{case} ERROR\_CAMERA\_IN\_USE:      \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Camera already in use."{}};}
\DoxyCodeLine{679             \textcolor{keywordflow}{case} ERROR\_MAX\_CAMERAS\_IN\_USE: \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Too many opened camera devices."{}};}
\DoxyCodeLine{680             \textcolor{keywordflow}{case} ERROR\_CAMERA\_DISABLED:    \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Camera disabled."{}};}
\DoxyCodeLine{681             \textcolor{keywordflow}{case} ERROR\_CAMERA\_DEVICE:      \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Fatal error."{}};}
\DoxyCodeLine{682             \textcolor{keywordflow}{case} ERROR\_CAMERA\_SERVICE:     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Fatal error. Reboot required or persistent hardware problem."{}};}
\DoxyCodeLine{683             \textcolor{keywordflow}{default}:                       \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Unknown error."{}};}
\DoxyCodeLine{684         \}}
\DoxyCodeLine{685     \}}
\DoxyCodeLine{686 }
\DoxyCodeLine{687     \textcolor{keyword}{static} LocalRef<jobject> initialiseCameraManager()}
\DoxyCodeLine{688     \{}
\DoxyCodeLine{689         \textcolor{keywordflow}{return} LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallObjectMethod (\mbox{\hyperlink{namespacejuce_ae270c2dd4b358c3482f8950a283a36af}{getAppContext}}().\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}(), AndroidContext.getSystemService,}
\DoxyCodeLine{690                                                               javaString (\textcolor{stringliteral}{"{}camera"{}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}()));}
\DoxyCodeLine{691     \}}
\DoxyCodeLine{692 }
\DoxyCodeLine{693     \textcolor{keyword}{static} LocalRef<jobject> initialiseCameraCharacteristics (\textcolor{keyword}{const} GlobalRef\& cameraManager, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& cameraId)}
\DoxyCodeLine{694     \{}
\DoxyCodeLine{695         \textcolor{keywordflow}{return} LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallObjectMethod (cameraManager,}
\DoxyCodeLine{696                                                               CameraManager.getCameraCharacteristics,}
\DoxyCodeLine{697                                                               javaString (cameraId).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}()));}
\DoxyCodeLine{698     \}}
\DoxyCodeLine{699 }
\DoxyCodeLine{700     \textcolor{keyword}{static} \textcolor{keywordtype}{void} printDebugCameraInfo (\textcolor{keyword}{const} LocalRef<jobject>\& cameraManagerToUse, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& cameraId)}
\DoxyCodeLine{701     \{}
\DoxyCodeLine{702         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{703 }
\DoxyCodeLine{704         \textcolor{keyword}{auto} characteristics = LocalRef<jobject> (env-\/>CallObjectMethod (cameraManagerToUse,}
\DoxyCodeLine{705                                                                          CameraManager.getCameraCharacteristics,}
\DoxyCodeLine{706                                                                          javaString (cameraId).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}()));}
\DoxyCodeLine{707 }
\DoxyCodeLine{708         \textcolor{keyword}{auto} keysList = LocalRef<jobject> (env-\/>CallObjectMethod (characteristics, CameraCharacteristics.getKeys));}
\DoxyCodeLine{709 }
\DoxyCodeLine{710         \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}} = env-\/>CallIntMethod (keysList, JavaList.size);}
\DoxyCodeLine{711 }
\DoxyCodeLine{712         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Camera id: "{}} + cameraId + \textcolor{stringliteral}{"{}, characteristics keys num: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}));}
\DoxyCodeLine{713 }
\DoxyCodeLine{714         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}; ++i)}
\DoxyCodeLine{715         \{}
\DoxyCodeLine{716             \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}} = LocalRef<jobject> (env-\/>CallObjectMethod (keysList, JavaList.get, i));}
\DoxyCodeLine{717             \textcolor{keyword}{auto} jKeyName = LocalRef<jstring> ((jstring) env-\/>CallObjectMethod (\mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}}, CameraCharacteristicsKey.getName));}
\DoxyCodeLine{718             \textcolor{keyword}{auto} keyName = juceString (jKeyName);}
\DoxyCodeLine{719 }
\DoxyCodeLine{720             \textcolor{keyword}{auto} keyValue = LocalRef<jobject> (env-\/>CallObjectMethod (characteristics, CameraCharacteristics.get, \mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}}.get()));}
\DoxyCodeLine{721             \textcolor{keyword}{auto} jKeyValueString = LocalRef<jstring> ((jstring) env-\/>CallObjectMethod (keyValue, JavaObject.toString));}
\DoxyCodeLine{722             \textcolor{keyword}{auto} keyValueString = juceString (jKeyValueString);}
\DoxyCodeLine{723 }
\DoxyCodeLine{724             \textcolor{keyword}{auto} \&kvs = keyValueString;}
\DoxyCodeLine{725 }
\DoxyCodeLine{726             \textcolor{keywordflow}{if} (kvs.startsWith (\textcolor{stringliteral}{"{}[I"{}}) || kvs.startsWith (\textcolor{stringliteral}{"{}[F"{}}) || kvs.startsWith (\textcolor{stringliteral}{"{}[Z"{}}) || kvs.startsWith (\textcolor{stringliteral}{"{}[B"{}}))}
\DoxyCodeLine{727             \{}
\DoxyCodeLine{728                 printPrimitiveArrayElements (keyValue, keyName, keyValueString);}
\DoxyCodeLine{729             \}}
\DoxyCodeLine{730             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (kvs.startsWith (\textcolor{stringliteral}{"{}[Landroid.util.Range"{}}))}
\DoxyCodeLine{731             \{}
\DoxyCodeLine{732                 printRangeArrayElements (keyValue, keyName);}
\DoxyCodeLine{733             \}}
\DoxyCodeLine{734             \textcolor{keywordflow}{else}}
\DoxyCodeLine{735             \{}
\DoxyCodeLine{736                 \textcolor{keywordtype}{int} chunkSize = 256;}
\DoxyCodeLine{737 }
\DoxyCodeLine{738                 \textcolor{keywordflow}{if} (keyValueString.length() > chunkSize)}
\DoxyCodeLine{739                 \{}
\DoxyCodeLine{740                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Key: "{}} + keyName);}
\DoxyCodeLine{741 }
\DoxyCodeLine{742                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{namespacegl_a8b29d29f83e403429c42969ab094fa9b}{j}} = 0, k = 1; \mbox{\hyperlink{namespacegl_a8b29d29f83e403429c42969ab094fa9b}{j}} < keyValueString.length(); \mbox{\hyperlink{namespacegl_a8b29d29f83e403429c42969ab094fa9b}{j}} += chunkSize, ++k)}
\DoxyCodeLine{743                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}value part "{}} + \mbox{\hyperlink{class_string}{String}} (k) + \textcolor{stringliteral}{"{}: "{}} + keyValueString.\mbox{\hyperlink{class_string_a790b963e9b372e2dc6ce7e2deaceb01f}{substring}} (\mbox{\hyperlink{namespacegl_a8b29d29f83e403429c42969ab094fa9b}{j}}, k + chunkSize));}
\DoxyCodeLine{744                 \}}
\DoxyCodeLine{745                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{746                 \{}
\DoxyCodeLine{747                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Key: "{}} + keyName + \textcolor{stringliteral}{"{}, value: "{}} + keyValueString);}
\DoxyCodeLine{748                 \}}
\DoxyCodeLine{749             \}}
\DoxyCodeLine{750 }
\DoxyCodeLine{751             \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (keyName);}
\DoxyCodeLine{752         \}}
\DoxyCodeLine{753     \}}
\DoxyCodeLine{754 }
\DoxyCodeLine{755     \textcolor{keyword}{static} \textcolor{keywordtype}{void} printPrimitiveArrayElements (\textcolor{keyword}{const} LocalRef<jobject>\& keyValue, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& keyName,}
\DoxyCodeLine{756                                              \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& keyValueString)}
\DoxyCodeLine{757     \{}
\DoxyCodeLine{758         \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (keyName);}
\DoxyCodeLine{759 }
\DoxyCodeLine{760         \mbox{\hyperlink{class_string}{String}} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} = \textcolor{stringliteral}{"{}["{}};}
\DoxyCodeLine{761 }
\DoxyCodeLine{762         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{763 }
\DoxyCodeLine{764 \textcolor{preprocessor}{        \#define PRINT\_ELEMENTS(elem\_type, array\_type, fun\_name\_middle)                                              \(\backslash\)}}
\DoxyCodeLine{765 \textcolor{preprocessor}{        \{                                                                                                           \(\backslash\)}}
\DoxyCodeLine{766 \textcolor{preprocessor}{            elem\_type* elements = env-\/>Get\#\#fun\_name\_middle\#\#ArrayElements ((array\_type) keyValue.get(), nullptr);  \(\backslash\)}}
\DoxyCodeLine{767 \textcolor{preprocessor}{            int size = env-\/>GetArrayLength ((array\_type) keyValue.get());                                           \(\backslash\)}}
\DoxyCodeLine{768 \textcolor{preprocessor}{                                                                                                                    \(\backslash\)}}
\DoxyCodeLine{769 \textcolor{preprocessor}{            for (int i = 0; i < size -\/ 1; ++i)                                                                      \(\backslash\)}}
\DoxyCodeLine{770 \textcolor{preprocessor}{                result << String (elements[i]) << "{} "{}};                                                              \(\backslash\)}
\DoxyCodeLine{771                                                                                                                     \(\backslash\)}
\DoxyCodeLine{772             if (size > 0)                                                                                           \(\backslash\)}
\DoxyCodeLine{773                 result << String (elements[size -\/ 1]);                                                              \(\backslash\)}
\DoxyCodeLine{774                                                                                                                     \(\backslash\)}
\DoxyCodeLine{775             env-\/>Release\#\#fun\_name\_middle\#\#ArrayElements ((array\_type) keyValue.get(), elements, 0);                \(\backslash\)}
\DoxyCodeLine{776         \}}
\DoxyCodeLine{777 }
\DoxyCodeLine{778         \textcolor{keywordflow}{if} (keyValueString.\mbox{\hyperlink{class_string_ab93de8ae7eb05cd79ae7d3d263525855}{startsWith}} (\textcolor{stringliteral}{"{}[I"{}}))}
\DoxyCodeLine{779             \mbox{\hyperlink{juce__android___camera_device_8h_ad5587c2ff3451edd4f99724be48aa5d6}{PRINT\_ELEMENTS}} (jint, jintArray, Int)}
\DoxyCodeLine{780         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (keyValueString.\mbox{\hyperlink{class_string_ab93de8ae7eb05cd79ae7d3d263525855}{startsWith}} (\textcolor{stringliteral}{"{}[F"{}}))}
\DoxyCodeLine{781             \mbox{\hyperlink{juce__android___camera_device_8h_ad5587c2ff3451edd4f99724be48aa5d6}{PRINT\_ELEMENTS}} (\textcolor{keywordtype}{float}, jfloatArray, Float)}
\DoxyCodeLine{782         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (keyValueString.\mbox{\hyperlink{class_string_ab93de8ae7eb05cd79ae7d3d263525855}{startsWith}} (\textcolor{stringliteral}{"{}[Z"{}}))}
\DoxyCodeLine{783             \mbox{\hyperlink{juce__android___camera_device_8h_ad5587c2ff3451edd4f99724be48aa5d6}{PRINT\_ELEMENTS}} (jboolean, jbooleanArray, Boolean)}
\DoxyCodeLine{784         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (keyValueString.\mbox{\hyperlink{class_string_ab93de8ae7eb05cd79ae7d3d263525855}{startsWith}} (\textcolor{stringliteral}{"{}[B"{}}))}
\DoxyCodeLine{785             \mbox{\hyperlink{juce__android___camera_device_8h_ad5587c2ff3451edd4f99724be48aa5d6}{PRINT\_ELEMENTS}} (jbyte, jbyteArray, \mbox{\hyperlink{zconf_8h_ae3a497195d617519e5353ea7b417940f}{Byte}});}
\DoxyCodeLine{786 }
\DoxyCodeLine{787 \textcolor{preprocessor}{        \#undef PRINT\_ELEMENTS}}
\DoxyCodeLine{788 }
\DoxyCodeLine{789         \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} << \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{790         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Key: "{}} + keyName + \textcolor{stringliteral}{"{}, value: "{}} + \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{791     \}}
\DoxyCodeLine{792 }
\DoxyCodeLine{793     \textcolor{keyword}{static} \textcolor{keywordtype}{void} printRangeArrayElements (\textcolor{keyword}{const} LocalRef<jobject>\& rangeArray, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& keyName)}
\DoxyCodeLine{794     \{}
\DoxyCodeLine{795         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{796 }
\DoxyCodeLine{797         jobjectArray ranges = \textcolor{keyword}{static\_cast<}jobjectArray\textcolor{keyword}{>} (rangeArray.get());}
\DoxyCodeLine{798 }
\DoxyCodeLine{799         \textcolor{keywordtype}{int} numRanges = env-\/>GetArrayLength (ranges);}
\DoxyCodeLine{800 }
\DoxyCodeLine{801         \mbox{\hyperlink{class_string}{String}} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}};}
\DoxyCodeLine{802 }
\DoxyCodeLine{803         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < numRanges; ++i)}
\DoxyCodeLine{804         \{}
\DoxyCodeLine{805             \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}} = LocalRef<jobject> (env-\/>GetObjectArrayElement (ranges, i));}
\DoxyCodeLine{806 }
\DoxyCodeLine{807             \textcolor{keyword}{auto} jRangeString = LocalRef<jstring> ((jstring) env-\/>CallObjectMethod (\mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}}, AndroidRange.toString));}
\DoxyCodeLine{808 }
\DoxyCodeLine{809             \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} << juceString (jRangeString) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{810         \}}
\DoxyCodeLine{811 }
\DoxyCodeLine{812         \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (keyName);}
\DoxyCodeLine{813         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Key: "{}} + keyName + \textcolor{stringliteral}{"{}, value: "{}} + \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{814     \}}
\DoxyCodeLine{815 }
\DoxyCodeLine{816     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{817     \textcolor{keyword}{class }StreamConfigurationMap}
\DoxyCodeLine{818     \{}
\DoxyCodeLine{819     \textcolor{keyword}{public}:}
\DoxyCodeLine{820         StreamConfigurationMap (\textcolor{keyword}{const} GlobalRef\& cameraCharacteristicsToUse)}
\DoxyCodeLine{821             : scalerStreamConfigurationMap (getStreamConfigurationMap (cameraCharacteristicsToUse)),}
\DoxyCodeLine{822               supportedPreviewOutputSizes (retrieveOutputSizes (scalerStreamConfigurationMap,}
\DoxyCodeLine{823                                                                 getClassForName (\textcolor{stringliteral}{"{}android.graphics.SurfaceTexture"{}}),}
\DoxyCodeLine{824                                                                 -\/1)),}
\DoxyCodeLine{825               supportedStillImageOutputSizes (retrieveOutputSizes (scalerStreamConfigurationMap,}
\DoxyCodeLine{826                                                                    LocalRef<jobject>(),}
\DoxyCodeLine{827                                                                    jpegImageFormat)),}
\DoxyCodeLine{828               supportedVideoRecordingOutputSizes (retrieveOutputSizes (scalerStreamConfigurationMap,}
\DoxyCodeLine{829                                                                        getClassForName (\textcolor{stringliteral}{"{}android.media.MediaRecorder"{}}),}
\DoxyCodeLine{830                                                                        -\/1)),}
\DoxyCodeLine{831               defaultPreviewSize (getSmallestSize (supportedPreviewOutputSizes)),}
\DoxyCodeLine{832               previewBufferSize (getLargestSize (supportedPreviewOutputSizes))}
\DoxyCodeLine{833         \{}
\DoxyCodeLine{834             printSizesLog (supportedPreviewOutputSizes, \textcolor{stringliteral}{"{}SurfaceTexture"{}});}
\DoxyCodeLine{835             printSizesLog (supportedStillImageOutputSizes, \textcolor{stringliteral}{"{}JPEG"{}});}
\DoxyCodeLine{836             printSizesLog (supportedVideoRecordingOutputSizes, \textcolor{stringliteral}{"{}MediaRecorder"{}});}
\DoxyCodeLine{837         \}}
\DoxyCodeLine{838 }
\DoxyCodeLine{839         \mbox{\hyperlink{class_array}{Array<Rectangle<int>}}> getSupportedPreviewOutputSizes()        \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} supportedPreviewOutputSizes; \}}
\DoxyCodeLine{840         \mbox{\hyperlink{class_array}{Array<Rectangle<int>}}> getSupportedStillImageOutputSizes()     \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} supportedStillImageOutputSizes; \}}
\DoxyCodeLine{841         \mbox{\hyperlink{class_array}{Array<Rectangle<int>}}> getSupportedVideoRecordingOutputSizes() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} supportedVideoRecordingOutputSizes; \}}
\DoxyCodeLine{842 }
\DoxyCodeLine{843         \mbox{\hyperlink{class_rectangle}{Rectangle<int>}} getDefaultPreviewSize() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} defaultPreviewSize; \}}
\DoxyCodeLine{844         \mbox{\hyperlink{class_rectangle}{Rectangle<int>}} getPreviewBufferSize()  \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} previewBufferSize; \}}
\DoxyCodeLine{845 }
\DoxyCodeLine{846         \textcolor{keywordtype}{bool} isOutputSupportedForSurface (\textcolor{keyword}{const} LocalRef<jobject>\& surface)\textcolor{keyword}{ const}}
\DoxyCodeLine{847 \textcolor{keyword}{        }\{}
\DoxyCodeLine{848             \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallBooleanMethod (scalerStreamConfigurationMap, AndroidStreamConfigurationMap.isOutputSupportedForSurface, surface.get()) != 0;}
\DoxyCodeLine{849         \}}
\DoxyCodeLine{850 }
\DoxyCodeLine{851         \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} jpegImageFormat = 256;}
\DoxyCodeLine{852 }
\DoxyCodeLine{853     \textcolor{keyword}{private}:}
\DoxyCodeLine{854         GlobalRef scalerStreamConfigurationMap;}
\DoxyCodeLine{855 }
\DoxyCodeLine{856         \mbox{\hyperlink{class_array}{Array<Rectangle<int>}}> supportedPreviewOutputSizes;}
\DoxyCodeLine{857         \mbox{\hyperlink{class_array}{Array<Rectangle<int>}}> supportedStillImageOutputSizes;}
\DoxyCodeLine{858         \mbox{\hyperlink{class_array}{Array<Rectangle<int>}}> supportedVideoRecordingOutputSizes;}
\DoxyCodeLine{859         \mbox{\hyperlink{class_rectangle}{Rectangle<int>}} defaultPreviewSize, previewBufferSize;}
\DoxyCodeLine{860 }
\DoxyCodeLine{861         GlobalRef getStreamConfigurationMap (\textcolor{keyword}{const} GlobalRef\& cameraCharacteristicsToUse)}
\DoxyCodeLine{862         \{}
\DoxyCodeLine{863             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{864 }
\DoxyCodeLine{865             \textcolor{keyword}{auto} scalerStreamConfigurationMapKey = LocalRef<jobject> (env-\/>GetStaticObjectField (CameraCharacteristics,}
\DoxyCodeLine{866                                                                                                  CameraCharacteristics.SCALER\_STREAM\_CONFIGURATION\_MAP));}
\DoxyCodeLine{867 }
\DoxyCodeLine{868             \textcolor{keywordflow}{return} GlobalRef (LocalRef<jobject> (env-\/>CallObjectMethod (cameraCharacteristicsToUse,}
\DoxyCodeLine{869                                                                         CameraCharacteristics.get,}
\DoxyCodeLine{870                                                                         scalerStreamConfigurationMapKey.get())));}
\DoxyCodeLine{871         \}}
\DoxyCodeLine{872 }
\DoxyCodeLine{873         \textcolor{keyword}{static} \mbox{\hyperlink{class_array}{Array<Rectangle<int>}}> retrieveOutputSizes (GlobalRef\& scalerStreamConfigurationMap,}
\DoxyCodeLine{874                                                           \textcolor{keyword}{const} LocalRef<jobject>\& outputClass,}
\DoxyCodeLine{875                                                           \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}})}
\DoxyCodeLine{876         \{}
\DoxyCodeLine{877             \mbox{\hyperlink{class_array}{Array<Rectangle<int>}}> \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}};}
\DoxyCodeLine{878 }
\DoxyCodeLine{879             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{880 }
\DoxyCodeLine{881             \textcolor{keyword}{auto} outputSizes = outputClass.get() != \textcolor{keyword}{nullptr}}
\DoxyCodeLine{882                              ? LocalRef<jobjectArray> ((jobjectArray) env-\/>CallObjectMethod (scalerStreamConfigurationMap,}
\DoxyCodeLine{883                                                                                              AndroidStreamConfigurationMap.getOutputSizesForClass,}
\DoxyCodeLine{884                                                                                              outputClass.get()))}
\DoxyCodeLine{885                              : LocalRef<jobjectArray> ((jobjectArray) env-\/>CallObjectMethod (scalerStreamConfigurationMap,}
\DoxyCodeLine{886                                                                                              AndroidStreamConfigurationMap.getOutputSizesForFormat,}
\DoxyCodeLine{887                                                                                              (jint) \mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}));}
\DoxyCodeLine{888 }
\DoxyCodeLine{889             \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}} != -\/1)}
\DoxyCodeLine{890             \{}
\DoxyCodeLine{891                 \textcolor{keyword}{auto} supported = (env-\/>CallBooleanMethod (scalerStreamConfigurationMap, AndroidStreamConfigurationMap.isOutputSupportedFor, (jint) \mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}) != 0);}
\DoxyCodeLine{892 }
\DoxyCodeLine{893                 \textcolor{keywordflow}{if} (! supported)}
\DoxyCodeLine{894                 \{}
\DoxyCodeLine{895                     \textcolor{comment}{// The output format is not supported by this device, still image capture will not work!}}
\DoxyCodeLine{896                     \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{897                     \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{898                 \}}
\DoxyCodeLine{899             \}}
\DoxyCodeLine{900 }
\DoxyCodeLine{901             \textcolor{keywordtype}{int} numSizes = env-\/>GetArrayLength (outputSizes);}
\DoxyCodeLine{902 }
\DoxyCodeLine{903             \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (numSizes > 0);}
\DoxyCodeLine{904 }
\DoxyCodeLine{905             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < numSizes; ++i)}
\DoxyCodeLine{906             \{}
\DoxyCodeLine{907                 \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}} = LocalRef<jobject> (env-\/>GetObjectArrayElement (outputSizes, i));}
\DoxyCodeLine{908 }
\DoxyCodeLine{909                 \textcolor{keyword}{auto} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}}  = env-\/>CallIntMethod (\mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}, AndroidSize.getWidth);}
\DoxyCodeLine{910                 \textcolor{keyword}{auto} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} = env-\/>CallIntMethod (\mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}, AndroidSize.getHeight);}
\DoxyCodeLine{911 }
\DoxyCodeLine{912                 \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}}.add (\mbox{\hyperlink{class_rectangle}{Rectangle<int>}} (0, 0, \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}}, \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}}));}
\DoxyCodeLine{913             \}}
\DoxyCodeLine{914 }
\DoxyCodeLine{915             \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}};}
\DoxyCodeLine{916         \}}
\DoxyCodeLine{917 }
\DoxyCodeLine{918         \textcolor{keyword}{static} LocalRef<jobject> getClassForName (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \mbox{\hyperlink{namespacegl_a23f4d6c2fb3e8fdfb824894be7a695c2}{name}})}
\DoxyCodeLine{919         \{}
\DoxyCodeLine{920             \textcolor{keywordflow}{return} LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallStaticObjectMethod (JavaClass, JavaClass.forName,}
\DoxyCodeLine{921                                                                         javaString (\mbox{\hyperlink{namespacegl_a23f4d6c2fb3e8fdfb824894be7a695c2}{name}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}()));}
\DoxyCodeLine{922         \}}
\DoxyCodeLine{923 }
\DoxyCodeLine{924         \textcolor{keyword}{static} \textcolor{keywordtype}{void} printSizesLog (\textcolor{keyword}{const} \mbox{\hyperlink{class_array}{Array}}<\mbox{\hyperlink{class_rectangle}{Rectangle<int>}}>\& \mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}}, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& className)}
\DoxyCodeLine{925         \{}
\DoxyCodeLine{926             \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (\mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}}, className);}
\DoxyCodeLine{927 }
\DoxyCodeLine{928             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Sizes for class "{}} + className);}
\DoxyCodeLine{929 }
\DoxyCodeLine{930 \textcolor{preprocessor}{          \#if JUCE\_CAMERA\_LOG\_ENABLED}}
\DoxyCodeLine{931             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}} : \mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}})}
\DoxyCodeLine{932                 JUCE\_CAMERA\_LOG (\mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}}.toString() + \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{933 \textcolor{preprocessor}{          \#endif}}
\DoxyCodeLine{934         \}}
\DoxyCodeLine{935 }
\DoxyCodeLine{936         \mbox{\hyperlink{class_rectangle}{Rectangle<int>}} getSmallestSize (\textcolor{keyword}{const} \mbox{\hyperlink{class_array}{Array}}<\mbox{\hyperlink{class_rectangle}{Rectangle<int>}}>\& \mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}})\textcolor{keyword}{ const}}
\DoxyCodeLine{937 \textcolor{keyword}{        }\{}
\DoxyCodeLine{938             \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}}.size() == 0)}
\DoxyCodeLine{939                 \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{940 }
\DoxyCodeLine{941             \textcolor{keyword}{auto} smallestSize = \mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}}[0];}
\DoxyCodeLine{942 }
\DoxyCodeLine{943             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}} : \mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}})}
\DoxyCodeLine{944             \{}
\DoxyCodeLine{945                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}.getWidth() < smallestSize.getWidth() \&\& \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}.getHeight() < smallestSize.getHeight())}
\DoxyCodeLine{946                     smallestSize = \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}};}
\DoxyCodeLine{947             \}}
\DoxyCodeLine{948 }
\DoxyCodeLine{949             \textcolor{keywordflow}{return} smallestSize;}
\DoxyCodeLine{950         \}}
\DoxyCodeLine{951 }
\DoxyCodeLine{952         \mbox{\hyperlink{class_rectangle}{Rectangle<int>}} getLargestSize (\textcolor{keyword}{const} \mbox{\hyperlink{class_array}{Array}}<\mbox{\hyperlink{class_rectangle}{Rectangle<int>}}>\& \mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}})\textcolor{keyword}{ const}}
\DoxyCodeLine{953 \textcolor{keyword}{        }\{}
\DoxyCodeLine{954             \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}}.size() == 0)}
\DoxyCodeLine{955                 \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{956 }
\DoxyCodeLine{957             \textcolor{keyword}{auto} largestSize = \mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}}[0];}
\DoxyCodeLine{958 }
\DoxyCodeLine{959             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}} : \mbox{\hyperlink{namespacegl_a53714ae87440f8b11d33209e7093ace3}{sizes}})}
\DoxyCodeLine{960             \{}
\DoxyCodeLine{961                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}.getWidth() > largestSize.getWidth() \&\& \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}.getHeight() > largestSize.getHeight())}
\DoxyCodeLine{962                     largestSize = \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}};}
\DoxyCodeLine{963             \}}
\DoxyCodeLine{964 }
\DoxyCodeLine{965             \textcolor{keywordflow}{return} largestSize;}
\DoxyCodeLine{966         \}}
\DoxyCodeLine{967     \};}
\DoxyCodeLine{968 }
\DoxyCodeLine{969     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{970     \textcolor{keyword}{class }PreviewDisplay    : \textcolor{keyword}{private} \mbox{\hyperlink{struct_texture_view_surface_texture_listener_1_1_owner}{TextureViewSurfaceTextureListener::Owner}}}
\DoxyCodeLine{971     \{}
\DoxyCodeLine{972     \textcolor{keyword}{public}:}
\DoxyCodeLine{973         \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_preview_display_1_1_listener}{Listener}}}
\DoxyCodeLine{974         \{}
\DoxyCodeLine{975             \textcolor{keyword}{virtual} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_preview_display_1_1_listener_aff268c732df00c7666776dcf07c47dd9}{\string~Listener}}() \{\}}
\DoxyCodeLine{976 }
\DoxyCodeLine{977             \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_preview_display_1_1_listener_af442bad6d05cc5e55edfc27cf69baf30}{previewDisplayReady}}() = 0;}
\DoxyCodeLine{978             \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_preview_display_1_1_listener_ad8cd593814551a88a1608d2e36984be8}{previewDisplayAboutToBeDestroyed}}() = 0;}
\DoxyCodeLine{979         \};}
\DoxyCodeLine{980 }
\DoxyCodeLine{981         PreviewDisplay (\mbox{\hyperlink{class_rectangle}{Rectangle<int>}} \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}})}
\DoxyCodeLine{982             : textureViewSurfaceTextureListener (*this),}
\DoxyCodeLine{983               textureView (LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewObject (AndroidTextureView, AndroidTextureView.constructor,}
\DoxyCodeLine{984                                                                    \mbox{\hyperlink{namespacejuce_ae270c2dd4b358c3482f8950a283a36af}{getAppContext}}().\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}()))),}
\DoxyCodeLine{985               bufferWidth (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}}.getWidth()),}
\DoxyCodeLine{986               bufferHeight (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}}.getHeight())}
\DoxyCodeLine{987         \{}
\DoxyCodeLine{988             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{989 }
\DoxyCodeLine{990             \textcolor{keywordflow}{if} (! isReady())}
\DoxyCodeLine{991                 env-\/>CallVoidMethod (textureView, AndroidTextureView.setSurfaceTextureListener,}
\DoxyCodeLine{992                                      \mbox{\hyperlink{namespacejuce_aa5d43f5b68766ba8c811e4e17df96a3e}{CreateJavaInterface}} (\&textureViewSurfaceTextureListener,}
\DoxyCodeLine{993                                                           \textcolor{stringliteral}{"{}android/view/TextureView\$SurfaceTextureListener"{}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}());}
\DoxyCodeLine{994         \}}
\DoxyCodeLine{995 }
\DoxyCodeLine{996         \string~PreviewDisplay()\textcolor{keyword}{ override}}
\DoxyCodeLine{997 \textcolor{keyword}{        }\{}
\DoxyCodeLine{998             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (textureView, AndroidTextureView.setSurfaceTextureListener, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{999         \}}
\DoxyCodeLine{1000 }
\DoxyCodeLine{1001         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a631a4ade218dfddc56d588c5b03fd1ca}{addListener}} (Listener* l)}
\DoxyCodeLine{1002         \{}
\DoxyCodeLine{1003             \textcolor{keywordflow}{if} (l == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1004             \{}
\DoxyCodeLine{1005                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{1006                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{1007             \}}
\DoxyCodeLine{1008 }
\DoxyCodeLine{1009             listeners.add (l);}
\DoxyCodeLine{1010 }
\DoxyCodeLine{1011             \textcolor{keywordflow}{if} (isReady())}
\DoxyCodeLine{1012                 l-\/>previewDisplayReady();}
\DoxyCodeLine{1013         \}}
\DoxyCodeLine{1014 }
\DoxyCodeLine{1015         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a39c0df63795c33e8e22f16451349a36f}{removeListener}} (Listener* l)}
\DoxyCodeLine{1016         \{}
\DoxyCodeLine{1017             \textcolor{keywordflow}{if} (l == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1018             \{}
\DoxyCodeLine{1019                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{1020                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{1021             \}}
\DoxyCodeLine{1022 }
\DoxyCodeLine{1023             listeners.remove (l);}
\DoxyCodeLine{1024         \}}
\DoxyCodeLine{1025 }
\DoxyCodeLine{1026         \textcolor{keywordtype}{bool} isReady()\textcolor{keyword}{ const}}
\DoxyCodeLine{1027 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1028             \textcolor{keywordflow}{return} (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallBooleanMethod (textureView, AndroidTextureView.isAvailable) != 0)}
\DoxyCodeLine{1029                     \&\& \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}} > 0 \&\& \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} > 0;}
\DoxyCodeLine{1030         \}}
\DoxyCodeLine{1031 }
\DoxyCodeLine{1032         LocalRef<jobject> createSurface()}
\DoxyCodeLine{1033         \{}
\DoxyCodeLine{1034             \textcolor{comment}{// Surface may get destroyed while session is being configured, if}}
\DoxyCodeLine{1035             \textcolor{comment}{// the preview gets hidden in the meantime, so bailout.}}
\DoxyCodeLine{1036             \textcolor{keywordflow}{if} (! isReady())}
\DoxyCodeLine{1037                 \textcolor{keywordflow}{return} LocalRef<jobject> (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{1038 }
\DoxyCodeLine{1039             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1040 }
\DoxyCodeLine{1041             \textcolor{keyword}{auto} surfaceTexture = LocalRef<jobject> (env-\/>CallObjectMethod (textureView,}
\DoxyCodeLine{1042                                                                             AndroidTextureView.getSurfaceTexture));}
\DoxyCodeLine{1043 }
\DoxyCodeLine{1044             \textcolor{comment}{// NB: too small buffer will result in pixelated preview. A buffer with wrong aspect ratio}}
\DoxyCodeLine{1045             \textcolor{comment}{//     can result in a cropped preview.}}
\DoxyCodeLine{1046             env-\/>CallVoidMethod (surfaceTexture, AndroidSurfaceTexture.setDefaultBufferSize, (jint) bufferWidth, (jint) bufferHeight);}
\DoxyCodeLine{1047 }
\DoxyCodeLine{1048             \textcolor{keyword}{auto} surface = LocalRef<jobject> (env-\/>NewObject (AndroidSurface, AndroidSurface.constructor, surfaceTexture.get()));}
\DoxyCodeLine{1049 }
\DoxyCodeLine{1050             \textcolor{keywordflow}{return} surface;}
\DoxyCodeLine{1051         \}}
\DoxyCodeLine{1052 }
\DoxyCodeLine{1053         \textcolor{keyword}{const} GlobalRef\& getNativeView() \{ \textcolor{keywordflow}{return} textureView; \}}
\DoxyCodeLine{1054 }
\DoxyCodeLine{1055         \textcolor{keywordtype}{void} updateSurfaceTransform()}
\DoxyCodeLine{1056         \{}
\DoxyCodeLine{1057             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1058 }
\DoxyCodeLine{1059             \textcolor{keyword}{auto} windowManager = LocalRef<jobject> (env-\/>CallObjectMethod (\mbox{\hyperlink{namespacejuce_ae270c2dd4b358c3482f8950a283a36af}{getAppContext}}(), AndroidContext.getSystemService, javaString (\textcolor{stringliteral}{"{}window"{}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}()));}
\DoxyCodeLine{1060             \textcolor{keyword}{auto} display = LocalRef<jobject> (env-\/>CallObjectMethod (windowManager, AndroidWindowManager.getDefaultDisplay));}
\DoxyCodeLine{1061             \textcolor{keyword}{auto} rotation = env-\/>CallIntMethod (display, AndroidDisplay.getRotation);}
\DoxyCodeLine{1062 }
\DoxyCodeLine{1063             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} rotation90 = 1;}
\DoxyCodeLine{1064             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} rotation270 = 3;}
\DoxyCodeLine{1065 }
\DoxyCodeLine{1066             \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a252fac6136c8e26e7f77884112024ce6}{matrix}} = LocalRef<jobject> (env-\/>NewObject (AndroidMatrix, AndroidMatrix.constructor));}
\DoxyCodeLine{1067 }
\DoxyCodeLine{1068             \textcolor{keywordflow}{if} (rotation == rotation90 || rotation == rotation270)}
\DoxyCodeLine{1069             \{}
\DoxyCodeLine{1070                 env-\/>CallBooleanMethod (\mbox{\hyperlink{namespacegl_a252fac6136c8e26e7f77884112024ce6}{matrix}}, AndroidMatrix.postScale, jfloat ((\textcolor{keywordtype}{float}) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} / (\textcolor{keywordtype}{float}) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}}), jfloat ((\textcolor{keywordtype}{float}) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}} / (\textcolor{keywordtype}{float}) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}}), (jfloat) 0, (jfloat) 0);}
\DoxyCodeLine{1071                 env-\/>CallBooleanMethod (\mbox{\hyperlink{namespacegl_a252fac6136c8e26e7f77884112024ce6}{matrix}}, AndroidMatrix.postRotate, (jfloat) 90 * ((\textcolor{keywordtype}{float}) rotation -\/ 2), (jfloat) 0, (jfloat) 0);}
\DoxyCodeLine{1072                 env-\/>CallBooleanMethod (\mbox{\hyperlink{namespacegl_a252fac6136c8e26e7f77884112024ce6}{matrix}}, AndroidMatrix.postTranslate, (jfloat) (rotation == 3 ? \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}} : 0), (jfloat) (rotation == 1 ? \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} : 0));}
\DoxyCodeLine{1073             \}}
\DoxyCodeLine{1074 }
\DoxyCodeLine{1075             env-\/>CallVoidMethod (textureView, AndroidTextureView.setTransform, \mbox{\hyperlink{namespacegl_a252fac6136c8e26e7f77884112024ce6}{matrix}}.get());}
\DoxyCodeLine{1076         \}}
\DoxyCodeLine{1077 }
\DoxyCodeLine{1078     \textcolor{keyword}{private}:}
\DoxyCodeLine{1079         \mbox{\hyperlink{class_listener_list}{ListenerList<Listener>}} listeners;}
\DoxyCodeLine{1080 }
\DoxyCodeLine{1081         \mbox{\hyperlink{class_texture_view_surface_texture_listener}{TextureViewSurfaceTextureListener}} textureViewSurfaceTextureListener;}
\DoxyCodeLine{1082         GlobalRef textureView;}
\DoxyCodeLine{1083         \textcolor{keywordtype}{int} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}} = -\/1, \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} = -\/1;}
\DoxyCodeLine{1084         \textcolor{keywordtype}{int} bufferWidth, bufferHeight;}
\DoxyCodeLine{1085 }
\DoxyCodeLine{1086         \textcolor{keywordtype}{void} onSurfaceTextureAvailable (LocalRef<jobject>\& \textcolor{comment}{/*surface*/}, \textcolor{keywordtype}{int} widthToUse, \textcolor{keywordtype}{int} heightToUse)\textcolor{keyword}{ override}}
\DoxyCodeLine{1087 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1088             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}onSurfaceTextureAvailable()"{}});}
\DoxyCodeLine{1089 }
\DoxyCodeLine{1090             \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}} = widthToUse;}
\DoxyCodeLine{1091             \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} = heightToUse;}
\DoxyCodeLine{1092 }
\DoxyCodeLine{1093             updateSurfaceTransform();}
\DoxyCodeLine{1094 }
\DoxyCodeLine{1095             listeners.\mbox{\hyperlink{class_listener_list_adea25521b1707f2f5ae242b3353f5751}{call}} (\&\mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_preview_display_1_1_listener_af442bad6d05cc5e55edfc27cf69baf30}{Listener::previewDisplayReady}});}
\DoxyCodeLine{1096         \}}
\DoxyCodeLine{1097 }
\DoxyCodeLine{1098         \textcolor{keywordtype}{bool} onSurfaceTextureDestroyed (LocalRef<jobject>\& \textcolor{comment}{/*surface*/})\textcolor{keyword}{ override}}
\DoxyCodeLine{1099 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1100             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}onSurfaceTextureDestroyed()"{}});}
\DoxyCodeLine{1101 }
\DoxyCodeLine{1102             listeners.\mbox{\hyperlink{class_listener_list_adea25521b1707f2f5ae242b3353f5751}{call}} (\&\mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_preview_display_1_1_listener_ad8cd593814551a88a1608d2e36984be8}{Listener::previewDisplayAboutToBeDestroyed}});}
\DoxyCodeLine{1103 }
\DoxyCodeLine{1104             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{1105         \}}
\DoxyCodeLine{1106 }
\DoxyCodeLine{1107         \textcolor{keywordtype}{void} onSurfaceTextureSizeChanged (LocalRef<jobject>\& \textcolor{comment}{/*surface*/}, \textcolor{keywordtype}{int} widthToUse, \textcolor{keywordtype}{int} heightToUse)\textcolor{keyword}{ override}}
\DoxyCodeLine{1108 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1109             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}onSurfaceTextureSizeChanged()"{}});}
\DoxyCodeLine{1110 }
\DoxyCodeLine{1111             \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}} = widthToUse;}
\DoxyCodeLine{1112             \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} = heightToUse;}
\DoxyCodeLine{1113 }
\DoxyCodeLine{1114             updateSurfaceTransform();}
\DoxyCodeLine{1115         \}}
\DoxyCodeLine{1116 }
\DoxyCodeLine{1117         \textcolor{keywordtype}{void} onSurfaceTextureUpdated (LocalRef<jobject>\& \textcolor{comment}{/*surface*/})\textcolor{keyword}{ override}}
\DoxyCodeLine{1118 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1119             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}onSurfaceTextureUpdated()"{}});}
\DoxyCodeLine{1120         \}}
\DoxyCodeLine{1121 }
\DoxyCodeLine{1122         \mbox{\hyperlink{group__juce__core-system_ga6ab7a603bf4435c7cb286b1744366eb2}{JUCE\_DECLARE\_NON\_COPYABLE}} (PreviewDisplay)}
\DoxyCodeLine{1123     \};}
\DoxyCodeLine{1124 }
\DoxyCodeLine{1125     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1126     \textcolor{keyword}{class }ImageReader   : \textcolor{keyword}{private} \mbox{\hyperlink{struct_image_reader_on_image_available_listener_1_1_owner}{ImageReaderOnImageAvailableListener::Owner}}}
\DoxyCodeLine{1127     \{}
\DoxyCodeLine{1128     \textcolor{keyword}{public}:}
\DoxyCodeLine{1129         ImageReader (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& ownerToUse, GlobalRef\& handlerToUse,}
\DoxyCodeLine{1130                      \textcolor{keywordtype}{int} imageWidth, \textcolor{keywordtype}{int} imageHeight, \textcolor{keywordtype}{int} cameraSensorOrientationToUse)}
\DoxyCodeLine{1131             : owner (ownerToUse),}
\DoxyCodeLine{1132               cameraSensorOrientation (cameraSensorOrientationToUse),}
\DoxyCodeLine{1133               imageReader (LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallStaticObjectMethod (AndroidImageReader, AndroidImageReader.newInstance,}
\DoxyCodeLine{1134                                                                                 imageWidth, imageHeight, StreamConfigurationMap::jpegImageFormat,}
\DoxyCodeLine{1135                                                                                 numImagesToKeep))),}
\DoxyCodeLine{1136               onImageAvailableListener (*this)}
\DoxyCodeLine{1137         \{}
\DoxyCodeLine{1138             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (imageReader, AndroidImageReader.setOnImageAvailableListener,}
\DoxyCodeLine{1139                                       \mbox{\hyperlink{namespacejuce_aa5d43f5b68766ba8c811e4e17df96a3e}{CreateJavaInterface}} (\&onImageAvailableListener,}
\DoxyCodeLine{1140                                                            \textcolor{stringliteral}{"{}android/media/ImageReader\$OnImageAvailableListener"{}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}(),}
\DoxyCodeLine{1141                                       handlerToUse.get());}
\DoxyCodeLine{1142         \}}
\DoxyCodeLine{1143 }
\DoxyCodeLine{1144         \string~ImageReader()\textcolor{keyword}{ override}}
\DoxyCodeLine{1145 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1146             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (imageReader, AndroidImageReader.close);}
\DoxyCodeLine{1147         \}}
\DoxyCodeLine{1148 }
\DoxyCodeLine{1149         LocalRef<jobject> getSurface()\textcolor{keyword}{ const}}
\DoxyCodeLine{1150 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1151             \textcolor{keywordflow}{return} LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallObjectMethod (imageReader, AndroidImageReader.getSurface));}
\DoxyCodeLine{1152         \}}
\DoxyCodeLine{1153 }
\DoxyCodeLine{1154         \textcolor{keywordtype}{void} resetNotificationFlag()}
\DoxyCodeLine{1155         \{}
\DoxyCodeLine{1156             hasNotifiedListeners.set (0);}
\DoxyCodeLine{1157         \}}
\DoxyCodeLine{1158 }
\DoxyCodeLine{1159     \textcolor{keyword}{private}:}
\DoxyCodeLine{1160         \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& owner;}
\DoxyCodeLine{1161         \textcolor{keywordtype}{int} cameraSensorOrientation;}
\DoxyCodeLine{1162 }
\DoxyCodeLine{1163         GlobalRef imageReader;}
\DoxyCodeLine{1164         \mbox{\hyperlink{class_image_reader_on_image_available_listener}{ImageReaderOnImageAvailableListener}} onImageAvailableListener;}
\DoxyCodeLine{1165         \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} numImagesToKeep = 2;}
\DoxyCodeLine{1166         \mbox{\hyperlink{struct_atomic}{Atomic<int>}} hasNotifiedListeners \{ 0 \};}
\DoxyCodeLine{1167 }
\DoxyCodeLine{1168         \mbox{\hyperlink{group__juce__core-memory_ga557fa9dbf924a150e27f0cf0dad368b0}{JUCE\_DECLARE\_WEAK\_REFERENCEABLE}} (ImageReader)}
\DoxyCodeLine{1169 }
\DoxyCodeLine{1170         \textcolor{keywordtype}{void} onImageAvailable (LocalRef<jobject>\& \textcolor{comment}{/*imageReader*/})\textcolor{keyword}{ override}}
\DoxyCodeLine{1171 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1172             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}onImageAvailable()"{}});}
\DoxyCodeLine{1173 }
\DoxyCodeLine{1174             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176             \textcolor{keyword}{auto} jImage = LocalRef<jobject> (env-\/>CallObjectMethod (imageReader, AndroidImageReader.acquireLatestImage));}
\DoxyCodeLine{1177 }
\DoxyCodeLine{1178             \textcolor{keywordflow}{if} (jImage.get() == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1179                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{1180 }
\DoxyCodeLine{1181             \textcolor{keyword}{auto} cameraLensFrontFacing = owner.getCameraLensFacing() == 0;}
\DoxyCodeLine{1182 }
\DoxyCodeLine{1183             \textcolor{comment}{// NB: could use sensor orientation here to get real-\/world orientation, but then the resulting}}
\DoxyCodeLine{1184             \textcolor{comment}{//     image could not match the UI orientation.}}
\DoxyCodeLine{1185             \textcolor{keyword}{auto} \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}} = androidImageToJuceWithFixedOrientation (jImage, owner.deviceOrientationChangeListener.getDeviceOrientation(),}
\DoxyCodeLine{1186                                                                  \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_a02ae21e312faf1715e8311f1f53e5e00}{getCurrentOrientation}}(),}
\DoxyCodeLine{1187                                                                  cameraLensFrontFacing,}
\DoxyCodeLine{1188                                                                  cameraSensorOrientation);}
\DoxyCodeLine{1189 }
\DoxyCodeLine{1190             env-\/>CallVoidMethod (jImage, AndroidImage.close);}
\DoxyCodeLine{1191 }
\DoxyCodeLine{1192             owner.callListeners (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{1193 }
\DoxyCodeLine{1194             \textcolor{comment}{// Android may take multiple pictures before it handles a request to stop.}}
\DoxyCodeLine{1195             \textcolor{keywordflow}{if} (hasNotifiedListeners.compareAndSetBool (1, 0))}
\DoxyCodeLine{1196                 \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([safeThis = \mbox{\hyperlink{class_weak_reference}{WeakReference<ImageReader>}} \{ \textcolor{keyword}{this} \}, \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}]() \textcolor{keyword}{mutable}}
\DoxyCodeLine{1197                 \{}
\DoxyCodeLine{1198                     \textcolor{keywordflow}{if} (safeThis != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1199                         safeThis-\/>owner.notifyPictureTaken (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{1200                 \});}
\DoxyCodeLine{1201         \}}
\DoxyCodeLine{1202 }
\DoxyCodeLine{1203         \textcolor{keyword}{struct }ImageBuffer}
\DoxyCodeLine{1204         \{}
\DoxyCodeLine{1205             LocalRef<jbyteArray> byteArray;}
\DoxyCodeLine{1206             \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}};}
\DoxyCodeLine{1207         \};}
\DoxyCodeLine{1208 }
\DoxyCodeLine{1209         \textcolor{keyword}{static} \mbox{\hyperlink{class_image}{Image}} androidImageToJuceWithFixedOrientation (\textcolor{keyword}{const} LocalRef<jobject>\& androidImage,}
\DoxyCodeLine{1210                                                              \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} deviceOrientationFromAccelerometerSensor,}
\DoxyCodeLine{1211                                                              \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} targetOrientation,}
\DoxyCodeLine{1212                                                              \textcolor{keywordtype}{bool} cameraLensFrontFacing,}
\DoxyCodeLine{1213                                                              \textcolor{keywordtype}{int} cameraSensorOrientation)}
\DoxyCodeLine{1214         \{}
\DoxyCodeLine{1215             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1216 }
\DoxyCodeLine{1217             \textcolor{keyword}{auto} planes = LocalRef<jobjectArray> ((jobjectArray) env-\/>CallObjectMethod (androidImage, AndroidImage.getPlanes));}
\DoxyCodeLine{1218             \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (env-\/>GetArrayLength (planes) > 0);}
\DoxyCodeLine{1219 }
\DoxyCodeLine{1220             \textcolor{keyword}{auto} plane = LocalRef<jobject> (env-\/>GetObjectArrayElement (planes, 0));}
\DoxyCodeLine{1221             \textcolor{keyword}{auto} byteBuffer = LocalRef<jobject> (env-\/>CallObjectMethod (plane, AndroidImagePlane.getBuffer));}
\DoxyCodeLine{1222 }
\DoxyCodeLine{1223             ImageBuffer correctedBuffer = getImageBufferWithCorrectedOrientationFrom (byteBuffer, deviceOrientationFromAccelerometerSensor,}
\DoxyCodeLine{1224                                                                                       targetOrientation, cameraLensFrontFacing, cameraSensorOrientation);}
\DoxyCodeLine{1225 }
\DoxyCodeLine{1226             jbyte* rawBytes = env-\/>GetByteArrayElements (correctedBuffer.byteArray, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{1227 }
\DoxyCodeLine{1228             \mbox{\hyperlink{class_image}{Image}} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} = \mbox{\hyperlink{class_image_file_format_aa5cf7b6f03682432ae93df3c3defc2b7}{ImageFileFormat::loadFrom}} (rawBytes, (\textcolor{keywordtype}{size\_t}) correctedBuffer.size);}
\DoxyCodeLine{1229 }
\DoxyCodeLine{1230             env-\/>ReleaseByteArrayElements (correctedBuffer.byteArray, rawBytes, 0);}
\DoxyCodeLine{1231 }
\DoxyCodeLine{1232             \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}};}
\DoxyCodeLine{1233         \}}
\DoxyCodeLine{1234 }
\DoxyCodeLine{1235         \textcolor{keyword}{static} ImageBuffer getImageBufferWithCorrectedOrientationFrom (\textcolor{keyword}{const} LocalRef<jobject>\& imagePlaneBuffer,}
\DoxyCodeLine{1236                                                                        \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} deviceOrientationFromAccelerometerSensor,}
\DoxyCodeLine{1237                                                                        \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} targetOrientation,}
\DoxyCodeLine{1238                                                                        \textcolor{keywordtype}{bool} cameraLensFrontFacing,}
\DoxyCodeLine{1239                                                                        \textcolor{keywordtype}{int} cameraSensorOrientation)}
\DoxyCodeLine{1240         \{}
\DoxyCodeLine{1241             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1242 }
\DoxyCodeLine{1243             \textcolor{keyword}{auto} \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}} = env-\/>CallIntMethod (imagePlaneBuffer, JavaByteBuffer.remaining);}
\DoxyCodeLine{1244             \textcolor{keyword}{auto} byteArray = LocalRef<jbyteArray> (env-\/>NewByteArray (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}}));}
\DoxyCodeLine{1245             env-\/>CallObjectMethod (imagePlaneBuffer, JavaByteBuffer.get, byteArray.get());}
\DoxyCodeLine{1246 }
\DoxyCodeLine{1247             \textcolor{keyword}{auto} rotationAngle = getRotationAngle (deviceOrientationFromAccelerometerSensor, targetOrientation,}
\DoxyCodeLine{1248                                                   cameraLensFrontFacing, cameraSensorOrientation);}
\DoxyCodeLine{1249 }
\DoxyCodeLine{1250             \textcolor{keywordflow}{if} (rotationAngle == 0)}
\DoxyCodeLine{1251             \{}
\DoxyCodeLine{1252                 \textcolor{comment}{// Nothing to do, just get the bytes}}
\DoxyCodeLine{1253                 \textcolor{keywordflow}{return} \{ byteArray, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}} \};}
\DoxyCodeLine{1254             \}}
\DoxyCodeLine{1255 }
\DoxyCodeLine{1256             \textcolor{keyword}{auto} origBitmap = LocalRef<jobject> (env-\/>CallStaticObjectMethod (AndroidBitmapFactory,}
\DoxyCodeLine{1257                                                                               AndroidBitmapFactory.decodeByteArray,}
\DoxyCodeLine{1258                                                                               byteArray.get(), (jint) 0, (jint) \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}}));}
\DoxyCodeLine{1259 }
\DoxyCodeLine{1260             \textcolor{keywordflow}{if} (origBitmap == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1261             \{}
\DoxyCodeLine{1262                 \textcolor{comment}{// Nothing to do, just get the bytes}}
\DoxyCodeLine{1263                 \textcolor{keywordflow}{return} \{ byteArray, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}} \};}
\DoxyCodeLine{1264             \}}
\DoxyCodeLine{1265 }
\DoxyCodeLine{1266             \textcolor{keyword}{auto} correctedBitmap = getBitmapWithCorrectOrientationFrom (origBitmap, rotationAngle);}
\DoxyCodeLine{1267 }
\DoxyCodeLine{1268             \textcolor{keyword}{auto} byteArrayOutputStream = LocalRef<jobject> (env-\/>NewObject (ByteArrayOutputStream,}
\DoxyCodeLine{1269                                                                             ByteArrayOutputStream.constructor));}
\DoxyCodeLine{1270 }
\DoxyCodeLine{1271             \textcolor{keyword}{auto} jCompressFormatString = javaString (\textcolor{stringliteral}{"{}JPEG"{}});}
\DoxyCodeLine{1272             \textcolor{keyword}{auto} compressFormat = LocalRef<jobject> (env-\/>CallStaticObjectMethod (AndroidBitmapCompressFormat,}
\DoxyCodeLine{1273                                                                                   AndroidBitmapCompressFormat.valueOf,}
\DoxyCodeLine{1274                                                                                   jCompressFormatString.get()));}
\DoxyCodeLine{1275 }
\DoxyCodeLine{1276             \textcolor{keywordflow}{if} (env-\/>CallBooleanMethod (correctedBitmap, AndroidBitmap.compress, compressFormat.get(),}
\DoxyCodeLine{1277                                         (jint) 100, byteArrayOutputStream.get()) != 0)}
\DoxyCodeLine{1278             \{}
\DoxyCodeLine{1279                 \textcolor{keyword}{auto} correctedByteArray = LocalRef<jbyteArray> ((jbyteArray) env-\/>CallObjectMethod (byteArrayOutputStream,}
\DoxyCodeLine{1280                                                                                                     ByteArrayOutputStream.toByteArray));}
\DoxyCodeLine{1281 }
\DoxyCodeLine{1282                 \textcolor{keywordtype}{int} correctedByteArraySize = env-\/>CallIntMethod (byteArrayOutputStream, ByteArrayOutputStream.size);}
\DoxyCodeLine{1283 }
\DoxyCodeLine{1284                 \textcolor{keywordflow}{return} \{ correctedByteArray, correctedByteArraySize \};}
\DoxyCodeLine{1285             \}}
\DoxyCodeLine{1286 }
\DoxyCodeLine{1287             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{1288             \textcolor{comment}{// fallback, return original bitmap}}
\DoxyCodeLine{1289             \textcolor{keywordflow}{return} \{ byteArray, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a8556d19b129aa550f5b2819ed0320e83}{bufferSize}} \};}
\DoxyCodeLine{1290         \}}
\DoxyCodeLine{1291 }
\DoxyCodeLine{1292         \textcolor{keyword}{static} \textcolor{keywordtype}{int} getRotationAngle (\mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} deviceOrientationFromAccelerometerSensor,}
\DoxyCodeLine{1293                                      \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} targetOrientation,}
\DoxyCodeLine{1294                                      \textcolor{keywordtype}{bool} cameraLensFrontFacing,}
\DoxyCodeLine{1295                                      \textcolor{keywordtype}{int} cameraSensorOrientation)}
\DoxyCodeLine{1296         \{}
\DoxyCodeLine{1297             \textcolor{keyword}{auto} isSensorOrientationHorizontal = deviceOrientationFromAccelerometerSensor == \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aab48176789b5764aae6aae6a393916712}{Desktop::rotatedAntiClockwise}}}
\DoxyCodeLine{1298                                               || deviceOrientationFromAccelerometerSensor == \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aae1e0629de1668ef16f700b7278fd0f04}{Desktop::rotatedClockwise}};}
\DoxyCodeLine{1299 }
\DoxyCodeLine{1300             \textcolor{keywordflow}{if} (cameraLensFrontFacing \&\& isSensorOrientationHorizontal)}
\DoxyCodeLine{1301             \{}
\DoxyCodeLine{1302                 \textcolor{comment}{// flip angles for front camera}}
\DoxyCodeLine{1303                 \textcolor{keywordflow}{return} getRotationAngle (deviceOrientationFromAccelerometerSensor, targetOrientation, \textcolor{keyword}{false}, (cameraSensorOrientation + 180) \% 360);}
\DoxyCodeLine{1304             \}}
\DoxyCodeLine{1305 }
\DoxyCodeLine{1306             \textcolor{keywordflow}{switch} (targetOrientation)}
\DoxyCodeLine{1307             \{}
\DoxyCodeLine{1308                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aab48176789b5764aae6aae6a393916712}{Desktop::rotatedAntiClockwise}}:}
\DoxyCodeLine{1309                     \textcolor{keywordflow}{return} cameraSensorOrientation == 90 ? 0 : 180;}
\DoxyCodeLine{1310                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aae1e0629de1668ef16f700b7278fd0f04}{Desktop::rotatedClockwise}}:}
\DoxyCodeLine{1311                     \textcolor{keywordflow}{return} cameraSensorOrientation == 90 ? 180 : 0;}
\DoxyCodeLine{1312                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aaced7253546b0f2e73e4dd08bcb60c9f8}{Desktop::upright}}:}
\DoxyCodeLine{1313                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aa5820a6ffe2f7f012a16a1bd57e304b91}{Desktop::upsideDown}}:}
\DoxyCodeLine{1314                     \textcolor{keywordflow}{if} ((targetOrientation == \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aaced7253546b0f2e73e4dd08bcb60c9f8}{Desktop::upright}} \&\& ! cameraLensFrontFacing)}
\DoxyCodeLine{1315                         || (targetOrientation == \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aa5820a6ffe2f7f012a16a1bd57e304b91}{Desktop::upsideDown}} \&\& cameraLensFrontFacing))}
\DoxyCodeLine{1316                     \{}
\DoxyCodeLine{1317                         \textcolor{keywordflow}{return} cameraSensorOrientation;}
\DoxyCodeLine{1318                     \}}
\DoxyCodeLine{1319                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1320                     \{}
\DoxyCodeLine{1321                         \textcolor{keywordflow}{if} (deviceOrientationFromAccelerometerSensor == \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aaced7253546b0f2e73e4dd08bcb60c9f8}{Desktop::upright}} || deviceOrientationFromAccelerometerSensor == \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aa5820a6ffe2f7f012a16a1bd57e304b91}{Desktop::upsideDown}})}
\DoxyCodeLine{1322                             \textcolor{keywordflow}{return} cameraSensorOrientation;}
\DoxyCodeLine{1323                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1324                             \textcolor{keywordflow}{return} (cameraSensorOrientation + 180) \% 360;}
\DoxyCodeLine{1325                     \}}
\DoxyCodeLine{1326                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{1327                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aacb260a5600c352a166edd836a2305a06}{Desktop::allOrientations}}:}
\DoxyCodeLine{1328                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{1329                     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1330             \}}
\DoxyCodeLine{1331         \}}
\DoxyCodeLine{1332 }
\DoxyCodeLine{1333         \textcolor{keyword}{static} LocalRef<jobject> getBitmapWithCorrectOrientationFrom (LocalRef<jobject>\& origBitmap, \textcolor{keywordtype}{int} rotationAngle)}
\DoxyCodeLine{1334         \{}
\DoxyCodeLine{1335             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1336 }
\DoxyCodeLine{1337             \textcolor{keyword}{auto} origBitmapWidth  = env-\/>CallIntMethod (origBitmap, AndroidBitmap.getWidth);}
\DoxyCodeLine{1338             \textcolor{keyword}{auto} origBitmapHeight = env-\/>CallIntMethod (origBitmap, AndroidBitmap.getHeight);}
\DoxyCodeLine{1339 }
\DoxyCodeLine{1340             \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a252fac6136c8e26e7f77884112024ce6}{matrix}} = LocalRef<jobject> (env-\/>NewObject (AndroidMatrix, AndroidMatrix.constructor));}
\DoxyCodeLine{1341             env-\/>CallBooleanMethod (\mbox{\hyperlink{namespacegl_a252fac6136c8e26e7f77884112024ce6}{matrix}}, AndroidMatrix.postRotate, (jfloat) rotationAngle, (jfloat) 0, (jfloat) 0);}
\DoxyCodeLine{1342 }
\DoxyCodeLine{1343             \textcolor{keyword}{auto} rotatedBitmap = LocalRef<jobject> (env-\/>CallStaticObjectMethod (AndroidBitmap, AndroidBitmap.createBitmapFrom,}
\DoxyCodeLine{1344                                                                                  origBitmap.get(), (jint) 0, (jint) 0,}
\DoxyCodeLine{1345                                                                                  (jint) origBitmapWidth, (jint) origBitmapHeight,}
\DoxyCodeLine{1346                                                                                  \mbox{\hyperlink{namespacegl_a252fac6136c8e26e7f77884112024ce6}{matrix}}.get(), \textcolor{keyword}{true}));}
\DoxyCodeLine{1347 }
\DoxyCodeLine{1348             env-\/>CallVoidMethod (origBitmap, AndroidBitmap.recycle);}
\DoxyCodeLine{1349 }
\DoxyCodeLine{1350             \textcolor{keywordflow}{return} rotatedBitmap;}
\DoxyCodeLine{1351         \}}
\DoxyCodeLine{1352     \};}
\DoxyCodeLine{1353 }
\DoxyCodeLine{1354     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1355     \textcolor{keyword}{class }MediaRecorder : \textcolor{keyword}{private} \mbox{\hyperlink{struct_media_recorder_on_info_listener_1_1_owner}{MediaRecorderOnInfoListener::Owner}},}
\DoxyCodeLine{1356                           \textcolor{keyword}{private} \mbox{\hyperlink{struct_media_recorder_on_error_listener_1_1_owner}{MediaRecorderOnErrorListener::Owner}}}
\DoxyCodeLine{1357     \{}
\DoxyCodeLine{1358     \textcolor{keyword}{public}:}
\DoxyCodeLine{1359         MediaRecorder (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& outputFilePath, \textcolor{keywordtype}{int} videoWidth, \textcolor{keywordtype}{int} videoHeight,}
\DoxyCodeLine{1360                        \textcolor{keywordtype}{int} sensorOrientation, \textcolor{keywordtype}{int} cameraLensFacing)}
\DoxyCodeLine{1361             : onInfoListener (*this),}
\DoxyCodeLine{1362               onErrorListener (*this),}
\DoxyCodeLine{1363               mediaRecorder (LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewObject (AndroidMediaRecorder,}
\DoxyCodeLine{1364                                                                      AndroidMediaRecorder.constructor)))}
\DoxyCodeLine{1365         \{}
\DoxyCodeLine{1366             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1367 }
\DoxyCodeLine{1368             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setOnInfoListener,}
\DoxyCodeLine{1369                                  \mbox{\hyperlink{namespacejuce_aa5d43f5b68766ba8c811e4e17df96a3e}{CreateJavaInterface}} (\&onInfoListener,}
\DoxyCodeLine{1370                                                       \textcolor{stringliteral}{"{}android/media/MediaRecorder\$OnInfoListener"{}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}());}
\DoxyCodeLine{1371 }
\DoxyCodeLine{1372             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setOnErrorListener,}
\DoxyCodeLine{1373                                  \mbox{\hyperlink{namespacejuce_aa5d43f5b68766ba8c811e4e17df96a3e}{CreateJavaInterface}} (\&onErrorListener,}
\DoxyCodeLine{1374                                                       \textcolor{stringliteral}{"{}android/media/MediaRecorder\$OnErrorListener"{}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}());}
\DoxyCodeLine{1375 }
\DoxyCodeLine{1376             \textcolor{comment}{// NB: the order of function calls here is enforced, and exceptions will be thrown if}}
\DoxyCodeLine{1377             \textcolor{comment}{//     the order is changed.}}
\DoxyCodeLine{1378             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} audioSourceMic = 1;}
\DoxyCodeLine{1379             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setAudioSource, (jint) audioSourceMic);}
\DoxyCodeLine{1380 }
\DoxyCodeLine{1381             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} videoSourceSurface = 2;}
\DoxyCodeLine{1382             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setVideoSource, (jint) videoSourceSurface);}
\DoxyCodeLine{1383 }
\DoxyCodeLine{1384             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} outputFormatMPEG4 = 2;}
\DoxyCodeLine{1385             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setOutputFormat, (jint) outputFormatMPEG4);}
\DoxyCodeLine{1386 }
\DoxyCodeLine{1387             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} audioEncoderAAC = 3;}
\DoxyCodeLine{1388             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setAudioEncoder, (jint) audioEncoderAAC);}
\DoxyCodeLine{1389 }
\DoxyCodeLine{1390             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} videoEncoderH264 = 2;}
\DoxyCodeLine{1391             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setVideoEncoder, (jint) videoEncoderH264);}
\DoxyCodeLine{1392 }
\DoxyCodeLine{1393             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setVideoEncodingBitRate, (jint) 10000000);}
\DoxyCodeLine{1394             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setVideoFrameRate, (jint) 30);}
\DoxyCodeLine{1395 }
\DoxyCodeLine{1396             \textcolor{keyword}{auto} frontFacing = cameraLensFacing == 0;}
\DoxyCodeLine{1397 }
\DoxyCodeLine{1398             \textcolor{keyword}{auto} useInverseDegrees = frontFacing \&\& sensorOrientation == 90;}
\DoxyCodeLine{1399 }
\DoxyCodeLine{1400             \textcolor{keywordtype}{int} orientationHint = getOrientationHint (useInverseDegrees, sensorOrientation);}
\DoxyCodeLine{1401             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setOrientationHint, (jint) orientationHint);}
\DoxyCodeLine{1402 }
\DoxyCodeLine{1403             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setVideoSize, (jint) videoWidth, (jint) videoHeight);}
\DoxyCodeLine{1404             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.setOutputFile, javaString (outputFilePath).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}());}
\DoxyCodeLine{1405             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.prepare);}
\DoxyCodeLine{1406         \}}
\DoxyCodeLine{1407 }
\DoxyCodeLine{1408         \string~MediaRecorder()\textcolor{keyword}{ override}}
\DoxyCodeLine{1409 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1410             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.release);}
\DoxyCodeLine{1411         \}}
\DoxyCodeLine{1412 }
\DoxyCodeLine{1413         LocalRef<jobject> getSurface()}
\DoxyCodeLine{1414         \{}
\DoxyCodeLine{1415             \textcolor{keywordflow}{return} LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallObjectMethod (mediaRecorder, AndroidMediaRecorder.getSurface));}
\DoxyCodeLine{1416         \}}
\DoxyCodeLine{1417 }
\DoxyCodeLine{1418         \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacegl_adad3a3824fbe72fb0b01074bb01ebe75}{start}}()}
\DoxyCodeLine{1419         \{}
\DoxyCodeLine{1420             lockScreenOrientation();}
\DoxyCodeLine{1421 }
\DoxyCodeLine{1422             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.start);}
\DoxyCodeLine{1423 }
\DoxyCodeLine{1424             hasStartedRecording = \textcolor{keyword}{true};}
\DoxyCodeLine{1425         \}}
\DoxyCodeLine{1426 }
\DoxyCodeLine{1427         \textcolor{keywordtype}{void} stop()}
\DoxyCodeLine{1428         \{}
\DoxyCodeLine{1429             \textcolor{comment}{// A request to stop can be sent before recording has had a chance to start, so}}
\DoxyCodeLine{1430             \textcolor{comment}{// ignore the request rather than calling AndroidMediaRecorder.stop because}}
\DoxyCodeLine{1431             \textcolor{comment}{// otherwise MediaRecorder will throw an exception and...}}
\DoxyCodeLine{1432             \textcolor{keywordflow}{if} (! hasStartedRecording)}
\DoxyCodeLine{1433                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{1434 }
\DoxyCodeLine{1435             hasStartedRecording = \textcolor{keyword}{false};}
\DoxyCodeLine{1436 }
\DoxyCodeLine{1437             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1438             env-\/>CallVoidMethod (mediaRecorder, AndroidMediaRecorder.stop);}
\DoxyCodeLine{1439 }
\DoxyCodeLine{1440             \textcolor{comment}{// ... ignore RuntimeException that can be thrown if stop() was called after recording}}
\DoxyCodeLine{1441             \textcolor{comment}{// has started but before any frame was written to a file. This is not an error.}}
\DoxyCodeLine{1442             jniCheckHasExceptionOccurredAndClear();}
\DoxyCodeLine{1443 }
\DoxyCodeLine{1444             unlockScreenOrientation();}
\DoxyCodeLine{1445         \}}
\DoxyCodeLine{1446 }
\DoxyCodeLine{1447     \textcolor{keyword}{private}:}
\DoxyCodeLine{1448         \mbox{\hyperlink{class_media_recorder_on_info_listener}{MediaRecorderOnInfoListener}} onInfoListener;}
\DoxyCodeLine{1449         \mbox{\hyperlink{class_media_recorder_on_error_listener}{MediaRecorderOnErrorListener}} onErrorListener;}
\DoxyCodeLine{1450         GlobalRef mediaRecorder;}
\DoxyCodeLine{1451         \textcolor{keywordtype}{bool} hasStartedRecording = \textcolor{keyword}{false};}
\DoxyCodeLine{1452         \textcolor{keywordtype}{int} orientationsEnabled = -\/1;}
\DoxyCodeLine{1453 }
\DoxyCodeLine{1454         \textcolor{keywordtype}{void} lockScreenOrientation()}
\DoxyCodeLine{1455         \{}
\DoxyCodeLine{1456             orientationsEnabled = \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_ac18d391af21fd546fc059c77014a4c9b}{getOrientationsEnabled}}();}
\DoxyCodeLine{1457 }
\DoxyCodeLine{1458             \textcolor{keyword}{auto} o = \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_a02ae21e312faf1715e8311f1f53e5e00}{getCurrentOrientation}}();}
\DoxyCodeLine{1459             \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_a4c4e91683ca8ffef6724650b90b17293}{setOrientationsEnabled}} (o);}
\DoxyCodeLine{1460         \}}
\DoxyCodeLine{1461 }
\DoxyCodeLine{1462         \textcolor{keyword}{static} jint juceOrientationToNativeOrientation (\textcolor{keywordtype}{int} orientations) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{1463         \{}
\DoxyCodeLine{1464             \textcolor{keyword}{enum}}
\DoxyCodeLine{1465             \{}
\DoxyCodeLine{1466                 SCREEN\_ORIENTATION\_LANDSCAPE          = 0,}
\DoxyCodeLine{1467                 SCREEN\_ORIENTATION\_PORTRAIT           = 1,}
\DoxyCodeLine{1468                 SCREEN\_ORIENTATION\_USER               = 2,}
\DoxyCodeLine{1469                 SCREEN\_ORIENTATION\_REVERSE\_LANDSCAPE  = 8,}
\DoxyCodeLine{1470                 SCREEN\_ORIENTATION\_REVERSE\_PORTRAIT   = 9,}
\DoxyCodeLine{1471                 SCREEN\_ORIENTATION\_USER\_LANDSCAPE     = 11,}
\DoxyCodeLine{1472                 SCREEN\_ORIENTATION\_USER\_PORTRAIT      = 12,}
\DoxyCodeLine{1473             \};}
\DoxyCodeLine{1474 }
\DoxyCodeLine{1475             \textcolor{keywordflow}{switch} (orientations)}
\DoxyCodeLine{1476             \{}
\DoxyCodeLine{1477                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aaced7253546b0f2e73e4dd08bcb60c9f8}{Desktop::upright}}:                                          \textcolor{keywordflow}{return} (jint) SCREEN\_ORIENTATION\_PORTRAIT;}
\DoxyCodeLine{1478                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aa5820a6ffe2f7f012a16a1bd57e304b91}{Desktop::upsideDown}}:                                       \textcolor{keywordflow}{return} (jint) SCREEN\_ORIENTATION\_REVERSE\_PORTRAIT;}
\DoxyCodeLine{1479                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aaced7253546b0f2e73e4dd08bcb60c9f8}{Desktop::upright}} + \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aa5820a6ffe2f7f012a16a1bd57e304b91}{Desktop::upsideDown}}:                    \textcolor{keywordflow}{return} (jint) SCREEN\_ORIENTATION\_USER\_PORTRAIT;}
\DoxyCodeLine{1480                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aab48176789b5764aae6aae6a393916712}{Desktop::rotatedAntiClockwise}}:                             \textcolor{keywordflow}{return} (jint) SCREEN\_ORIENTATION\_LANDSCAPE;}
\DoxyCodeLine{1481                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aae1e0629de1668ef16f700b7278fd0f04}{Desktop::rotatedClockwise}}:                                 \textcolor{keywordflow}{return} (jint) SCREEN\_ORIENTATION\_REVERSE\_LANDSCAPE;}
\DoxyCodeLine{1482                 \textcolor{keywordflow}{case} \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aae1e0629de1668ef16f700b7278fd0f04}{Desktop::rotatedClockwise}} + \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aab48176789b5764aae6aae6a393916712}{Desktop::rotatedAntiClockwise}}: \textcolor{keywordflow}{return} (jint) SCREEN\_ORIENTATION\_USER\_LANDSCAPE;}
\DoxyCodeLine{1483                 \textcolor{keywordflow}{default}:                                                        \textcolor{keywordflow}{return} (jint) SCREEN\_ORIENTATION\_USER;}
\DoxyCodeLine{1484             \}}
\DoxyCodeLine{1485         \}}
\DoxyCodeLine{1486 }
\DoxyCodeLine{1487         \textcolor{keywordtype}{void} unlockScreenOrientation()}
\DoxyCodeLine{1488         \{}
\DoxyCodeLine{1489             \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_a4c4e91683ca8ffef6724650b90b17293}{setOrientationsEnabled}} (orientationsEnabled);}
\DoxyCodeLine{1490         \}}
\DoxyCodeLine{1491 }
\DoxyCodeLine{1492         \textcolor{keywordtype}{void} onInfo (LocalRef<jobject>\& recorder, \textcolor{keywordtype}{int} what, \textcolor{keywordtype}{int} extra)\textcolor{keyword}{ override}}
\DoxyCodeLine{1493 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1494             \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (recorder, what, extra);}
\DoxyCodeLine{1495 }
\DoxyCodeLine{1496             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}MediaRecorder::OnInfo: "{}} + getInfoStringFromCode (what)}
\DoxyCodeLine{1497                                      + \textcolor{stringliteral}{"{}, extra code = "{}} + \mbox{\hyperlink{class_string}{String}} (extra));}
\DoxyCodeLine{1498         \}}
\DoxyCodeLine{1499 }
\DoxyCodeLine{1500         \textcolor{keywordtype}{void} onError (LocalRef<jobject>\& recorder, \textcolor{keywordtype}{int} what, \textcolor{keywordtype}{int} extra)\textcolor{keyword}{ override}}
\DoxyCodeLine{1501 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1502             \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (recorder, what, extra);}
\DoxyCodeLine{1503 }
\DoxyCodeLine{1504             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}MediaRecorder::onError: "{}} + getErrorStringFromCode (what)}
\DoxyCodeLine{1505                                      + \textcolor{stringliteral}{"{}, extra code = "{}} + \mbox{\hyperlink{class_string}{String}} (extra));}
\DoxyCodeLine{1506         \}}
\DoxyCodeLine{1507 }
\DoxyCodeLine{1508         \textcolor{keyword}{static} \mbox{\hyperlink{class_string}{String}} getInfoStringFromCode (\textcolor{keywordtype}{int} what)}
\DoxyCodeLine{1509         \{}
\DoxyCodeLine{1510             \textcolor{keyword}{enum}}
\DoxyCodeLine{1511             \{}
\DoxyCodeLine{1512                 MEDIA\_RECORDER\_INFO\_UNKNOWN = 1,}
\DoxyCodeLine{1513                 MEDIA\_RECORDER\_INFO\_MAX\_DURATION\_REACHED = 800,}
\DoxyCodeLine{1514                 MEDIA\_RECORDER\_INFO\_MAX\_FILESIZE\_REACHED = 801,}
\DoxyCodeLine{1515                 MEDIA\_RECORDER\_INFO\_MAX\_FILESIZE\_APPROACHING = 802,}
\DoxyCodeLine{1516                 MEDIA\_RECORDER\_INFO\_NEXT\_OUTPUT\_FILE\_STARTED = 803}
\DoxyCodeLine{1517             \};}
\DoxyCodeLine{1518 }
\DoxyCodeLine{1519             \textcolor{keywordflow}{switch} (what)}
\DoxyCodeLine{1520             \{}
\DoxyCodeLine{1521                 \textcolor{keywordflow}{case} MEDIA\_RECORDER\_INFO\_UNKNOWN:                  \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"{}Unknown info"{}} \};}
\DoxyCodeLine{1522                 \textcolor{keywordflow}{case} MEDIA\_RECORDER\_INFO\_MAX\_DURATION\_REACHED:     \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"{}Max duration reached"{}} \};}
\DoxyCodeLine{1523                 \textcolor{keywordflow}{case} MEDIA\_RECORDER\_INFO\_MAX\_FILESIZE\_REACHED:     \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"{}Max filesize reached"{}} \};}
\DoxyCodeLine{1524                 \textcolor{keywordflow}{case} MEDIA\_RECORDER\_INFO\_MAX\_FILESIZE\_APPROACHING: \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"{}Max filesize approaching"{}} \};}
\DoxyCodeLine{1525                 \textcolor{keywordflow}{case} MEDIA\_RECORDER\_INFO\_NEXT\_OUTPUT\_FILE\_STARTED: \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"{}Next output file started"{}} \};}
\DoxyCodeLine{1526                 \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} \mbox{\hyperlink{class_string}{String}} (what);}
\DoxyCodeLine{1527             \};}
\DoxyCodeLine{1528         \}}
\DoxyCodeLine{1529 }
\DoxyCodeLine{1530         \textcolor{keyword}{static} \mbox{\hyperlink{class_string}{String}} getErrorStringFromCode (\textcolor{keywordtype}{int} what)}
\DoxyCodeLine{1531         \{}
\DoxyCodeLine{1532             \textcolor{keyword}{enum}}
\DoxyCodeLine{1533             \{}
\DoxyCodeLine{1534                 MEDIA\_RECORDER\_ERROR\_UNKNOWN = 1,}
\DoxyCodeLine{1535                 MEDIA\_ERROR\_SERVER\_DIED = 100}
\DoxyCodeLine{1536             \};}
\DoxyCodeLine{1537 }
\DoxyCodeLine{1538             \textcolor{keywordflow}{switch} (what)}
\DoxyCodeLine{1539             \{}
\DoxyCodeLine{1540                 \textcolor{keywordflow}{case} MEDIA\_RECORDER\_ERROR\_UNKNOWN:   \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"{}Unknown error"{}} \};}
\DoxyCodeLine{1541                 \textcolor{keywordflow}{case} MEDIA\_ERROR\_SERVER\_DIED:        \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"{}Server died"{}} \};}
\DoxyCodeLine{1542                 \textcolor{keywordflow}{default}: \textcolor{keywordflow}{return} \mbox{\hyperlink{class_string}{String}} (what);}
\DoxyCodeLine{1543             \};}
\DoxyCodeLine{1544         \}}
\DoxyCodeLine{1545 }
\DoxyCodeLine{1546         \textcolor{keyword}{static} \textcolor{keywordtype}{int} getOrientationHint (\textcolor{keywordtype}{bool} useInverseDegrees, \textcolor{keywordtype}{int} cameraSensorOrientation)}
\DoxyCodeLine{1547         \{}
\DoxyCodeLine{1548             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1549 }
\DoxyCodeLine{1550             \textcolor{keyword}{auto} windowManager = LocalRef<jobject> (env-\/>CallObjectMethod (\mbox{\hyperlink{namespacejuce_ae270c2dd4b358c3482f8950a283a36af}{getAppContext}}(), AndroidContext.getSystemService, javaString (\textcolor{stringliteral}{"{}window"{}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}()));}
\DoxyCodeLine{1551             \textcolor{keyword}{auto} display = LocalRef<jobject> (env-\/>CallObjectMethod (windowManager, AndroidWindowManager.getDefaultDisplay));}
\DoxyCodeLine{1552             \textcolor{keyword}{auto} rotation = env-\/>CallIntMethod (display, AndroidDisplay.getRotation);}
\DoxyCodeLine{1553 }
\DoxyCodeLine{1554             \textcolor{keyword}{enum}}
\DoxyCodeLine{1555             \{}
\DoxyCodeLine{1556                 ROTATION\_0 = 0,}
\DoxyCodeLine{1557                 ROTATION\_90,}
\DoxyCodeLine{1558                 ROTATION\_180,}
\DoxyCodeLine{1559                 ROTATION\_270}
\DoxyCodeLine{1560             \};}
\DoxyCodeLine{1561 }
\DoxyCodeLine{1562             \textcolor{keywordtype}{int} hint = 0;}
\DoxyCodeLine{1563 }
\DoxyCodeLine{1564             \textcolor{keywordflow}{switch} (rotation)}
\DoxyCodeLine{1565             \{}
\DoxyCodeLine{1566                 \textcolor{keywordflow}{case} ROTATION\_0:   hint = cameraSensorOrientation;       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1567                 \textcolor{keywordflow}{case} ROTATION\_90:  hint = useInverseDegrees ? 180 : 0;   \textcolor{keywordflow}{break};}
\DoxyCodeLine{1568                 \textcolor{keywordflow}{case} ROTATION\_180: hint = cameraSensorOrientation + 180; \textcolor{keywordflow}{break};}
\DoxyCodeLine{1569                 \textcolor{keywordflow}{case} ROTATION\_270: hint = useInverseDegrees ? 0 : 180;   \textcolor{keywordflow}{break};}
\DoxyCodeLine{1570                 \textcolor{keywordflow}{default}: \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{1571             \}}
\DoxyCodeLine{1572 }
\DoxyCodeLine{1573             \textcolor{keywordflow}{return} (hint + 360) \% 360;}
\DoxyCodeLine{1574         \}}
\DoxyCodeLine{1575     \};}
\DoxyCodeLine{1576 }
\DoxyCodeLine{1577     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1578     \textcolor{keyword}{class }ScopedCameraDevice}
\DoxyCodeLine{1579     \{}
\DoxyCodeLine{1580     \textcolor{keyword}{public}:}
\DoxyCodeLine{1581         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1582         \textcolor{keyword}{class }\mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session}{CaptureSession}}}
\DoxyCodeLine{1583         \{}
\DoxyCodeLine{1584         \textcolor{keyword}{public}:}
\DoxyCodeLine{1585             \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_1_1_configured_callback}{ConfiguredCallback}}}
\DoxyCodeLine{1586             \{}
\DoxyCodeLine{1587                 \textcolor{keyword}{virtual} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_1_1_configured_callback_a6e24ce073f0255ca6653ea6c5ece5508}{\string~ConfiguredCallback}}() \{\}}
\DoxyCodeLine{1588 }
\DoxyCodeLine{1589                 \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_1_1_configured_callback_a76846511a6e771f55fe7c923b7ce2dc5}{captureSessionConfigured}} (\mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session}{CaptureSession}}*) = 0;}
\DoxyCodeLine{1590             \};}
\DoxyCodeLine{1591 }
\DoxyCodeLine{1592             \mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_a83e0d2b9a891244491c1b2d44306bd7a}{\string~CaptureSession}}()}
\DoxyCodeLine{1593             \{}
\DoxyCodeLine{1594                 \textcolor{keywordtype}{bool} calledClose = \textcolor{keyword}{false};}
\DoxyCodeLine{1595 }
\DoxyCodeLine{1596                 \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1597 }
\DoxyCodeLine{1598                 \{}
\DoxyCodeLine{1599                     \textcolor{keyword}{const} \mbox{\hyperlink{class_generic_scoped_lock}{ScopedLock}} lock (captureSessionLock);}
\DoxyCodeLine{1600 }
\DoxyCodeLine{1601                     \textcolor{keywordflow}{if} (captureSession.get() != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1602                     \{}
\DoxyCodeLine{1603                         calledClose = \textcolor{keyword}{true};}
\DoxyCodeLine{1604 }
\DoxyCodeLine{1605                         env-\/>CallVoidMethod (captureSession, CameraCaptureSession.close);}
\DoxyCodeLine{1606                     \}}
\DoxyCodeLine{1607                 \}}
\DoxyCodeLine{1608 }
\DoxyCodeLine{1609                 \textcolor{comment}{// When exception occurs, CameraCaptureSession.close will never finish, so}}
\DoxyCodeLine{1610                 \textcolor{comment}{// we should not wait for it. For fatal error an exception does occur, but}}
\DoxyCodeLine{1611                 \textcolor{comment}{// it is caught internally in Java...}}
\DoxyCodeLine{1612                 \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear() || scopedCameraDevice.fatalErrorOccurred.get())}
\DoxyCodeLine{1613                 \{}
\DoxyCodeLine{1614                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Exception or fatal error occurred while closing Capture Session, closing by force"{}});}
\DoxyCodeLine{1615                 \}}
\DoxyCodeLine{1616                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (calledClose)}
\DoxyCodeLine{1617                 \{}
\DoxyCodeLine{1618                     pendingClose.set (1);}
\DoxyCodeLine{1619                     closedEvent.\mbox{\hyperlink{class_waitable_event_a1e5eb0e88e9e88aa34b58395d2bff1e0}{wait}} (-\/1);}
\DoxyCodeLine{1620                 \}}
\DoxyCodeLine{1621             \}}
\DoxyCodeLine{1622 }
\DoxyCodeLine{1623             \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_a441ba76b198d56530ef853298dbe75fc}{openedOk}}() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} captureSession != \textcolor{keyword}{nullptr}; \}}
\DoxyCodeLine{1624 }
\DoxyCodeLine{1625             \textcolor{keyword}{const} GlobalRef\& \mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_a99f35460fd8eac5f30456436bad09e23}{getNativeSession}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} captureSession; \}}
\DoxyCodeLine{1626 }
\DoxyCodeLine{1627             \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_ac0f5414a74c211df5a113d51a1afa574}{start}} (\textcolor{keyword}{const} LocalRef<jobject>\& targetSurfacesList, GlobalRef\& handlerToUse)}
\DoxyCodeLine{1628             \{}
\DoxyCodeLine{1629                 \textcolor{keywordflow}{if} (! \mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_a441ba76b198d56530ef853298dbe75fc}{openedOk}}())}
\DoxyCodeLine{1630                 \{}
\DoxyCodeLine{1631                     \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{1632                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{1633                 \}}
\DoxyCodeLine{1634 }
\DoxyCodeLine{1635                 \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1636 }
\DoxyCodeLine{1637                 \textcolor{keyword}{auto} numSurfaces = env-\/>CallIntMethod (targetSurfacesList, JavaArrayList.size);}
\DoxyCodeLine{1638 }
\DoxyCodeLine{1639                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < numSurfaces; ++i)}
\DoxyCodeLine{1640                 \{}
\DoxyCodeLine{1641                     \textcolor{keyword}{auto} surface = LocalRef<jobject> (env-\/>CallObjectMethod (targetSurfacesList, JavaArrayList.get, (jint) i));}
\DoxyCodeLine{1642                     env-\/>CallVoidMethod (captureRequestBuilder, CaptureRequestBuilder.addTarget, surface.get());}
\DoxyCodeLine{1643                 \}}
\DoxyCodeLine{1644 }
\DoxyCodeLine{1645                 previewCaptureRequest = GlobalRef (LocalRef<jobject>(env-\/>CallObjectMethod (captureRequestBuilder, CaptureRequestBuilder.build)));}
\DoxyCodeLine{1646 }
\DoxyCodeLine{1647                 env-\/>CallIntMethod (captureSession, CameraCaptureSession.setRepeatingRequest,}
\DoxyCodeLine{1648                                     previewCaptureRequest.get(), \textcolor{keyword}{nullptr}, handlerToUse.get());}
\DoxyCodeLine{1649 }
\DoxyCodeLine{1650                 \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{1651             \}}
\DoxyCodeLine{1652 }
\DoxyCodeLine{1653             \textcolor{keywordtype}{void} \mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_a3e91937c1c88243c7961abc59e87c44f}{takeStillPicture}} (jobject targetSurface)}
\DoxyCodeLine{1654             \{}
\DoxyCodeLine{1655                 \textcolor{keywordflow}{if} (stillPictureTaker == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1656                 \{}
\DoxyCodeLine{1657                     \textcolor{comment}{// Can only take picture once session was successfully configured!}}
\DoxyCodeLine{1658                     \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{1659                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{1660                 \}}
\DoxyCodeLine{1661 }
\DoxyCodeLine{1662                 \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1663 }
\DoxyCodeLine{1664                 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} templateStillCapture = 2;}
\DoxyCodeLine{1665                 \textcolor{keyword}{auto} builder = LocalRef<jobject> (env-\/>CallObjectMethod (scopedCameraDevice.cameraDevice,}
\DoxyCodeLine{1666                                                                          AndroidCameraDevice.createCaptureRequest,}
\DoxyCodeLine{1667                                                                          (jint) templateStillCapture));}
\DoxyCodeLine{1668 }
\DoxyCodeLine{1669                 env-\/>CallVoidMethod (builder, CaptureRequestBuilder.addTarget, targetSurface);}
\DoxyCodeLine{1670 }
\DoxyCodeLine{1671                 setCaptureRequestBuilderIntegerKey (builder, CaptureRequest.CONTROL\_AF\_MODE, autoFocusMode);}
\DoxyCodeLine{1672 }
\DoxyCodeLine{1673                 \textcolor{keyword}{auto} stillPictureCaptureRequest = LocalRef<jobject> (env-\/>CallObjectMethod (builder, CaptureRequestBuilder.build));}
\DoxyCodeLine{1674 }
\DoxyCodeLine{1675                 stillPictureTaker-\/>takePicture (stillPictureCaptureRequest);}
\DoxyCodeLine{1676             \}}
\DoxyCodeLine{1677 }
\DoxyCodeLine{1678         \textcolor{keyword}{private}:}
\DoxyCodeLine{1679             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1680             \textcolor{keyword}{class }StillPictureTaker   : \textcolor{keyword}{private} \mbox{\hyperlink{struct_android_runnable_1_1_owner}{AndroidRunnable::Owner}}}
\DoxyCodeLine{1681             \{}
\DoxyCodeLine{1682             \textcolor{keyword}{public}:}
\DoxyCodeLine{1683                 StillPictureTaker (GlobalRef\& captureSessionToUse, GlobalRef\& captureRequestBuilderToUse,}
\DoxyCodeLine{1684                                    GlobalRef\& previewCaptureRequestToUse, GlobalRef\& handlerToUse,}
\DoxyCodeLine{1685                                    \textcolor{keywordtype}{int} autoFocusModeToUse)}
\DoxyCodeLine{1686                     : captureSession (captureSessionToUse),}
\DoxyCodeLine{1687                       captureRequestBuilder (captureRequestBuilderToUse),}
\DoxyCodeLine{1688                       previewCaptureRequest (previewCaptureRequestToUse),}
\DoxyCodeLine{1689                       handler (handlerToUse),}
\DoxyCodeLine{1690                       runnable (*this),}
\DoxyCodeLine{1691                       captureSessionPreviewCaptureCallback (createCaptureSessionCallback (\mbox{\hyperlink{ordinals_8h_a41f9c5fb8b08eb5dc3edce4dcb37fee7}{true}})),}
\DoxyCodeLine{1692                       captureSessionStillPictureCaptureCallback (createCaptureSessionCallback (\mbox{\hyperlink{ordinals_8h_a65e9886d74aaee76545e83dd09011727}{false}})),}
\DoxyCodeLine{1693                       autoFocusMode (autoFocusModeToUse)}
\DoxyCodeLine{1694                 \{}
\DoxyCodeLine{1695                 \}}
\DoxyCodeLine{1696 }
\DoxyCodeLine{1697                 \textcolor{keywordtype}{void} takePicture (\textcolor{keyword}{const} LocalRef<jobject>\& stillPictureCaptureRequestToUse)}
\DoxyCodeLine{1698                 \{}
\DoxyCodeLine{1699                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Taking picture..."{}});}
\DoxyCodeLine{1700 }
\DoxyCodeLine{1701                     stillPictureCaptureRequest = GlobalRef (LocalRef<jobject>(stillPictureCaptureRequestToUse));}
\DoxyCodeLine{1702 }
\DoxyCodeLine{1703                     lockFocus();}
\DoxyCodeLine{1704                 \}}
\DoxyCodeLine{1705 }
\DoxyCodeLine{1706             \textcolor{keyword}{private}:}
\DoxyCodeLine{1707                 GlobalRef\& captureSession;}
\DoxyCodeLine{1708                 GlobalRef\& captureRequestBuilder;}
\DoxyCodeLine{1709                 GlobalRef\& previewCaptureRequest;}
\DoxyCodeLine{1710                 GlobalRef\& handler;}
\DoxyCodeLine{1711 }
\DoxyCodeLine{1712                 \mbox{\hyperlink{class_android_runnable}{AndroidRunnable}} runnable;}
\DoxyCodeLine{1713                 GlobalRef delayedCaptureRunnable;}
\DoxyCodeLine{1714 }
\DoxyCodeLine{1715                 GlobalRef captureSessionPreviewCaptureCallback;}
\DoxyCodeLine{1716 }
\DoxyCodeLine{1717                 GlobalRef stillPictureCaptureRequest;}
\DoxyCodeLine{1718                 GlobalRef captureSessionStillPictureCaptureCallback;}
\DoxyCodeLine{1719 }
\DoxyCodeLine{1720                 \textcolor{keywordtype}{int} autoFocusMode;}
\DoxyCodeLine{1721 }
\DoxyCodeLine{1722                 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1723 \textcolor{preprocessor}{                \#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{1724 \textcolor{preprocessor}{                   METHOD (constructor, "{}<init>"{}}, "{}(JZ)V"{})              \(\backslash\)}
\DoxyCodeLine{1725                    CALLBACK (cameraCaptureSessionCaptureCompletedCallback,         "{}cameraCaptureSessionCaptureCompleted"{},         "{}(JZLandroid/hardware/camera2/CameraCaptureSession;Landroid/hardware/camera2/CaptureRequest;Landroid/hardware/camera2/TotalCaptureResult;)V"{}) \(\backslash\)}
\DoxyCodeLine{1726                    CALLBACK (cameraCaptureSessionCaptureFailedCallback,            "{}cameraCaptureSessionCaptureFailed"{},            "{}(JZLandroid/hardware/camera2/CameraCaptureSession;Landroid/hardware/camera2/CaptureRequest;Landroid/hardware/camera2/CaptureFailure;)V"{}) \(\backslash\)}
\DoxyCodeLine{1727                    CALLBACK (cameraCaptureSessionCaptureProgressedCallback,        "{}cameraCaptureSessionCaptureProgressed"{},        "{}(JZLandroid/hardware/camera2/CameraCaptureSession;Landroid/hardware/camera2/CaptureRequest;Landroid/hardware/camera2/CaptureResult;)V"{}) \(\backslash\)}
\DoxyCodeLine{1728                    CALLBACK (cameraCaptureSessionCaptureStartedCallback,           "{}cameraCaptureSessionCaptureStarted"{},           "{}(JZLandroid/hardware/camera2/CameraCaptureSession;Landroid/hardware/camera2/CaptureRequest;JJ)V"{}) \(\backslash\)}
\DoxyCodeLine{1729                    CALLBACK (cameraCaptureSessionCaptureSequenceAbortedCallback,   "{}cameraCaptureSessionCaptureSequenceAborted"{},   "{}(JZLandroid/hardware/camera2/CameraCaptureSession;I)V"{}) \(\backslash\)}
\DoxyCodeLine{1730                    CALLBACK (cameraCaptureSessionCaptureSequenceCompletedCallback, "{}cameraCaptureSessionCaptureSequenceCompleted"{}, "{}(JZLandroid/hardware/camera2/CameraCaptureSession;IJ)V"{})}
\DoxyCodeLine{1731 }
\DoxyCodeLine{1732                 \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aa0b57cbc1250c62976546282ab97d5a7}{DECLARE\_JNI\_CLASS\_WITH\_BYTECODE}} (CameraCaptureSessionCaptureCallback, \textcolor{stringliteral}{"{}com/rmsl/juce/CameraCaptureSessionCaptureCallback"{}}, 21, CameraSupportByteCode, \textcolor{keyword}{sizeof}(CameraSupportByteCode))}
\DoxyCodeLine{1733                 \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{1734 }
\DoxyCodeLine{1735                 LocalRef<jobject> createCaptureSessionCallback (\textcolor{keywordtype}{bool} createPreviewSession)}
\DoxyCodeLine{1736                 \{}
\DoxyCodeLine{1737                     \textcolor{keywordflow}{return} LocalRef<jobject>(\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewObject (CameraCaptureSessionCaptureCallback,}
\DoxyCodeLine{1738                                                                   CameraCaptureSessionCaptureCallback.constructor,}
\DoxyCodeLine{1739                                                                   \textcolor{keyword}{reinterpret\_cast<}jlong\textcolor{keyword}{>} (\textcolor{keyword}{this}),}
\DoxyCodeLine{1740                                                                   createPreviewSession ? 1 : 0));}
\DoxyCodeLine{1741                 \}}
\DoxyCodeLine{1742 }
\DoxyCodeLine{1743                 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1744 }
\DoxyCodeLine{1745                 \textcolor{keyword}{enum class} State}
\DoxyCodeLine{1746                 \{}
\DoxyCodeLine{1747                     idle = 0,}
\DoxyCodeLine{1748                     pendingFocusLock,}
\DoxyCodeLine{1749                     pendingExposurePrecapture,}
\DoxyCodeLine{1750                     pendingExposurePostPrecapture,}
\DoxyCodeLine{1751                     pictureTaken}
\DoxyCodeLine{1752                 \};}
\DoxyCodeLine{1753 }
\DoxyCodeLine{1754                 State currentState = State::idle;}
\DoxyCodeLine{1755 }
\DoxyCodeLine{1756                 \textcolor{keywordtype}{void} lockFocus()}
\DoxyCodeLine{1757                 \{}
\DoxyCodeLine{1758                     \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{1759                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1760 }
\DoxyCodeLine{1761                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Performing auto-\/focus if possible..."{}});}
\DoxyCodeLine{1762 }
\DoxyCodeLine{1763                     currentState = State::pendingFocusLock;}
\DoxyCodeLine{1764 }
\DoxyCodeLine{1765                     \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1766 }
\DoxyCodeLine{1767                     \textcolor{comment}{// NB: auto-\/focus may be unavailable on a device, in which case it may have already}}
\DoxyCodeLine{1768                     \textcolor{comment}{// automatically adjusted the exposure. We check for that in updateState().}}
\DoxyCodeLine{1769                     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAfTriggerStart = 1;}
\DoxyCodeLine{1770                     CaptureSession::setCaptureRequestBuilderIntegerKey (captureRequestBuilder.get(),}
\DoxyCodeLine{1771                                                                         CaptureRequest.CONTROL\_AF\_TRIGGER,}
\DoxyCodeLine{1772                                                                         controlAfTriggerStart);}
\DoxyCodeLine{1773 }
\DoxyCodeLine{1774                     \textcolor{keyword}{auto} previewRequest = LocalRef<jobject> (env-\/>CallObjectMethod (captureRequestBuilder,}
\DoxyCodeLine{1775                                                                                     CaptureRequestBuilder.build));}
\DoxyCodeLine{1776 }
\DoxyCodeLine{1777                     env-\/>CallIntMethod (captureSession, CameraCaptureSession.capture, previewRequest.get(),}
\DoxyCodeLine{1778                                         captureSessionPreviewCaptureCallback.get(), handler.get());}
\DoxyCodeLine{1779                 \}}
\DoxyCodeLine{1780 }
\DoxyCodeLine{1781                 \textcolor{keywordtype}{void} updateState (jobject captureResult)}
\DoxyCodeLine{1782                 \{}
\DoxyCodeLine{1783                     \textcolor{comment}{// IllegalStateException can be thrown when accessing CaptureSession,}}
\DoxyCodeLine{1784                     \textcolor{comment}{// claiming that capture session was already closed but we may not}}
\DoxyCodeLine{1785                     \textcolor{comment}{// get relevant callback yet, so check for this and bailout when needed.}}
\DoxyCodeLine{1786                     \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{1787                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1788 }
\DoxyCodeLine{1789                     \textcolor{keywordflow}{switch} (currentState)}
\DoxyCodeLine{1790                     \{}
\DoxyCodeLine{1791                         \textcolor{keywordflow}{case} State::pendingFocusLock:}
\DoxyCodeLine{1792                         \{}
\DoxyCodeLine{1793                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still picture capture, updateState(), State::pendingFocusLock..."{}});}
\DoxyCodeLine{1794 }
\DoxyCodeLine{1795                             \textcolor{keyword}{auto} controlAfStateValue = getCaptureResultIntegerKeyValue (CaptureResult.CONTROL\_AF\_STATE, captureResult);}
\DoxyCodeLine{1796 }
\DoxyCodeLine{1797                             \textcolor{keywordflow}{if} (controlAfStateValue.get() == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1798                             \{}
\DoxyCodeLine{1799                                 captureStillPictureDelayed();}
\DoxyCodeLine{1800                                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{1801                             \}}
\DoxyCodeLine{1802 }
\DoxyCodeLine{1803                             \textcolor{keyword}{auto} autoToFocusNotAvailable = autoFocusMode == 0;}
\DoxyCodeLine{1804 }
\DoxyCodeLine{1805                             \textcolor{keywordflow}{if} (autoToFocusNotAvailable || autoFocusHasFinished (controlAfStateValue))}
\DoxyCodeLine{1806                             \{}
\DoxyCodeLine{1807                                 \textcolor{keyword}{auto} controlAeStateIntValue = getControlAEState (captureResult);}
\DoxyCodeLine{1808                                 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAeStateConverged = 2;}
\DoxyCodeLine{1809 }
\DoxyCodeLine{1810                                 \textcolor{keywordflow}{if} (controlAeStateIntValue == -\/1 || controlAeStateIntValue == controlAeStateConverged)}
\DoxyCodeLine{1811                                 \{}
\DoxyCodeLine{1812                                     currentState = State::pictureTaken;}
\DoxyCodeLine{1813                                     captureStillPictureDelayed();}
\DoxyCodeLine{1814                                 \}}
\DoxyCodeLine{1815                                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{1816                                 \{}
\DoxyCodeLine{1817                                     runPrecaptureSequence();}
\DoxyCodeLine{1818                                 \}}
\DoxyCodeLine{1819                             \}}
\DoxyCodeLine{1820 }
\DoxyCodeLine{1821                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1822                         \}}
\DoxyCodeLine{1823 }
\DoxyCodeLine{1824                         \textcolor{keywordflow}{case} State::pendingExposurePrecapture:}
\DoxyCodeLine{1825                         \{}
\DoxyCodeLine{1826                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still picture capture, updateState(), State::pendingExposurePrecapture..."{}});}
\DoxyCodeLine{1827 }
\DoxyCodeLine{1828                             \textcolor{keyword}{auto} controlAeStateIntValue = getControlAEState (captureResult);}
\DoxyCodeLine{1829                             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAeStateFlashRequired = 4;}
\DoxyCodeLine{1830                             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAeStatePrecapture = 5;}
\DoxyCodeLine{1831 }
\DoxyCodeLine{1832                             \textcolor{keywordflow}{if} (controlAeStateIntValue == -\/1 || controlAeStateIntValue == controlAeStateFlashRequired}
\DoxyCodeLine{1833                                                              || controlAeStateIntValue == controlAeStatePrecapture)}
\DoxyCodeLine{1834                             \{}
\DoxyCodeLine{1835                                 currentState = State::pendingExposurePostPrecapture;}
\DoxyCodeLine{1836                             \}}
\DoxyCodeLine{1837 }
\DoxyCodeLine{1838                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1839                         \}}
\DoxyCodeLine{1840 }
\DoxyCodeLine{1841                         \textcolor{keywordflow}{case} State::pendingExposurePostPrecapture:}
\DoxyCodeLine{1842                         \{}
\DoxyCodeLine{1843                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still picture capture, updateState(), State::pendingExposurePostPrecapture..."{}});}
\DoxyCodeLine{1844 }
\DoxyCodeLine{1845                             \textcolor{keyword}{auto} controlAeStateIntValue = getControlAEState (captureResult);}
\DoxyCodeLine{1846                             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAeStatePrecapture = 5;}
\DoxyCodeLine{1847 }
\DoxyCodeLine{1848                             \textcolor{keywordflow}{if} (controlAeStateIntValue == -\/1 || controlAeStateIntValue != controlAeStatePrecapture)}
\DoxyCodeLine{1849                             \{}
\DoxyCodeLine{1850                                 currentState = State::pictureTaken;}
\DoxyCodeLine{1851                                 captureStillPictureDelayed();}
\DoxyCodeLine{1852                             \}}
\DoxyCodeLine{1853 }
\DoxyCodeLine{1854                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1855                         \}}
\DoxyCodeLine{1856                         \textcolor{keywordflow}{case} State::idle:}
\DoxyCodeLine{1857                         \textcolor{keywordflow}{case} State::pictureTaken:}
\DoxyCodeLine{1858                             \{ \textcolor{comment}{/* do nothing */} \textcolor{keywordflow}{break}; \}}
\DoxyCodeLine{1859                     \};}
\DoxyCodeLine{1860                 \}}
\DoxyCodeLine{1861 }
\DoxyCodeLine{1862                 \textcolor{keyword}{static} \textcolor{keywordtype}{int} getControlAEState (jobject captureResult)}
\DoxyCodeLine{1863                 \{}
\DoxyCodeLine{1864                     \textcolor{keyword}{auto} controlAeStateValue = getCaptureResultIntegerKeyValue (CaptureResult.CONTROL\_AE\_STATE, captureResult);}
\DoxyCodeLine{1865 }
\DoxyCodeLine{1866                     \textcolor{keywordflow}{return} controlAeStateValue.get() != \textcolor{keyword}{nullptr}}
\DoxyCodeLine{1867                                     ? \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallIntMethod (controlAeStateValue, JavaInteger.intValue) : -\/1;}
\DoxyCodeLine{1868                 \}}
\DoxyCodeLine{1869 }
\DoxyCodeLine{1870                 \textcolor{keyword}{static} \textcolor{keywordtype}{bool} autoFocusHasFinished (\textcolor{keyword}{const} LocalRef<jobject>\& controlAfStateValue)}
\DoxyCodeLine{1871                 \{}
\DoxyCodeLine{1872                     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAfStateFocusedLocked = 4;}
\DoxyCodeLine{1873                     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAfStateNotFocusedLocked = 5;}
\DoxyCodeLine{1874 }
\DoxyCodeLine{1875                     \textcolor{keyword}{auto} controlAfStateIntValue = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallIntMethod (controlAfStateValue, JavaInteger.intValue);}
\DoxyCodeLine{1876 }
\DoxyCodeLine{1877                     \textcolor{keywordflow}{return} controlAfStateIntValue == controlAfStateFocusedLocked || controlAfStateIntValue == controlAfStateNotFocusedLocked;}
\DoxyCodeLine{1878                 \}}
\DoxyCodeLine{1879 }
\DoxyCodeLine{1880                 \textcolor{keyword}{static} LocalRef<jobject> getCaptureResultIntegerKeyValue (jfieldID \mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}}, jobject captureResult)}
\DoxyCodeLine{1881                 \{}
\DoxyCodeLine{1882                     \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1883 }
\DoxyCodeLine{1884                     \textcolor{keyword}{auto} jKey = LocalRef<jobject> (env-\/>GetStaticObjectField (CaptureResult, \mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}}));}
\DoxyCodeLine{1885                     \textcolor{keywordflow}{return} LocalRef<jobject> (env-\/>CallObjectMethod (captureResult, CaptureResult.get, jKey.get()));}
\DoxyCodeLine{1886                 \}}
\DoxyCodeLine{1887 }
\DoxyCodeLine{1888                 \textcolor{keywordtype}{void} captureStillPictureDelayed()}
\DoxyCodeLine{1889                 \{}
\DoxyCodeLine{1890                     \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{1891                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1892 }
\DoxyCodeLine{1893                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still picture capture, device ready, capturing now..."{}});}
\DoxyCodeLine{1894 }
\DoxyCodeLine{1895                     \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1896 }
\DoxyCodeLine{1897                     env-\/>CallVoidMethod (captureSession, CameraCaptureSession.stopRepeating);}
\DoxyCodeLine{1898 }
\DoxyCodeLine{1899                     \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{1900                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1901 }
\DoxyCodeLine{1902                     env-\/>CallVoidMethod (captureSession, CameraCaptureSession.abortCaptures);}
\DoxyCodeLine{1903 }
\DoxyCodeLine{1904                     \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{1905                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1906 }
\DoxyCodeLine{1907                     \textcolor{comment}{// Delay still picture capture for devices that can't handle it right after}}
\DoxyCodeLine{1908                     \textcolor{comment}{// stopRepeating/abortCaptures calls.}}
\DoxyCodeLine{1909                     \textcolor{keywordflow}{if} (delayedCaptureRunnable.get() == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1910                         delayedCaptureRunnable = GlobalRef (\mbox{\hyperlink{namespacejuce_aa5d43f5b68766ba8c811e4e17df96a3e}{CreateJavaInterface}} (\&runnable, \textcolor{stringliteral}{"{}java/lang/Runnable"{}}));}
\DoxyCodeLine{1911 }
\DoxyCodeLine{1912                     env-\/>CallBooleanMethod (handler, AndroidHandler.postDelayed, delayedCaptureRunnable.get(), (jlong) 200);}
\DoxyCodeLine{1913                 \}}
\DoxyCodeLine{1914 }
\DoxyCodeLine{1915                 \textcolor{keywordtype}{void} runPrecaptureSequence()}
\DoxyCodeLine{1916                 \{}
\DoxyCodeLine{1917                     \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{1918                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1919 }
\DoxyCodeLine{1920                     \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1921 }
\DoxyCodeLine{1922                     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAePrecaptureTriggerStart = 1;}
\DoxyCodeLine{1923                     CaptureSession::setCaptureRequestBuilderIntegerKey (captureRequestBuilder.get(),}
\DoxyCodeLine{1924                                                                         CaptureRequest.CONTROL\_AE\_PRECAPTURE\_TRIGGER,}
\DoxyCodeLine{1925                                                                         controlAePrecaptureTriggerStart);}
\DoxyCodeLine{1926 }
\DoxyCodeLine{1927                     currentState = State::pendingExposurePrecapture;}
\DoxyCodeLine{1928 }
\DoxyCodeLine{1929                     \textcolor{keyword}{auto} previewRequest = LocalRef<jobject> (env-\/>CallObjectMethod (captureRequestBuilder,}
\DoxyCodeLine{1930                                                                                     CaptureRequestBuilder.build));}
\DoxyCodeLine{1931 }
\DoxyCodeLine{1932                     env-\/>CallIntMethod (captureSession, CameraCaptureSession.capture, previewRequest.get(),}
\DoxyCodeLine{1933                                         captureSessionPreviewCaptureCallback.get(), handler.get());}
\DoxyCodeLine{1934                 \}}
\DoxyCodeLine{1935 }
\DoxyCodeLine{1936                 \textcolor{keywordtype}{void} unlockFocus()}
\DoxyCodeLine{1937                 \{}
\DoxyCodeLine{1938                     \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{1939                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1940 }
\DoxyCodeLine{1941                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Unlocking focus..."{}});}
\DoxyCodeLine{1942 }
\DoxyCodeLine{1943                     currentState = State::idle;}
\DoxyCodeLine{1944 }
\DoxyCodeLine{1945                     \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{1946 }
\DoxyCodeLine{1947                     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlAfTriggerCancel = 2;}
\DoxyCodeLine{1948                     CaptureSession::setCaptureRequestBuilderIntegerKey (captureRequestBuilder.get(),}
\DoxyCodeLine{1949                                                                         CaptureRequest.CONTROL\_AF\_TRIGGER,}
\DoxyCodeLine{1950                                                                         controlAfTriggerCancel);}
\DoxyCodeLine{1951 }
\DoxyCodeLine{1952                     \textcolor{keyword}{auto} resetAutoFocusRequest = LocalRef<jobject> (env-\/>CallObjectMethod (captureRequestBuilder,}
\DoxyCodeLine{1953                                                                                            CaptureRequestBuilder.build));}
\DoxyCodeLine{1954 }
\DoxyCodeLine{1955                     env-\/>CallIntMethod (captureSession, CameraCaptureSession.capture, resetAutoFocusRequest.get(),}
\DoxyCodeLine{1956                                         \textcolor{keyword}{nullptr}, handler.get());}
\DoxyCodeLine{1957 }
\DoxyCodeLine{1958                     \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{1959                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{1960 }
\DoxyCodeLine{1961                     \textcolor{comment}{// NB: for preview, using preview capture request again}}
\DoxyCodeLine{1962                     env-\/>CallIntMethod (captureSession, CameraCaptureSession.setRepeatingRequest, previewCaptureRequest.get(),}
\DoxyCodeLine{1963                                         \textcolor{keyword}{nullptr}, handler.get());}
\DoxyCodeLine{1964                 \}}
\DoxyCodeLine{1965                 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1966                 \textcolor{keywordtype}{void} run()\textcolor{keyword}{ override}}
\DoxyCodeLine{1967 \textcolor{keyword}{                }\{}
\DoxyCodeLine{1968                     captureStillPicture();}
\DoxyCodeLine{1969                 \}}
\DoxyCodeLine{1970 }
\DoxyCodeLine{1971                 \textcolor{keywordtype}{void} captureStillPicture()}
\DoxyCodeLine{1972                 \{}
\DoxyCodeLine{1973                     \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallIntMethod (captureSession, CameraCaptureSession.capture,}
\DoxyCodeLine{1974                                              stillPictureCaptureRequest.get(), captureSessionStillPictureCaptureCallback.get(),}
\DoxyCodeLine{1975                                              \textcolor{keyword}{nullptr});}
\DoxyCodeLine{1976                 \}}
\DoxyCodeLine{1977 }
\DoxyCodeLine{1978                 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1979                 \textcolor{keywordtype}{void} cameraCaptureSessionCaptureCompleted (\textcolor{keywordtype}{bool} isPreview, jobject session, jobject request, jobject \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}})}
\DoxyCodeLine{1980                 \{}
\DoxyCodeLine{1981                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionCaptureCompleted()"{}});}
\DoxyCodeLine{1982 }
\DoxyCodeLine{1983                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (session, request);}
\DoxyCodeLine{1984 }
\DoxyCodeLine{1985                     \textcolor{keywordflow}{if} (isPreview)}
\DoxyCodeLine{1986                         updateState (\mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{1987                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (currentState != State::idle)}
\DoxyCodeLine{1988                         unlockFocus();}
\DoxyCodeLine{1989                 \}}
\DoxyCodeLine{1990 }
\DoxyCodeLine{1991                 \textcolor{keywordtype}{void} cameraCaptureSessionCaptureFailed (\textcolor{keywordtype}{bool} isPreview, jobject session, jobject request, jobject failure)}
\DoxyCodeLine{1992                 \{}
\DoxyCodeLine{1993                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionCaptureFailed()"{}});}
\DoxyCodeLine{1994 }
\DoxyCodeLine{1995                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (isPreview, session, request, failure);}
\DoxyCodeLine{1996                 \}}
\DoxyCodeLine{1997 }
\DoxyCodeLine{1998                 \textcolor{keywordtype}{void} cameraCaptureSessionCaptureProgressed (\textcolor{keywordtype}{bool} isPreview, jobject session, jobject request, jobject partialResult)}
\DoxyCodeLine{1999                 \{}
\DoxyCodeLine{2000                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionCaptureProgressed()"{}});}
\DoxyCodeLine{2001 }
\DoxyCodeLine{2002                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (session, request);}
\DoxyCodeLine{2003 }
\DoxyCodeLine{2004                     \textcolor{keywordflow}{if} (isPreview)}
\DoxyCodeLine{2005                         updateState (partialResult);}
\DoxyCodeLine{2006                 \}}
\DoxyCodeLine{2007 }
\DoxyCodeLine{2008                 \textcolor{keywordtype}{void} cameraCaptureSessionCaptureSequenceAborted (\textcolor{keywordtype}{bool} isPreview, jobject session, \textcolor{keywordtype}{int} sequenceId)}
\DoxyCodeLine{2009                 \{}
\DoxyCodeLine{2010                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionCaptureSequenceAborted()"{}});}
\DoxyCodeLine{2011 }
\DoxyCodeLine{2012                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (isPreview, isPreview, session, sequenceId);}
\DoxyCodeLine{2013                 \}}
\DoxyCodeLine{2014 }
\DoxyCodeLine{2015                 \textcolor{keywordtype}{void} cameraCaptureSessionCaptureSequenceCompleted (\textcolor{keywordtype}{bool} isPreview, jobject session, \textcolor{keywordtype}{int} sequenceId, \mbox{\hyperlink{group__juce__core-maths_gab0e5976e1a4967e9b13e68b5f271bb44}{int64}} frameNumber)}
\DoxyCodeLine{2016                 \{}
\DoxyCodeLine{2017                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionCaptureSequenceCompleted()"{}});}
\DoxyCodeLine{2018 }
\DoxyCodeLine{2019                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (isPreview, session, sequenceId, frameNumber);}
\DoxyCodeLine{2020                 \}}
\DoxyCodeLine{2021 }
\DoxyCodeLine{2022                 \textcolor{keywordtype}{void} cameraCaptureSessionCaptureStarted (\textcolor{keywordtype}{bool} isPreview, jobject session, jobject request, \mbox{\hyperlink{group__juce__core-maths_gab0e5976e1a4967e9b13e68b5f271bb44}{int64}} timestamp, \mbox{\hyperlink{group__juce__core-maths_gab0e5976e1a4967e9b13e68b5f271bb44}{int64}} frameNumber)}
\DoxyCodeLine{2023                 \{}
\DoxyCodeLine{2024                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionCaptureStarted()"{}});}
\DoxyCodeLine{2025 }
\DoxyCodeLine{2026                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (isPreview, session, request, timestamp, frameNumber);}
\DoxyCodeLine{2027                 \}}
\DoxyCodeLine{2028 }
\DoxyCodeLine{2029                 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2030                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionCaptureCompletedCallback (JNIEnv*, jobject \textcolor{comment}{/*object*/}, jlong host, jboolean isPreview, jobject rawSession, jobject rawRequest, jobject rawResult)}
\DoxyCodeLine{2031                 \{}
\DoxyCodeLine{2032                     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}StillPictureTaker*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2033                     \{}
\DoxyCodeLine{2034                         LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2035                         LocalRef<jobject> request (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawRequest));}
\DoxyCodeLine{2036                         LocalRef<jobject> \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawResult));}
\DoxyCodeLine{2037 }
\DoxyCodeLine{2038                         myself-\/>cameraCaptureSessionCaptureCompleted (isPreview != 0, session, request, \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{2039                     \}}
\DoxyCodeLine{2040                 \}}
\DoxyCodeLine{2041 }
\DoxyCodeLine{2042                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionCaptureFailedCallback (JNIEnv*, jobject \textcolor{comment}{/*object*/}, jlong host, jboolean isPreview, jobject rawSession, jobject rawRequest, jobject rawResult)}
\DoxyCodeLine{2043                 \{}
\DoxyCodeLine{2044                     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}StillPictureTaker*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2045                     \{}
\DoxyCodeLine{2046                         LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2047                         LocalRef<jobject> request (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawRequest));}
\DoxyCodeLine{2048                         LocalRef<jobject> \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawResult));}
\DoxyCodeLine{2049 }
\DoxyCodeLine{2050                         myself-\/>cameraCaptureSessionCaptureFailed (isPreview != 0, session, request, \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{2051                     \}}
\DoxyCodeLine{2052                 \}}
\DoxyCodeLine{2053 }
\DoxyCodeLine{2054                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionCaptureProgressedCallback (JNIEnv*, jobject \textcolor{comment}{/*object*/}, jlong host, jboolean isPreview, jobject rawSession, jobject rawRequest, jobject rawResult)}
\DoxyCodeLine{2055                 \{}
\DoxyCodeLine{2056                     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}StillPictureTaker*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2057                     \{}
\DoxyCodeLine{2058                         LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2059                         LocalRef<jobject> request (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawRequest));}
\DoxyCodeLine{2060                         LocalRef<jobject> \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawResult));}
\DoxyCodeLine{2061 }
\DoxyCodeLine{2062                         myself-\/>cameraCaptureSessionCaptureProgressed (isPreview != 0, session, request, \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{2063                     \}}
\DoxyCodeLine{2064                 \}}
\DoxyCodeLine{2065 }
\DoxyCodeLine{2066                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionCaptureSequenceAbortedCallback (JNIEnv*, jobject \textcolor{comment}{/*object*/}, jlong host, jboolean isPreview, jobject rawSession, jint sequenceId)}
\DoxyCodeLine{2067                 \{}
\DoxyCodeLine{2068                     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}StillPictureTaker*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2069                     \{}
\DoxyCodeLine{2070                         LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2071 }
\DoxyCodeLine{2072                         myself-\/>cameraCaptureSessionCaptureSequenceAborted (isPreview != 0, session, sequenceId);}
\DoxyCodeLine{2073                     \}}
\DoxyCodeLine{2074                 \}}
\DoxyCodeLine{2075 }
\DoxyCodeLine{2076                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionCaptureSequenceCompletedCallback (JNIEnv*, jobject \textcolor{comment}{/*object*/}, jlong host, jboolean isPreview, jobject rawSession, jint sequenceId, jlong frameNumber)}
\DoxyCodeLine{2077                 \{}
\DoxyCodeLine{2078                     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}StillPictureTaker*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2079                     \{}
\DoxyCodeLine{2080                         LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2081 }
\DoxyCodeLine{2082                         myself-\/>cameraCaptureSessionCaptureSequenceCompleted (isPreview != 0, session, sequenceId, frameNumber);}
\DoxyCodeLine{2083                     \}}
\DoxyCodeLine{2084                 \}}
\DoxyCodeLine{2085 }
\DoxyCodeLine{2086                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionCaptureStartedCallback (JNIEnv*, jobject \textcolor{comment}{/*object*/}, jlong host, jboolean isPreview, jobject rawSession, jobject rawRequest, jlong timestamp, jlong frameNumber)}
\DoxyCodeLine{2087                 \{}
\DoxyCodeLine{2088                     \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}StillPictureTaker*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2089                     \{}
\DoxyCodeLine{2090                         LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2091                         LocalRef<jobject> request (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawRequest));}
\DoxyCodeLine{2092 }
\DoxyCodeLine{2093                         myself-\/>cameraCaptureSessionCaptureStarted (isPreview != 0, session, request, timestamp, frameNumber);}
\DoxyCodeLine{2094                     \}}
\DoxyCodeLine{2095                 \}}
\DoxyCodeLine{2096             \};}
\DoxyCodeLine{2097 }
\DoxyCodeLine{2098             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2099             \mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_a9584c945a35fa7519d6ff4bff47f21b1}{ScopedCameraDevice}}\& scopedCameraDevice;}
\DoxyCodeLine{2100             ConfiguredCallback\& configuredCallback;}
\DoxyCodeLine{2101             GlobalRef\& handler;}
\DoxyCodeLine{2102 }
\DoxyCodeLine{2103             GlobalRef captureRequestBuilder;}
\DoxyCodeLine{2104             GlobalRef previewCaptureRequest;}
\DoxyCodeLine{2105 }
\DoxyCodeLine{2106             GlobalRef captureSessionStateCallback;}
\DoxyCodeLine{2107             \textcolor{keywordtype}{int} autoFocusMode;}
\DoxyCodeLine{2108 }
\DoxyCodeLine{2109             GlobalRef captureSession;}
\DoxyCodeLine{2110             \mbox{\hyperlink{class_critical_section}{CriticalSection}} captureSessionLock;}
\DoxyCodeLine{2111 }
\DoxyCodeLine{2112             \mbox{\hyperlink{struct_atomic}{Atomic<int>}} pendingClose \{ 0 \};}
\DoxyCodeLine{2113 }
\DoxyCodeLine{2114             std::unique\_ptr<StillPictureTaker> stillPictureTaker;}
\DoxyCodeLine{2115 }
\DoxyCodeLine{2116             \mbox{\hyperlink{class_waitable_event}{WaitableEvent}} closedEvent;}
\DoxyCodeLine{2117 }
\DoxyCodeLine{2118             \mbox{\hyperlink{group__juce__core-memory_ga557fa9dbf924a150e27f0cf0dad368b0}{JUCE\_DECLARE\_WEAK\_REFERENCEABLE}} (CaptureSession)}
\DoxyCodeLine{2119 }
\DoxyCodeLine{2120             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2121             \textcolor{preprocessor}{\#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK)    \(\backslash\)}}
\DoxyCodeLine{2122 \textcolor{preprocessor}{                METHOD (constructor, "{}<init>"{}}, "{}(J)V"{}) \(\backslash\)}
\DoxyCodeLine{2123                 CALLBACK(cameraCaptureSessionActiveCallback,          "{}cameraCaptureSessionActive"{},          "{}(JLandroid/hardware/camera2/CameraCaptureSession;)V"{}) \(\backslash\)}
\DoxyCodeLine{2124                 CALLBACK(cameraCaptureSessionClosedCallback,          "{}cameraCaptureSessionClosed"{},          "{}(JLandroid/hardware/camera2/CameraCaptureSession;)V"{}) \(\backslash\)}
\DoxyCodeLine{2125                 CALLBACK(cameraCaptureSessionConfigureFailedCallback, "{}cameraCaptureSessionConfigureFailed"{}, "{}(JLandroid/hardware/camera2/CameraCaptureSession;)V"{}) \(\backslash\)}
\DoxyCodeLine{2126                 CALLBACK(cameraCaptureSessionConfiguredCallback,      "{}cameraCaptureSessionConfigured"{},      "{}(JLandroid/hardware/camera2/CameraCaptureSession;)V"{}) \(\backslash\)}
\DoxyCodeLine{2127                 CALLBACK(cameraCaptureSessionReadyCallback,           "{}cameraCaptureSessionReady"{},           "{}(JLandroid/hardware/camera2/CameraCaptureSession;)V"{})}
\DoxyCodeLine{2128 }
\DoxyCodeLine{2129             \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CameraCaptureSessionStateCallback, \textcolor{stringliteral}{"{}com/rmsl/juce/CameraCaptureSessionStateCallback"{}}, 21)}
\DoxyCodeLine{2130             \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{2131 }
\DoxyCodeLine{2132 }
\DoxyCodeLine{2133             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2134             CaptureSession (\mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_a9584c945a35fa7519d6ff4bff47f21b1}{ScopedCameraDevice}}\& scopedCameraDeviceToUse, ConfiguredCallback\& configuredCallbackToUse,}
\DoxyCodeLine{2135                             \textcolor{keyword}{const} LocalRef<jobject>\& surfacesList, GlobalRef\& handlerToUse,}
\DoxyCodeLine{2136                             \textcolor{keywordtype}{int} captureSessionTemplate, \textcolor{keywordtype}{int} autoFocusModeToUse)}
\DoxyCodeLine{2137                 : scopedCameraDevice (scopedCameraDeviceToUse),}
\DoxyCodeLine{2138                   configuredCallback (configuredCallbackToUse),}
\DoxyCodeLine{2139                   handler (handlerToUse),}
\DoxyCodeLine{2140                   captureRequestBuilder (LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallObjectMethod (scopedCameraDevice.cameraDevice,}
\DoxyCodeLine{2141                                                                                         AndroidCameraDevice.createCaptureRequest,}
\DoxyCodeLine{2142                                                                                         (jint) captureSessionTemplate))),}
\DoxyCodeLine{2143                   captureSessionStateCallback (LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewObject (CameraCaptureSessionStateCallback,}
\DoxyCodeLine{2144                                                                                        CameraCaptureSessionStateCallback.constructor,}
\DoxyCodeLine{2145                                                                                        reinterpret\_cast<jlong> (this)))),}
\DoxyCodeLine{2146                   autoFocusMode (autoFocusModeToUse)}
\DoxyCodeLine{2147             \{}
\DoxyCodeLine{2148                 \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2149 }
\DoxyCodeLine{2150                 env-\/>CallVoidMethod (scopedCameraDevice.cameraDevice, AndroidCameraDevice.createCaptureSession,}
\DoxyCodeLine{2151                                      surfacesList.get(), captureSessionStateCallback.get(), handler.get());}
\DoxyCodeLine{2152 }
\DoxyCodeLine{2153                 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} controlModeAuto = 1;}
\DoxyCodeLine{2154                 setCaptureRequestBuilderIntegerKey (captureRequestBuilder.get(), CaptureRequest.CONTROL\_MODE, controlModeAuto);}
\DoxyCodeLine{2155 }
\DoxyCodeLine{2156                 setCaptureRequestBuilderIntegerKey (captureRequestBuilder.get(), CaptureRequest.CONTROL\_AF\_MODE, autoFocusMode);}
\DoxyCodeLine{2157             \}}
\DoxyCodeLine{2158 }
\DoxyCodeLine{2159             \textcolor{keyword}{static} \textcolor{keywordtype}{void} setCaptureRequestBuilderIntegerKey (jobject captureRequestBuilder, jfieldID \mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}}, \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacegl_ad24be0b39bf5b7d31f7c100de8508670}{value}})}
\DoxyCodeLine{2160             \{}
\DoxyCodeLine{2161                 \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2162 }
\DoxyCodeLine{2163                 \textcolor{keyword}{auto} jKey = LocalRef<jobject> (env-\/>GetStaticObjectField (CaptureRequest, \mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}}));}
\DoxyCodeLine{2164                 \textcolor{keyword}{auto} jValue = LocalRef<jobject> (env-\/>CallStaticObjectMethod (JavaInteger, JavaInteger.valueOf, (jint) \mbox{\hyperlink{namespacegl_ad24be0b39bf5b7d31f7c100de8508670}{value}}));}
\DoxyCodeLine{2165 }
\DoxyCodeLine{2166                 env-\/>CallVoidMethod (captureRequestBuilder, CaptureRequestBuilder.set, jKey.get(), jValue.get());}
\DoxyCodeLine{2167             \}}
\DoxyCodeLine{2168 }
\DoxyCodeLine{2169             \textcolor{keywordtype}{void} cameraCaptureSessionActive (jobject session)}
\DoxyCodeLine{2170             \{}
\DoxyCodeLine{2171                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionActive()"{}});}
\DoxyCodeLine{2172                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (session);}
\DoxyCodeLine{2173             \}}
\DoxyCodeLine{2174 }
\DoxyCodeLine{2175             \textcolor{keywordtype}{void} cameraCaptureSessionClosed (jobject session)}
\DoxyCodeLine{2176             \{}
\DoxyCodeLine{2177                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionClosed()"{}});}
\DoxyCodeLine{2178                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (session);}
\DoxyCodeLine{2179 }
\DoxyCodeLine{2180                 closedEvent.\mbox{\hyperlink{class_waitable_event_a7e51d16c549d2c9c200121161f859d5e}{signal}}();}
\DoxyCodeLine{2181             \}}
\DoxyCodeLine{2182 }
\DoxyCodeLine{2183             \textcolor{keywordtype}{void} cameraCaptureSessionConfigureFailed (jobject session)}
\DoxyCodeLine{2184             \{}
\DoxyCodeLine{2185                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionConfigureFailed()"{}});}
\DoxyCodeLine{2186                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (session);}
\DoxyCodeLine{2187 }
\DoxyCodeLine{2188                 \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([weakRef = \mbox{\hyperlink{class_weak_reference}{WeakReference<CaptureSession>}} \{ \textcolor{keyword}{this} \}]}
\DoxyCodeLine{2189                 \{}
\DoxyCodeLine{2190                     \textcolor{keywordflow}{if} (weakRef != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{2191                         weakRef-\/>configuredCallback.captureSessionConfigured (\textcolor{keyword}{nullptr});}
\DoxyCodeLine{2192                 \});}
\DoxyCodeLine{2193             \}}
\DoxyCodeLine{2194 }
\DoxyCodeLine{2195             \textcolor{keywordtype}{void} cameraCaptureSessionConfigured (\textcolor{keyword}{const} LocalRef<jobject>\& session)}
\DoxyCodeLine{2196             \{}
\DoxyCodeLine{2197                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionConfigured()"{}});}
\DoxyCodeLine{2198 }
\DoxyCodeLine{2199                 \textcolor{keywordflow}{if} (pendingClose.get() == 1)}
\DoxyCodeLine{2200                 \{}
\DoxyCodeLine{2201                     \textcolor{comment}{// Already closing, bailout.}}
\DoxyCodeLine{2202                     closedEvent.\mbox{\hyperlink{class_waitable_event_a7e51d16c549d2c9c200121161f859d5e}{signal}}();}
\DoxyCodeLine{2203 }
\DoxyCodeLine{2204                     GlobalRef \mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}} (session);}
\DoxyCodeLine{2205 }
\DoxyCodeLine{2206                     \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([\mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}}]()}
\DoxyCodeLine{2207                         \{}
\DoxyCodeLine{2208                             \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (\mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}}, CameraCaptureSession.close);}
\DoxyCodeLine{2209                         \});}
\DoxyCodeLine{2210 }
\DoxyCodeLine{2211                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{2212                 \}}
\DoxyCodeLine{2213 }
\DoxyCodeLine{2214                 \{}
\DoxyCodeLine{2215                     \textcolor{keyword}{const} \mbox{\hyperlink{class_generic_scoped_lock}{ScopedLock}} lock (captureSessionLock);}
\DoxyCodeLine{2216                     captureSession = GlobalRef (session);}
\DoxyCodeLine{2217                 \}}
\DoxyCodeLine{2218 }
\DoxyCodeLine{2219                 \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([weakRef = \mbox{\hyperlink{class_weak_reference}{WeakReference<CaptureSession>}} \{ \textcolor{keyword}{this} \}]}
\DoxyCodeLine{2220                 \{}
\DoxyCodeLine{2221                     \textcolor{keywordflow}{if} (weakRef == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{2222                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{2223 }
\DoxyCodeLine{2224                     weakRef-\/>stillPictureTaker.reset (\textcolor{keyword}{new} StillPictureTaker (weakRef-\/>captureSession,}
\DoxyCodeLine{2225                                                                              weakRef-\/>captureRequestBuilder,}
\DoxyCodeLine{2226                                                                              weakRef-\/>previewCaptureRequest,}
\DoxyCodeLine{2227                                                                              weakRef-\/>handler,}
\DoxyCodeLine{2228                                                                              weakRef-\/>autoFocusMode));}
\DoxyCodeLine{2229 }
\DoxyCodeLine{2230                     weakRef-\/>configuredCallback.captureSessionConfigured (weakRef.get());}
\DoxyCodeLine{2231                 \});}
\DoxyCodeLine{2232             \}}
\DoxyCodeLine{2233 }
\DoxyCodeLine{2234             \textcolor{keywordtype}{void} cameraCaptureSessionReady (\textcolor{keyword}{const} LocalRef<jobject>\& session)}
\DoxyCodeLine{2235             \{}
\DoxyCodeLine{2236                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraCaptureSessionReady()"{}});}
\DoxyCodeLine{2237                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (session);}
\DoxyCodeLine{2238             \}}
\DoxyCodeLine{2239 }
\DoxyCodeLine{2240             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2241             \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionActiveCallback (JNIEnv*, jobject, jlong host, jobject rawSession)}
\DoxyCodeLine{2242             \{}
\DoxyCodeLine{2243                 \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}CaptureSession*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2244                 \{}
\DoxyCodeLine{2245                     LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2246 }
\DoxyCodeLine{2247                     myself-\/>cameraCaptureSessionActive (session);}
\DoxyCodeLine{2248                 \}}
\DoxyCodeLine{2249             \}}
\DoxyCodeLine{2250 }
\DoxyCodeLine{2251             \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionClosedCallback (JNIEnv*, jobject, jlong host, jobject rawSession)}
\DoxyCodeLine{2252             \{}
\DoxyCodeLine{2253                 \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}CaptureSession*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2254                 \{}
\DoxyCodeLine{2255                     LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2256 }
\DoxyCodeLine{2257                     myself-\/>cameraCaptureSessionClosed (session);}
\DoxyCodeLine{2258                 \}}
\DoxyCodeLine{2259             \}}
\DoxyCodeLine{2260 }
\DoxyCodeLine{2261             \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionConfigureFailedCallback (JNIEnv*, jobject, jlong host, jobject rawSession)}
\DoxyCodeLine{2262             \{}
\DoxyCodeLine{2263                 \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}CaptureSession*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2264                 \{}
\DoxyCodeLine{2265                     LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2266 }
\DoxyCodeLine{2267                     myself-\/>cameraCaptureSessionConfigureFailed (session);}
\DoxyCodeLine{2268                 \}}
\DoxyCodeLine{2269             \}}
\DoxyCodeLine{2270 }
\DoxyCodeLine{2271             \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionConfiguredCallback (JNIEnv*, jobject, jlong host, jobject rawSession)}
\DoxyCodeLine{2272             \{}
\DoxyCodeLine{2273                 \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}CaptureSession*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2274                 \{}
\DoxyCodeLine{2275                     LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2276 }
\DoxyCodeLine{2277                     myself-\/>cameraCaptureSessionConfigured (session);}
\DoxyCodeLine{2278                 \}}
\DoxyCodeLine{2279             \}}
\DoxyCodeLine{2280 }
\DoxyCodeLine{2281             \textcolor{keyword}{static} \textcolor{keywordtype}{void} cameraCaptureSessionReadyCallback (JNIEnv*, jobject, jlong host, jobject rawSession)}
\DoxyCodeLine{2282             \{}
\DoxyCodeLine{2283                 \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}CaptureSession*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2284                 \{}
\DoxyCodeLine{2285                     LocalRef<jobject> session (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawSession));}
\DoxyCodeLine{2286 }
\DoxyCodeLine{2287                     myself-\/>cameraCaptureSessionReady (session);}
\DoxyCodeLine{2288                 \}}
\DoxyCodeLine{2289             \}}
\DoxyCodeLine{2290 }
\DoxyCodeLine{2291             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2292             \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_a9584c945a35fa7519d6ff4bff47f21b1}{ScopedCameraDevice}};}
\DoxyCodeLine{2293 }
\DoxyCodeLine{2294             \mbox{\hyperlink{group__juce__core-system_ga6ab7a603bf4435c7cb286b1744366eb2}{JUCE\_DECLARE\_NON\_COPYABLE}} (\mbox{\hyperlink{class_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session}{CaptureSession}})}
\DoxyCodeLine{2295         \};}
\DoxyCodeLine{2296 }
\DoxyCodeLine{2297         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2298         ScopedCameraDevice (\mbox{\hyperlink{struct_camera_device_1_1_pimpl}{Pimpl}}\& ownerToUse, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& cameraIdToUse, GlobalRef\& cameraManagerToUse,}
\DoxyCodeLine{2299                             GlobalRef\& handlerToUse, \textcolor{keywordtype}{int} autoFocusModeToUse)}
\DoxyCodeLine{2300             : owner (ownerToUse),}
\DoxyCodeLine{2301               cameraId (cameraIdToUse),}
\DoxyCodeLine{2302               cameraManager (cameraManagerToUse),}
\DoxyCodeLine{2303               handler (handlerToUse),}
\DoxyCodeLine{2304               cameraStateCallback (createCameraStateCallbackObject()),}
\DoxyCodeLine{2305               autoFocusMode (autoFocusModeToUse)}
\DoxyCodeLine{2306         \{}
\DoxyCodeLine{2307             \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6d14f00cad5a3be6c3490d6cb4d1dd28}{open}}();}
\DoxyCodeLine{2308         \}}
\DoxyCodeLine{2309 }
\DoxyCodeLine{2310         \string~ScopedCameraDevice()}
\DoxyCodeLine{2311         \{}
\DoxyCodeLine{2312             close();}
\DoxyCodeLine{2313         \}}
\DoxyCodeLine{2314 }
\DoxyCodeLine{2315         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6d14f00cad5a3be6c3490d6cb4d1dd28}{open}}()}
\DoxyCodeLine{2316         \{}
\DoxyCodeLine{2317             pendingOpen.set (1);}
\DoxyCodeLine{2318 }
\DoxyCodeLine{2319             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2320 }
\DoxyCodeLine{2321             env-\/>CallVoidMethod (cameraManager, CameraManager.openCamera,}
\DoxyCodeLine{2322                                  javaString (cameraId).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}(),}
\DoxyCodeLine{2323                                  cameraStateCallback.get(), handler.get());}
\DoxyCodeLine{2324 }
\DoxyCodeLine{2325             \textcolor{comment}{// If something went wrong we will be pinged in cameraDeviceStateError()}}
\DoxyCodeLine{2326             \textcolor{comment}{// callback, silence the redundant exception.}}
\DoxyCodeLine{2327             jniCheckHasExceptionOccurredAndClear();}
\DoxyCodeLine{2328         \}}
\DoxyCodeLine{2329 }
\DoxyCodeLine{2330         \textcolor{keywordtype}{void} close()}
\DoxyCodeLine{2331         \{}
\DoxyCodeLine{2332             \textcolor{keywordflow}{if} (pendingClose.compareAndSetBool (1, 0))}
\DoxyCodeLine{2333             \{}
\DoxyCodeLine{2334                 \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2335 }
\DoxyCodeLine{2336                 \textcolor{keywordflow}{if} (cameraDevice.get() != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{2337                 \{}
\DoxyCodeLine{2338                     env-\/>CallVoidMethod (cameraDevice, AndroidCameraDevice.close);}
\DoxyCodeLine{2339                     closedEvent.\mbox{\hyperlink{class_waitable_event_a1e5eb0e88e9e88aa34b58395d2bff1e0}{wait}} (-\/1);}
\DoxyCodeLine{2340                 \}}
\DoxyCodeLine{2341 }
\DoxyCodeLine{2342                 pendingClose.set (0);}
\DoxyCodeLine{2343                 pendingOpen .set (0);}
\DoxyCodeLine{2344                 cameraDevice.clear();}
\DoxyCodeLine{2345             \}}
\DoxyCodeLine{2346         \}}
\DoxyCodeLine{2347 }
\DoxyCodeLine{2348         \textcolor{keywordtype}{bool} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} cameraDevice != \textcolor{keyword}{nullptr}; \}}
\DoxyCodeLine{2349 }
\DoxyCodeLine{2350         \textcolor{keywordtype}{bool} hasErrorOccurred()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} fatalErrorOccurred.get(); \}}
\DoxyCodeLine{2351 }
\DoxyCodeLine{2352         CaptureSession* createCaptureSession (CaptureSession::ConfiguredCallback\& cc,}
\DoxyCodeLine{2353                                               \textcolor{keyword}{const} LocalRef<jobject>\& surfacesList,}
\DoxyCodeLine{2354                                               GlobalRef\& handlerToUse,}
\DoxyCodeLine{2355                                               \textcolor{keywordtype}{int} captureSessionTemplate)}
\DoxyCodeLine{2356         \{}
\DoxyCodeLine{2357             \textcolor{keywordflow}{if} (! \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}())}
\DoxyCodeLine{2358             \{}
\DoxyCodeLine{2359                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{2360                 \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{2361             \}}
\DoxyCodeLine{2362 }
\DoxyCodeLine{2363             \textcolor{keywordflow}{return} \textcolor{keyword}{new} CaptureSession (*\textcolor{keyword}{this}, cc, surfacesList, handlerToUse, captureSessionTemplate, autoFocusMode);}
\DoxyCodeLine{2364         \}}
\DoxyCodeLine{2365 }
\DoxyCodeLine{2366     \textcolor{keyword}{private}:}
\DoxyCodeLine{2367         \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& owner;}
\DoxyCodeLine{2368         \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}} cameraId;}
\DoxyCodeLine{2369         GlobalRef\& cameraManager;}
\DoxyCodeLine{2370         GlobalRef\& handler;}
\DoxyCodeLine{2371 }
\DoxyCodeLine{2372         GlobalRef cameraStateCallback;}
\DoxyCodeLine{2373         \textcolor{keywordtype}{int} autoFocusMode;}
\DoxyCodeLine{2374 }
\DoxyCodeLine{2375         GlobalRef cameraDevice;}
\DoxyCodeLine{2376         \mbox{\hyperlink{struct_atomic}{Atomic<int>}} pendingOpen \{ 0 \};}
\DoxyCodeLine{2377         \mbox{\hyperlink{struct_atomic}{Atomic<int>}} pendingClose \{ 0 \};}
\DoxyCodeLine{2378         \mbox{\hyperlink{struct_atomic}{Atomic<int>}} fatalErrorOccurred \{ 0 \};}
\DoxyCodeLine{2379         \mbox{\hyperlink{class_string}{String}} openError;}
\DoxyCodeLine{2380 }
\DoxyCodeLine{2381         \mbox{\hyperlink{class_waitable_event}{WaitableEvent}} closedEvent;}
\DoxyCodeLine{2382 }
\DoxyCodeLine{2383         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2384 \textcolor{preprocessor}{        \#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK)    \(\backslash\)}}
\DoxyCodeLine{2385 \textcolor{preprocessor}{            METHOD (constructor, "{}<init>"{}}, "{}(J)V"{}) \(\backslash\)}
\DoxyCodeLine{2386             CALLBACK (cameraDeviceStateClosedCallback,       "{}cameraDeviceStateClosed"{},       "{}(JLandroid/hardware/camera2/CameraDevice;)V"{})  \(\backslash\)}
\DoxyCodeLine{2387             CALLBACK (cameraDeviceStateDisconnectedCallback, "{}cameraDeviceStateDisconnected"{}, "{}(JLandroid/hardware/camera2/CameraDevice;)V"{})  \(\backslash\)}
\DoxyCodeLine{2388             CALLBACK (cameraDeviceStateErrorCallback,        "{}cameraDeviceStateError"{},        "{}(JLandroid/hardware/camera2/CameraDevice;I)V"{}) \(\backslash\)}
\DoxyCodeLine{2389             CALLBACK (cameraDeviceStateOpenedCallback,       "{}cameraDeviceStateOpened"{},       "{}(JLandroid/hardware/camera2/CameraDevice;)V"{})}
\DoxyCodeLine{2390 }
\DoxyCodeLine{2391         \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (CameraDeviceStateCallback, \textcolor{stringliteral}{"{}com/rmsl/juce/CameraDeviceStateCallback"{}}, 21)}
\DoxyCodeLine{2392         \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{2393 }
\DoxyCodeLine{2394         LocalRef<jobject> createCameraStateCallbackObject()}
\DoxyCodeLine{2395         \{}
\DoxyCodeLine{2396             \textcolor{keywordflow}{return} LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewObject (CameraDeviceStateCallback,}
\DoxyCodeLine{2397                                                            CameraDeviceStateCallback.constructor,}
\DoxyCodeLine{2398                                                            \textcolor{keyword}{reinterpret\_cast<}jlong\textcolor{keyword}{>} (\textcolor{keyword}{this})));}
\DoxyCodeLine{2399         \}}
\DoxyCodeLine{2400 }
\DoxyCodeLine{2401         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2402         \textcolor{keywordtype}{void} cameraDeviceStateClosed()}
\DoxyCodeLine{2403         \{}
\DoxyCodeLine{2404             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraDeviceStateClosed()"{}});}
\DoxyCodeLine{2405 }
\DoxyCodeLine{2406             closedEvent.\mbox{\hyperlink{class_waitable_event_a7e51d16c549d2c9c200121161f859d5e}{signal}}();}
\DoxyCodeLine{2407         \}}
\DoxyCodeLine{2408 }
\DoxyCodeLine{2409         \textcolor{keywordtype}{void} cameraDeviceStateDisconnected()}
\DoxyCodeLine{2410         \{}
\DoxyCodeLine{2411             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraDeviceStateDisconnected()"{}});}
\DoxyCodeLine{2412 }
\DoxyCodeLine{2413             \textcolor{keywordflow}{if} (pendingOpen.compareAndSetBool (0, 1))}
\DoxyCodeLine{2414             \{}
\DoxyCodeLine{2415                 openError = \textcolor{stringliteral}{"{}Device disconnected"{}};}
\DoxyCodeLine{2416 }
\DoxyCodeLine{2417                 notifyOpenResult();}
\DoxyCodeLine{2418             \}}
\DoxyCodeLine{2419 }
\DoxyCodeLine{2420             \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([\textcolor{keyword}{this}]() \{ close(); \});}
\DoxyCodeLine{2421         \}}
\DoxyCodeLine{2422 }
\DoxyCodeLine{2423         \textcolor{keywordtype}{void} cameraDeviceStateError (\textcolor{keywordtype}{int} errorCode)}
\DoxyCodeLine{2424         \{}
\DoxyCodeLine{2425             \mbox{\hyperlink{class_string}{String}} \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} = cameraErrorCodeToString (errorCode);}
\DoxyCodeLine{2426 }
\DoxyCodeLine{2427             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraDeviceStateError(), error: "{}} + \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{2428 }
\DoxyCodeLine{2429             \textcolor{keywordflow}{if} (pendingOpen.compareAndSetBool (0, 1))}
\DoxyCodeLine{2430             \{}
\DoxyCodeLine{2431                 openError = \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}};}
\DoxyCodeLine{2432 }
\DoxyCodeLine{2433                 notifyOpenResult();}
\DoxyCodeLine{2434             \}}
\DoxyCodeLine{2435 }
\DoxyCodeLine{2436             fatalErrorOccurred.set (1);}
\DoxyCodeLine{2437 }
\DoxyCodeLine{2438             \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([\textcolor{keyword}{this}, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}]()}
\DoxyCodeLine{2439                                        \{}
\DoxyCodeLine{2440                                            owner.cameraDeviceError (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{2441                                            close();}
\DoxyCodeLine{2442                                        \});}
\DoxyCodeLine{2443         \}}
\DoxyCodeLine{2444 }
\DoxyCodeLine{2445         \textcolor{keywordtype}{void} cameraDeviceStateOpened (\textcolor{keyword}{const} LocalRef<jobject>\& cameraDeviceToUse)}
\DoxyCodeLine{2446         \{}
\DoxyCodeLine{2447             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraDeviceStateOpened()"{}});}
\DoxyCodeLine{2448 }
\DoxyCodeLine{2449             pendingOpen.set (0);}
\DoxyCodeLine{2450 }
\DoxyCodeLine{2451             cameraDevice = GlobalRef (cameraDeviceToUse);}
\DoxyCodeLine{2452 }
\DoxyCodeLine{2453             notifyOpenResult();}
\DoxyCodeLine{2454         \}}
\DoxyCodeLine{2455 }
\DoxyCodeLine{2456         \textcolor{keywordtype}{void} notifyOpenResult()}
\DoxyCodeLine{2457         \{}
\DoxyCodeLine{2458             \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([\textcolor{keyword}{this}]() \{ owner.cameraOpenFinished (openError); \});}
\DoxyCodeLine{2459         \}}
\DoxyCodeLine{2460 }
\DoxyCodeLine{2461         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2462         \textcolor{keyword}{static} \textcolor{keywordtype}{void} JNICALL cameraDeviceStateClosedCallback (JNIEnv*, jobject, jlong host, jobject)}
\DoxyCodeLine{2463         \{}
\DoxyCodeLine{2464             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}ScopedCameraDevice*\textcolor{keyword}{>}(host))}
\DoxyCodeLine{2465                 myself-\/>cameraDeviceStateClosed();}
\DoxyCodeLine{2466         \}}
\DoxyCodeLine{2467 }
\DoxyCodeLine{2468         \textcolor{keyword}{static} \textcolor{keywordtype}{void} JNICALL cameraDeviceStateDisconnectedCallback (JNIEnv*, jobject, jlong host, jobject)}
\DoxyCodeLine{2469         \{}
\DoxyCodeLine{2470             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}ScopedCameraDevice*\textcolor{keyword}{>}(host))}
\DoxyCodeLine{2471                 myself-\/>cameraDeviceStateDisconnected();}
\DoxyCodeLine{2472         \}}
\DoxyCodeLine{2473 }
\DoxyCodeLine{2474         \textcolor{keyword}{static} \textcolor{keywordtype}{void} JNICALL cameraDeviceStateErrorCallback (JNIEnv*, jobject, jlong host, jobject, jint \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{2475         \{}
\DoxyCodeLine{2476             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}ScopedCameraDevice*\textcolor{keyword}{>}(host))}
\DoxyCodeLine{2477                 myself-\/>cameraDeviceStateError (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{2478         \}}
\DoxyCodeLine{2479 }
\DoxyCodeLine{2480         \textcolor{keyword}{static} \textcolor{keywordtype}{void} JNICALL cameraDeviceStateOpenedCallback (JNIEnv*, jobject, jlong host, jobject rawCamera)}
\DoxyCodeLine{2481         \{}
\DoxyCodeLine{2482             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}ScopedCameraDevice*\textcolor{keyword}{>}(host))}
\DoxyCodeLine{2483             \{}
\DoxyCodeLine{2484                 LocalRef<jobject> camera(\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewLocalRef(rawCamera));}
\DoxyCodeLine{2485 }
\DoxyCodeLine{2486                 myself-\/>cameraDeviceStateOpened (camera);}
\DoxyCodeLine{2487             \}}
\DoxyCodeLine{2488         \}}
\DoxyCodeLine{2489     \};}
\DoxyCodeLine{2490 }
\DoxyCodeLine{2491     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2492     \textcolor{keyword}{struct }CaptureSessionModeBase}
\DoxyCodeLine{2493     \{}
\DoxyCodeLine{2494         \textcolor{keyword}{virtual} \string~CaptureSessionModeBase() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{2495 }
\DoxyCodeLine{2496         \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} isVideoRecordSession() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{2497 }
\DoxyCodeLine{2498         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} triggerStillPictureCapture() = 0;}
\DoxyCodeLine{2499     \};}
\DoxyCodeLine{2500 }
\DoxyCodeLine{2501     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2502     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Mode>}
\DoxyCodeLine{2503     \textcolor{keyword}{struct }CaptureSessionMode   : \textcolor{keyword}{public} CaptureSessionModeBase,}
\DoxyCodeLine{2504                                   \textcolor{keyword}{private} PreviewDisplay::Listener,}
\DoxyCodeLine{2505                                   \textcolor{keyword}{private} ScopedCameraDevice::CaptureSession::ConfiguredCallback}
\DoxyCodeLine{2506     \{}
\DoxyCodeLine{2507         \string~CaptureSessionMode()\textcolor{keyword}{ override}}
\DoxyCodeLine{2508 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2509             captureSession.reset();}
\DoxyCodeLine{2510 }
\DoxyCodeLine{2511             previewDisplay.removeListener (\textcolor{keyword}{this});}
\DoxyCodeLine{2512         \}}
\DoxyCodeLine{2513 }
\DoxyCodeLine{2514         \textcolor{keywordtype}{bool} isVideoRecordSession()\textcolor{keyword}{ const override}}
\DoxyCodeLine{2515 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2516             \textcolor{keywordflow}{return} Mode::isVideoRecord();}
\DoxyCodeLine{2517         \}}
\DoxyCodeLine{2518 }
\DoxyCodeLine{2519         \textcolor{keywordtype}{void} triggerStillPictureCapture()\textcolor{keyword}{ override}}
\DoxyCodeLine{2520 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2521             \textcolor{keywordflow}{if} (captureSession == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{2522             \{}
\DoxyCodeLine{2523                 \textcolor{comment}{// The capture session must be ready before taking a still picture.}}
\DoxyCodeLine{2524                 \textcolor{comment}{// Did you remember to create and show a preview display?}}
\DoxyCodeLine{2525                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{2526                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{2527             \}}
\DoxyCodeLine{2528 }
\DoxyCodeLine{2529             crtp().takeStillPicture();}
\DoxyCodeLine{2530         \}}
\DoxyCodeLine{2531 }
\DoxyCodeLine{2532     \textcolor{keyword}{protected}:}
\DoxyCodeLine{2533         CaptureSessionMode (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& ownerToUse, ScopedCameraDevice\& cameraDeviceToUse,}
\DoxyCodeLine{2534                             GlobalRef\& handlerToUse, PreviewDisplay\& pd, \textcolor{keywordtype}{int} cameraSensorOrientationToUse,}
\DoxyCodeLine{2535                             \textcolor{keywordtype}{int} cameraLensFacingToUse, StreamConfigurationMap\& streamConfigurationMapToUse)}
\DoxyCodeLine{2536             : owner (ownerToUse),}
\DoxyCodeLine{2537               scopedCameraDevice (cameraDeviceToUse),}
\DoxyCodeLine{2538               handler (handlerToUse),}
\DoxyCodeLine{2539               previewDisplay (pd),}
\DoxyCodeLine{2540               cameraSensorOrientation (cameraSensorOrientationToUse),}
\DoxyCodeLine{2541               cameraLensFacing (cameraLensFacingToUse),}
\DoxyCodeLine{2542               streamConfigurationMap (streamConfigurationMapToUse)}
\DoxyCodeLine{2543         \{}
\DoxyCodeLine{2544             \textcolor{comment}{// async so that the object is fully constructed before the callback gets invoked}}
\DoxyCodeLine{2545             \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([weakRef = \mbox{\hyperlink{class_weak_reference}{WeakReference}}<CaptureSessionMode<Mode>> \{ \textcolor{keyword}{this} \}]}
\DoxyCodeLine{2546             \{}
\DoxyCodeLine{2547                 \textcolor{keywordflow}{if} (weakRef != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{2548                     weakRef-\/>previewDisplay.addListener (weakRef.get());}
\DoxyCodeLine{2549             \});}
\DoxyCodeLine{2550         \}}
\DoxyCodeLine{2551 }
\DoxyCodeLine{2552         Mode\& crtp() \{ \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}Mode\&\textcolor{keyword}{>} (*this); \}}
\DoxyCodeLine{2553 }
\DoxyCodeLine{2554         \textcolor{keywordtype}{void} previewDisplayReady()\textcolor{keyword}{ override}}
\DoxyCodeLine{2555 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2556             \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (previewDisplay.isReady());}
\DoxyCodeLine{2557 }
\DoxyCodeLine{2558             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}previewDisplayReady()"{}});}
\DoxyCodeLine{2559 }
\DoxyCodeLine{2560             \textcolor{comment}{// close previous capture session first}}
\DoxyCodeLine{2561             captureSession.reset();}
\DoxyCodeLine{2562 }
\DoxyCodeLine{2563             \textcolor{keywordflow}{if} (scopedCameraDevice.hasErrorOccurred())}
\DoxyCodeLine{2564             \{}
\DoxyCodeLine{2565                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Device error detected, not recreating a new camera session. The device needs to be reopened."{}});}
\DoxyCodeLine{2566                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{2567             \}}
\DoxyCodeLine{2568 }
\DoxyCodeLine{2569             captureSession.reset (scopedCameraDevice.createCaptureSession (*\textcolor{keyword}{this}, crtp().getCaptureSessionSurfaces(),}
\DoxyCodeLine{2570                                                                            handler, Mode::getTemplate()));}
\DoxyCodeLine{2571         \}}
\DoxyCodeLine{2572 }
\DoxyCodeLine{2573         \textcolor{keywordtype}{void} previewDisplayAboutToBeDestroyed()\textcolor{keyword}{ override}}
\DoxyCodeLine{2574 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2575             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}previewDisplayAboutToBeDestroyed()"{}});}
\DoxyCodeLine{2576 }
\DoxyCodeLine{2577             stopPreview();}
\DoxyCodeLine{2578         \}}
\DoxyCodeLine{2579 }
\DoxyCodeLine{2580         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_1_1_scoped_camera_device_1_1_capture_session_1_1_configured_callback_a76846511a6e771f55fe7c923b7ce2dc5}{captureSessionConfigured}} (ScopedCameraDevice::CaptureSession* session)\textcolor{keyword}{ override}}
\DoxyCodeLine{2581 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2582             \textcolor{keywordflow}{if} (session == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{2583             \{}
\DoxyCodeLine{2584                 owner.cameraDeviceError (\textcolor{stringliteral}{"{}Failed to configure camera session."{}});}
\DoxyCodeLine{2585                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{2586             \}}
\DoxyCodeLine{2587 }
\DoxyCodeLine{2588             \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (session == captureSession.get());}
\DoxyCodeLine{2589 }
\DoxyCodeLine{2590             \mbox{\hyperlink{struct_camera_device_1_1_pimpl_acfe211473bc9adf0817c0754ce201140}{startSession}}();}
\DoxyCodeLine{2591         \}}
\DoxyCodeLine{2592 }
\DoxyCodeLine{2593         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_acfe211473bc9adf0817c0754ce201140}{startSession}}()}
\DoxyCodeLine{2594         \{}
\DoxyCodeLine{2595             \textcolor{keywordflow}{if} (! captureSession-\/>start (crtp().getTargetSurfaces(), handler))}
\DoxyCodeLine{2596             \{}
\DoxyCodeLine{2597                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{2598                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Could not start capture session"{}});}
\DoxyCodeLine{2599             \}}
\DoxyCodeLine{2600 }
\DoxyCodeLine{2601             crtp().sessionStarted();}
\DoxyCodeLine{2602         \}}
\DoxyCodeLine{2603 }
\DoxyCodeLine{2604         \textcolor{keywordtype}{void} stopPreview()}
\DoxyCodeLine{2605         \{}
\DoxyCodeLine{2606             \textcolor{keywordflow}{if} (captureSession != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{2607             \{}
\DoxyCodeLine{2608                 \textcolor{keyword}{auto} session = captureSession-\/>getNativeSession();}
\DoxyCodeLine{2609 }
\DoxyCodeLine{2610                 \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2611 }
\DoxyCodeLine{2612                 env-\/>CallVoidMethod (session, CameraCaptureSession.stopRepeating);}
\DoxyCodeLine{2613 }
\DoxyCodeLine{2614                 \textcolor{keywordflow}{if} (jniCheckHasExceptionOccurredAndClear())}
\DoxyCodeLine{2615                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{2616 }
\DoxyCodeLine{2617                 env-\/>CallVoidMethod (session, CameraCaptureSession.abortCaptures);}
\DoxyCodeLine{2618 }
\DoxyCodeLine{2619                 jniCheckHasExceptionOccurredAndClear();}
\DoxyCodeLine{2620             \}}
\DoxyCodeLine{2621         \}}
\DoxyCodeLine{2622 }
\DoxyCodeLine{2623         \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& owner;}
\DoxyCodeLine{2624         ScopedCameraDevice\& scopedCameraDevice;}
\DoxyCodeLine{2625         GlobalRef\& handler;}
\DoxyCodeLine{2626         PreviewDisplay\& previewDisplay;}
\DoxyCodeLine{2627         \textcolor{keywordtype}{int} cameraSensorOrientation;}
\DoxyCodeLine{2628         \textcolor{keywordtype}{int} cameraLensFacing;}
\DoxyCodeLine{2629         StreamConfigurationMap\& streamConfigurationMap;}
\DoxyCodeLine{2630 }
\DoxyCodeLine{2631         std::unique\_ptr<ScopedCameraDevice::CaptureSession> captureSession;}
\DoxyCodeLine{2632 }
\DoxyCodeLine{2633         \mbox{\hyperlink{group__juce__core-memory_ga557fa9dbf924a150e27f0cf0dad368b0}{JUCE\_DECLARE\_WEAK\_REFERENCEABLE}} (CaptureSessionMode<Mode>)}
\DoxyCodeLine{2634     \};}
\DoxyCodeLine{2635 }
\DoxyCodeLine{2636     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2637     \textcolor{keyword}{struct }CaptureSessionPreviewMode : \textcolor{keyword}{public} CaptureSessionMode<CaptureSessionPreviewMode>}
\DoxyCodeLine{2638     \{}
\DoxyCodeLine{2639         CaptureSessionPreviewMode (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& ownerToUse, ScopedCameraDevice\& cameraDeviceToUse, GlobalRef\& handlerToUse,}
\DoxyCodeLine{2640                                    PreviewDisplay\& pd, ImageReader\& ir, \textcolor{keywordtype}{int} sensorOrientation,}
\DoxyCodeLine{2641                                    \textcolor{keywordtype}{int} cameraLensFacingToUse, StreamConfigurationMap\& streamConfigurationMapToUse)}
\DoxyCodeLine{2642             : CaptureSessionMode<CaptureSessionPreviewMode> (ownerToUse, cameraDeviceToUse, handlerToUse, pd,}
\DoxyCodeLine{2643                                                              sensorOrientation, cameraLensFacingToUse, streamConfigurationMapToUse),}
\DoxyCodeLine{2644               imageReader (ir)}
\DoxyCodeLine{2645         \{}
\DoxyCodeLine{2646         \}}
\DoxyCodeLine{2647 }
\DoxyCodeLine{2648         \textcolor{comment}{// Surfaces passed to newly created capture session.}}
\DoxyCodeLine{2649         LocalRef<jobject> getCaptureSessionSurfaces()\textcolor{keyword}{ const}}
\DoxyCodeLine{2650 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2651             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2652 }
\DoxyCodeLine{2653             \textcolor{keyword}{auto} previewSurface = LocalRef<jobject> (previewDisplay.createSurface());}
\DoxyCodeLine{2654             \textcolor{keyword}{auto} imageSurface = LocalRef<jobject> (imageReader.getSurface());}
\DoxyCodeLine{2655 }
\DoxyCodeLine{2656             \textcolor{keyword}{auto} arrayList = LocalRef<jobject> (env-\/>NewObject (JavaArrayList, JavaArrayList.constructor, 2));}
\DoxyCodeLine{2657             env-\/>CallBooleanMethod (arrayList, JavaArrayList.add, previewSurface.get());}
\DoxyCodeLine{2658             env-\/>CallBooleanMethod (arrayList, JavaArrayList.add, imageSurface.get());}
\DoxyCodeLine{2659 }
\DoxyCodeLine{2660             \textcolor{keyword}{auto} supported = streamConfigurationMap.isOutputSupportedForSurface (imageSurface);}
\DoxyCodeLine{2661 }
\DoxyCodeLine{2662             \textcolor{comment}{// Output surface is not supported by this device, still image capture will not work!}}
\DoxyCodeLine{2663             \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (supported);}
\DoxyCodeLine{2664 }
\DoxyCodeLine{2665             \textcolor{keywordflow}{return} arrayList;}
\DoxyCodeLine{2666         \}}
\DoxyCodeLine{2667 }
\DoxyCodeLine{2668         \textcolor{comment}{// Surfaces set as target during capture.}}
\DoxyCodeLine{2669         LocalRef<jobject> getTargetSurfaces()\textcolor{keyword}{ const}}
\DoxyCodeLine{2670 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2671             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2672 }
\DoxyCodeLine{2673             \textcolor{keyword}{auto} previewSurface = LocalRef<jobject> (previewDisplay.createSurface());}
\DoxyCodeLine{2674 }
\DoxyCodeLine{2675             \textcolor{keyword}{auto} arrayList = LocalRef<jobject> (env-\/>NewObject (JavaArrayList, JavaArrayList.constructor, 1));}
\DoxyCodeLine{2676             env-\/>CallBooleanMethod (arrayList, JavaArrayList.add, previewSurface.get());}
\DoxyCodeLine{2677 }
\DoxyCodeLine{2678             \textcolor{keywordflow}{return} arrayList;}
\DoxyCodeLine{2679         \}}
\DoxyCodeLine{2680 }
\DoxyCodeLine{2681         \textcolor{keyword}{static} \textcolor{keywordtype}{int} getTemplate()}
\DoxyCodeLine{2682         \{}
\DoxyCodeLine{2683             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} templatePreview = 1;}
\DoxyCodeLine{2684             \textcolor{keywordflow}{return} templatePreview;}
\DoxyCodeLine{2685         \}}
\DoxyCodeLine{2686 }
\DoxyCodeLine{2687         \textcolor{keyword}{static} \textcolor{keywordtype}{bool} isVideoRecord() \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{2688 }
\DoxyCodeLine{2689         \textcolor{keywordtype}{void} sessionStarted() \{\}}
\DoxyCodeLine{2690 }
\DoxyCodeLine{2691         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5167029331352275c3f62be288392d93}{takeStillPicture}}()}
\DoxyCodeLine{2692         \{}
\DoxyCodeLine{2693             imageReader.resetNotificationFlag();}
\DoxyCodeLine{2694             captureSession-\/>takeStillPicture (imageReader.getSurface());}
\DoxyCodeLine{2695         \}}
\DoxyCodeLine{2696 }
\DoxyCodeLine{2697     \textcolor{keyword}{private}:}
\DoxyCodeLine{2698         ImageReader\& imageReader;}
\DoxyCodeLine{2699     \};}
\DoxyCodeLine{2700 }
\DoxyCodeLine{2701     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2702     \textcolor{keyword}{struct }CaptureSessionVideoRecordingMode : \textcolor{keyword}{public} CaptureSessionMode<CaptureSessionVideoRecordingMode>}
\DoxyCodeLine{2703     \{}
\DoxyCodeLine{2704         CaptureSessionVideoRecordingMode (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& ownerToUse, ScopedCameraDevice\& cameraDeviceToUse, GlobalRef\& handlerToUse,}
\DoxyCodeLine{2705                                           PreviewDisplay\& pd, MediaRecorder\& mr, \textcolor{keywordtype}{int} sensorOrientation,}
\DoxyCodeLine{2706                                           \textcolor{keywordtype}{int} cameraLensFacingToUse, StreamConfigurationMap\& streamConfigurationMapToUse)}
\DoxyCodeLine{2707             : CaptureSessionMode<CaptureSessionVideoRecordingMode> (ownerToUse, cameraDeviceToUse, handlerToUse, pd,}
\DoxyCodeLine{2708                                                                     sensorOrientation, cameraLensFacingToUse, streamConfigurationMapToUse),}
\DoxyCodeLine{2709               mediaRecorder (mr)}
\DoxyCodeLine{2710         \{}
\DoxyCodeLine{2711         \}}
\DoxyCodeLine{2712 }
\DoxyCodeLine{2713         \string~CaptureSessionVideoRecordingMode()}
\DoxyCodeLine{2714         \{}
\DoxyCodeLine{2715             \textcolor{comment}{// We need to explicitly stop the preview before stopping the media recorder,}}
\DoxyCodeLine{2716             \textcolor{comment}{// because legacy devices can't handle recording stop before stopping the preview.}}
\DoxyCodeLine{2717             stopPreview();}
\DoxyCodeLine{2718 }
\DoxyCodeLine{2719             mediaRecorder.stop();}
\DoxyCodeLine{2720         \}}
\DoxyCodeLine{2721 }
\DoxyCodeLine{2722         \textcolor{comment}{// Surfaces passed to newly created capture session.}}
\DoxyCodeLine{2723         LocalRef<jobject> getCaptureSessionSurfaces()\textcolor{keyword}{ const}}
\DoxyCodeLine{2724 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2725             \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2726 }
\DoxyCodeLine{2727             \textcolor{keyword}{auto} previewSurface = LocalRef<jobject> (previewDisplay.createSurface());}
\DoxyCodeLine{2728             \textcolor{keyword}{auto} mediaRecorderSurface = LocalRef<jobject> (mediaRecorder.getSurface());}
\DoxyCodeLine{2729 }
\DoxyCodeLine{2730             \textcolor{keyword}{auto} arrayList = LocalRef<jobject> (env-\/>NewObject (JavaArrayList, JavaArrayList.constructor, 2));}
\DoxyCodeLine{2731             env-\/>CallBooleanMethod (arrayList, JavaArrayList.add, previewSurface.get());}
\DoxyCodeLine{2732             env-\/>CallBooleanMethod (arrayList, JavaArrayList.add, mediaRecorderSurface.get());}
\DoxyCodeLine{2733 }
\DoxyCodeLine{2734             \textcolor{keywordflow}{return} arrayList;}
\DoxyCodeLine{2735         \}}
\DoxyCodeLine{2736 }
\DoxyCodeLine{2737         \textcolor{comment}{// Surfaces set as target during capture.}}
\DoxyCodeLine{2738         LocalRef<jobject> getTargetSurfaces()\textcolor{keyword}{ const}}
\DoxyCodeLine{2739 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2740             \textcolor{comment}{// Same surfaces used.}}
\DoxyCodeLine{2741             \textcolor{keywordflow}{return} getCaptureSessionSurfaces();}
\DoxyCodeLine{2742         \}}
\DoxyCodeLine{2743 }
\DoxyCodeLine{2744         \textcolor{keyword}{static} \textcolor{keywordtype}{int} getTemplate()}
\DoxyCodeLine{2745         \{}
\DoxyCodeLine{2746             \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} templateRecord = 3;}
\DoxyCodeLine{2747             \textcolor{keywordflow}{return} templateRecord;}
\DoxyCodeLine{2748         \}}
\DoxyCodeLine{2749 }
\DoxyCodeLine{2750         \textcolor{keyword}{static} \textcolor{keywordtype}{bool} isVideoRecord() \{ \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \}}
\DoxyCodeLine{2751 }
\DoxyCodeLine{2752         \textcolor{keywordtype}{void} sessionStarted()}
\DoxyCodeLine{2753         \{}
\DoxyCodeLine{2754             \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([\textcolor{keyword}{this}]() \{ mediaRecorder.start(); \});}
\DoxyCodeLine{2755         \}}
\DoxyCodeLine{2756 }
\DoxyCodeLine{2757         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5167029331352275c3f62be288392d93}{takeStillPicture}}()}
\DoxyCodeLine{2758         \{}
\DoxyCodeLine{2759             \textcolor{comment}{// Taking still pictures while recording video is not supported on Android.}}
\DoxyCodeLine{2760             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{2761         \}}
\DoxyCodeLine{2762 }
\DoxyCodeLine{2763     \textcolor{keyword}{private}:}
\DoxyCodeLine{2764         MediaRecorder\& mediaRecorder;}
\DoxyCodeLine{2765     \};}
\DoxyCodeLine{2766 }
\DoxyCodeLine{2767     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2768     \textcolor{keyword}{class }DeviceOrientationChangeListener   : \textcolor{keyword}{private} \mbox{\hyperlink{class_timer}{Timer}}}
\DoxyCodeLine{2769     \{}
\DoxyCodeLine{2770     \textcolor{keyword}{public}:}
\DoxyCodeLine{2771         DeviceOrientationChangeListener (PreviewDisplay\& pd)}
\DoxyCodeLine{2772             : previewDisplay (pd),}
\DoxyCodeLine{2773               orientationEventListener (createOrientationEventListener()),}
\DoxyCodeLine{2774               canDetectChange (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallBooleanMethod (orientationEventListener,}
\DoxyCodeLine{2775                                                             OrientationEventListener.canDetectOrientation) != 0),}
\DoxyCodeLine{2776               deviceOrientation (\mbox{\hyperlink{class_desktop}{Desktop}}::getInstance().getCurrentOrientation()),}
\DoxyCodeLine{2777               lastKnownScreenOrientation (deviceOrientation)}
\DoxyCodeLine{2778         \{}
\DoxyCodeLine{2779             setEnabled (\textcolor{keyword}{true});}
\DoxyCodeLine{2780         \}}
\DoxyCodeLine{2781 }
\DoxyCodeLine{2782         \string~DeviceOrientationChangeListener()\textcolor{keyword}{ override}}
\DoxyCodeLine{2783 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2784             setEnabled (\textcolor{keyword}{false});}
\DoxyCodeLine{2785         \}}
\DoxyCodeLine{2786 }
\DoxyCodeLine{2787         \textcolor{keywordtype}{void} setEnabled (\textcolor{keywordtype}{bool} shouldBeEnabled)}
\DoxyCodeLine{2788         \{}
\DoxyCodeLine{2789             \textcolor{keywordflow}{if} (shouldBeEnabled \&\& ! canDetectChange)}
\DoxyCodeLine{2790             \{}
\DoxyCodeLine{2791                 \textcolor{comment}{// This device does not support orientation listening, photos may have wrong orientation!}}
\DoxyCodeLine{2792                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{2793                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{2794             \}}
\DoxyCodeLine{2795 }
\DoxyCodeLine{2796             \textcolor{keywordflow}{if} (shouldBeEnabled)}
\DoxyCodeLine{2797                 \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (orientationEventListener, OrientationEventListener.enable);}
\DoxyCodeLine{2798             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2799                 \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>CallVoidMethod (orientationEventListener, OrientationEventListener.disable);}
\DoxyCodeLine{2800         \}}
\DoxyCodeLine{2801 }
\DoxyCodeLine{2802         \textcolor{keywordtype}{bool} isSupported() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} canDetectChange; \}}
\DoxyCodeLine{2803 }
\DoxyCodeLine{2804         \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} getDeviceOrientation() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept}
\DoxyCodeLine{2805         \{}
\DoxyCodeLine{2806             \textcolor{keywordflow}{return} deviceOrientation;}
\DoxyCodeLine{2807         \}}
\DoxyCodeLine{2808 }
\DoxyCodeLine{2809     \textcolor{keyword}{private}:}
\DoxyCodeLine{2810         PreviewDisplay\& previewDisplay;}
\DoxyCodeLine{2811 }
\DoxyCodeLine{2812         GlobalRef orientationEventListener;}
\DoxyCodeLine{2813         \textcolor{keyword}{static} \textcolor{keyword}{constexpr} jint sensorDelayUI = 2;}
\DoxyCodeLine{2814 }
\DoxyCodeLine{2815         \textcolor{keywordtype}{bool} canDetectChange;}
\DoxyCodeLine{2816         \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} deviceOrientation;}
\DoxyCodeLine{2817 }
\DoxyCodeLine{2818         \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98a}{Desktop::DisplayOrientation}} lastKnownScreenOrientation;}
\DoxyCodeLine{2819         \textcolor{keywordtype}{int} numChecksForOrientationChange = 10;}
\DoxyCodeLine{2820 }
\DoxyCodeLine{2821         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2822 \textcolor{preprocessor}{        \#define JNI\_CLASS\_MEMBERS(METHOD, STATICMETHOD, FIELD, STATICFIELD, CALLBACK) \(\backslash\)}}
\DoxyCodeLine{2823 \textcolor{preprocessor}{            METHOD (canDetectOrientation, "{}canDetectOrientation"{}}, "{}()Z"{}) \(\backslash\)}
\DoxyCodeLine{2824             METHOD (constructor,          "{}<init>"{},               "{}(JLandroid/content/Context;I)V"{}) \(\backslash\)}
\DoxyCodeLine{2825             METHOD (disable,              "{}disable"{},              "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{2826             METHOD (enable,               "{}enable"{},               "{}()V"{}) \(\backslash\)}
\DoxyCodeLine{2827             CALLBACK (deviceOrientationChanged, "{}deviceOrientationChanged"{}, "{}(JI)V"{})}
\DoxyCodeLine{2828 }
\DoxyCodeLine{2829         \mbox{\hyperlink{juce__android___j_n_i_helpers_8h_aee2899905ecbbb12e9c3d56d31289078}{DECLARE\_JNI\_CLASS\_WITH\_MIN\_SDK}} (OrientationEventListener, \textcolor{stringliteral}{"{}com/rmsl/juce/JuceOrientationEventListener"{}}, 21)}
\DoxyCodeLine{2830         \textcolor{preprocessor}{\#undef JNI\_CLASS\_MEMBERS}}
\DoxyCodeLine{2831 }
\DoxyCodeLine{2832         LocalRef<jobject> createOrientationEventListener()}
\DoxyCodeLine{2833         \{}
\DoxyCodeLine{2834             \textcolor{keywordflow}{return} LocalRef<jobject> (\mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}()-\/>NewObject (OrientationEventListener,}
\DoxyCodeLine{2835                                                            OrientationEventListener.constructor,}
\DoxyCodeLine{2836                                                            \textcolor{keyword}{reinterpret\_cast<}jlong\textcolor{keyword}{>} (\textcolor{keyword}{this}),}
\DoxyCodeLine{2837                                                            \mbox{\hyperlink{namespacejuce_ae270c2dd4b358c3482f8950a283a36af}{getAppContext}}().\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}(),}
\DoxyCodeLine{2838                                                            sensorDelayUI));}
\DoxyCodeLine{2839         \}}
\DoxyCodeLine{2840 }
\DoxyCodeLine{2841         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2842         \textcolor{keywordtype}{void} orientationChanged (\textcolor{keywordtype}{int} orientation)}
\DoxyCodeLine{2843         \{}
\DoxyCodeLine{2844             \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (orientation < 360);}
\DoxyCodeLine{2845 }
\DoxyCodeLine{2846             \textcolor{comment}{// -\/1 == unknown}}
\DoxyCodeLine{2847             \textcolor{keywordflow}{if} (orientation < 0)}
\DoxyCodeLine{2848                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{2849 }
\DoxyCodeLine{2850             \textcolor{keyword}{auto} oldOrientation = deviceOrientation;}
\DoxyCodeLine{2851 }
\DoxyCodeLine{2852             \textcolor{comment}{// NB: this assumes natural position to be portrait always, but some devices may be landscape...}}
\DoxyCodeLine{2853             \textcolor{keywordflow}{if} (orientation > (360 -\/ 45) || orientation < 45)}
\DoxyCodeLine{2854                 deviceOrientation = \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aaced7253546b0f2e73e4dd08bcb60c9f8}{Desktop::upright}};}
\DoxyCodeLine{2855             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (orientation < 135)}
\DoxyCodeLine{2856                 deviceOrientation = \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aae1e0629de1668ef16f700b7278fd0f04}{Desktop::rotatedClockwise}};}
\DoxyCodeLine{2857             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (orientation < 225)}
\DoxyCodeLine{2858                 deviceOrientation = \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aa5820a6ffe2f7f012a16a1bd57e304b91}{Desktop::upsideDown}};}
\DoxyCodeLine{2859             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2860                 deviceOrientation = \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aab48176789b5764aae6aae6a393916712}{Desktop::rotatedAntiClockwise}};}
\DoxyCodeLine{2861 }
\DoxyCodeLine{2862             \textcolor{keywordflow}{if} (oldOrientation != deviceOrientation)}
\DoxyCodeLine{2863             \{}
\DoxyCodeLine{2864                 lastKnownScreenOrientation = \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_a02ae21e312faf1715e8311f1f53e5e00}{getCurrentOrientation}}();}
\DoxyCodeLine{2865 }
\DoxyCodeLine{2866                 \textcolor{comment}{// Need to update preview transform, but screen orientation will change slightly}}
\DoxyCodeLine{2867                 \textcolor{comment}{// later than sensor orientation.}}
\DoxyCodeLine{2868                 startTimer (500);}
\DoxyCodeLine{2869             \}}
\DoxyCodeLine{2870         \}}
\DoxyCodeLine{2871 }
\DoxyCodeLine{2872         \textcolor{keywordtype}{void} timerCallback()\textcolor{keyword}{ override}}
\DoxyCodeLine{2873 \textcolor{keyword}{        }\{}
\DoxyCodeLine{2874             \textcolor{keyword}{auto} currentOrientation = \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_a02ae21e312faf1715e8311f1f53e5e00}{getCurrentOrientation}}();}
\DoxyCodeLine{2875 }
\DoxyCodeLine{2876             \textcolor{keywordflow}{if} (lastKnownScreenOrientation != currentOrientation)}
\DoxyCodeLine{2877             \{}
\DoxyCodeLine{2878                 lastKnownScreenOrientation = currentOrientation;}
\DoxyCodeLine{2879 }
\DoxyCodeLine{2880                 stopTimer();}
\DoxyCodeLine{2881                 numChecksForOrientationChange = 10;}
\DoxyCodeLine{2882                 previewDisplay.updateSurfaceTransform();}
\DoxyCodeLine{2883 }
\DoxyCodeLine{2884                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{2885             \}}
\DoxyCodeLine{2886 }
\DoxyCodeLine{2887             \textcolor{keywordflow}{if} (-\/-\/numChecksForOrientationChange == 0)}
\DoxyCodeLine{2888             \{}
\DoxyCodeLine{2889                 stopTimer();}
\DoxyCodeLine{2890                 numChecksForOrientationChange = 10;}
\DoxyCodeLine{2891             \}}
\DoxyCodeLine{2892         \}}
\DoxyCodeLine{2893 }
\DoxyCodeLine{2894         \textcolor{keyword}{static} \textcolor{keywordtype}{void} deviceOrientationChanged (JNIEnv*, jobject \textcolor{comment}{/*obj*/}, jlong host, jint orientation)}
\DoxyCodeLine{2895         \{}
\DoxyCodeLine{2896             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* myself = \textcolor{keyword}{reinterpret\_cast<}DeviceOrientationChangeListener*\textcolor{keyword}{>} (host))}
\DoxyCodeLine{2897                 myself-\/>orientationChanged (orientation);}
\DoxyCodeLine{2898         \}}
\DoxyCodeLine{2899     \};}
\DoxyCodeLine{2900 }
\DoxyCodeLine{2901     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2902     CameraDevice\& owner;}
\DoxyCodeLine{2903     \textcolor{keywordtype}{int} minWidth, minHeight, maxWidth, maxHeight;}
\DoxyCodeLine{2904 }
\DoxyCodeLine{2905     \mbox{\hyperlink{class_string}{String}} cameraId;}
\DoxyCodeLine{2906     \mbox{\hyperlink{struct_camera_device_1_1_pimpl_aee53ed6db5b8ec3bdb39289775eabb76}{InternalOpenCameraResultCallback}} cameraOpenCallback;}
\DoxyCodeLine{2907 }
\DoxyCodeLine{2908     GlobalRef activityLifeListener;}
\DoxyCodeLine{2909 }
\DoxyCodeLine{2910     GlobalRef cameraManager;}
\DoxyCodeLine{2911     GlobalRef cameraCharacteristics;}
\DoxyCodeLine{2912     GlobalRef handlerThread;}
\DoxyCodeLine{2913     GlobalRef handler;}
\DoxyCodeLine{2914 }
\DoxyCodeLine{2915     StreamConfigurationMap streamConfigurationMap;}
\DoxyCodeLine{2916     PreviewDisplay previewDisplay;}
\DoxyCodeLine{2917     DeviceOrientationChangeListener deviceOrientationChangeListener;}
\DoxyCodeLine{2918     std::unique\_ptr<ImageReader> imageReader;}
\DoxyCodeLine{2919     std::unique\_ptr<MediaRecorder> mediaRecorder;}
\DoxyCodeLine{2920 }
\DoxyCodeLine{2921     std::unique\_ptr<CaptureSessionModeBase> currentCaptureSessionMode;}
\DoxyCodeLine{2922 }
\DoxyCodeLine{2923     std::unique\_ptr<ScopedCameraDevice> scopedCameraDevice;}
\DoxyCodeLine{2924 }
\DoxyCodeLine{2925     \mbox{\hyperlink{class_critical_section}{CriticalSection}} listenerLock;}
\DoxyCodeLine{2926     \mbox{\hyperlink{class_listener_list}{ListenerList<Listener>}} listeners;}
\DoxyCodeLine{2927 }
\DoxyCodeLine{2928     \mbox{\hyperlink{namespacejuce_a7959b0b488fde11032d8151bf10669a4}{std::function}}<\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\&)> pictureTakenCallback;}
\DoxyCodeLine{2929 }
\DoxyCodeLine{2930     \mbox{\hyperlink{class_time}{Time}} firstRecordedFrameTimeMs;}
\DoxyCodeLine{2931     \textcolor{keywordtype}{bool} notifiedOfCameraOpening = \textcolor{keyword}{false};}
\DoxyCodeLine{2932 }
\DoxyCodeLine{2933     \textcolor{keywordtype}{bool} appWasPaused = \textcolor{keyword}{false};}
\DoxyCodeLine{2934 }
\DoxyCodeLine{2935     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{2936     \textcolor{keywordtype}{int} getCameraSensorOrientation()\textcolor{keyword}{ const}}
\DoxyCodeLine{2937 \textcolor{keyword}{    }\{}
\DoxyCodeLine{2938         \textcolor{keywordflow}{return} getCameraCharacteristicsIntegerKeyValue (CameraCharacteristics.SENSOR\_ORIENTATION);}
\DoxyCodeLine{2939     \}}
\DoxyCodeLine{2940 }
\DoxyCodeLine{2941     \textcolor{keywordtype}{int} getAutoFocusModeToUse()\textcolor{keyword}{ const}}
\DoxyCodeLine{2942 \textcolor{keyword}{    }\{}
\DoxyCodeLine{2943         \textcolor{keyword}{auto} supportedModes = getSupportedAutoFocusModes();}
\DoxyCodeLine{2944 }
\DoxyCodeLine{2945         \textcolor{keyword}{enum}}
\DoxyCodeLine{2946         \{}
\DoxyCodeLine{2947             CONTROL\_AF\_MODE\_OFF = 0,}
\DoxyCodeLine{2948             CONTROL\_AF\_MODE\_AUTO = 1,}
\DoxyCodeLine{2949             CONTROL\_AF\_MODE\_CONTINUOUS\_PICTURE = 4}
\DoxyCodeLine{2950         \};}
\DoxyCodeLine{2951 }
\DoxyCodeLine{2952         \textcolor{keywordflow}{if} (supportedModes.contains (CONTROL\_AF\_MODE\_CONTINUOUS\_PICTURE))}
\DoxyCodeLine{2953             \textcolor{keywordflow}{return} CONTROL\_AF\_MODE\_CONTINUOUS\_PICTURE;}
\DoxyCodeLine{2954 }
\DoxyCodeLine{2955         \textcolor{keywordflow}{if} (supportedModes.contains (CONTROL\_AF\_MODE\_AUTO))}
\DoxyCodeLine{2956             \textcolor{keywordflow}{return} CONTROL\_AF\_MODE\_AUTO;}
\DoxyCodeLine{2957 }
\DoxyCodeLine{2958         \textcolor{keywordflow}{return} CONTROL\_AF\_MODE\_OFF;}
\DoxyCodeLine{2959     \}}
\DoxyCodeLine{2960 }
\DoxyCodeLine{2961     \mbox{\hyperlink{class_array}{Array<int>}} getSupportedAutoFocusModes()\textcolor{keyword}{ const}}
\DoxyCodeLine{2962 \textcolor{keyword}{    }\{}
\DoxyCodeLine{2963         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2964 }
\DoxyCodeLine{2965         \textcolor{keyword}{auto} jKey = LocalRef<jobject> (env-\/>GetStaticObjectField (CameraCharacteristics, CameraCharacteristics.CONTROL\_AF\_AVAILABLE\_MODES));}
\DoxyCodeLine{2966 }
\DoxyCodeLine{2967         \textcolor{keyword}{auto} supportedModes = LocalRef<jintArray> ((jintArray) env-\/>CallObjectMethod (cameraCharacteristics,}
\DoxyCodeLine{2968                                                                                       CameraCharacteristics.get,}
\DoxyCodeLine{2969                                                                                       jKey.get()));}
\DoxyCodeLine{2970 }
\DoxyCodeLine{2971         \textcolor{keywordflow}{return} jintArrayToJuceArray (supportedModes);}
\DoxyCodeLine{2972     \}}
\DoxyCodeLine{2973 }
\DoxyCodeLine{2974     \textcolor{keyword}{static} \mbox{\hyperlink{class_array}{Array<int>}} jintArrayToJuceArray (\textcolor{keyword}{const} LocalRef<jintArray>\& jArray)}
\DoxyCodeLine{2975     \{}
\DoxyCodeLine{2976         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2977 }
\DoxyCodeLine{2978         \textcolor{keyword}{auto}* jArrayElems = env-\/>GetIntArrayElements (jArray, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{2979         \textcolor{keyword}{auto} numElems = env-\/>GetArrayLength (jArray);}
\DoxyCodeLine{2980 }
\DoxyCodeLine{2981         \mbox{\hyperlink{class_array}{Array<int>}} juceArray;}
\DoxyCodeLine{2982 }
\DoxyCodeLine{2983         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}} = 0; \mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}} < numElems; ++\mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}})}
\DoxyCodeLine{2984             juceArray.\mbox{\hyperlink{class_array_a52da22e285e44171b6d6fa785a7d536a}{add}} (jArrayElems[\mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}}]);}
\DoxyCodeLine{2985 }
\DoxyCodeLine{2986         env-\/>ReleaseIntArrayElements (jArray, jArrayElems, 0);}
\DoxyCodeLine{2987         \textcolor{keywordflow}{return} juceArray;}
\DoxyCodeLine{2988     \}}
\DoxyCodeLine{2989 }
\DoxyCodeLine{2990     \textcolor{keywordtype}{int} getCameraCharacteristicsIntegerKeyValue (jfieldID \mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}})\textcolor{keyword}{ const}}
\DoxyCodeLine{2991 \textcolor{keyword}{    }\{}
\DoxyCodeLine{2992         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{2993 }
\DoxyCodeLine{2994         \textcolor{keyword}{auto} jKey = LocalRef<jobject> (env-\/>GetStaticObjectField (CameraCharacteristics, \mbox{\hyperlink{namespacegl_a45e4cfc4b70136c9a7e0000e34f4ed4e}{key}}));}
\DoxyCodeLine{2995 }
\DoxyCodeLine{2996         \textcolor{keyword}{auto} jValue = LocalRef<jobject> (env-\/>CallObjectMethod (cameraCharacteristics,}
\DoxyCodeLine{2997                                                                 CameraCharacteristics.get,}
\DoxyCodeLine{2998                                                                 jKey.get()));}
\DoxyCodeLine{2999 }
\DoxyCodeLine{3000         \textcolor{keywordflow}{return} env-\/>CallIntMethod (jValue, JavaInteger.intValue);}
\DoxyCodeLine{3001     \}}
\DoxyCodeLine{3002 }
\DoxyCodeLine{3003     \textcolor{keywordtype}{int} getCameraLensFacing()\textcolor{keyword}{ const}}
\DoxyCodeLine{3004 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3005         \textcolor{keywordflow}{return} getCameraCharacteristicsIntegerKeyValue (CameraCharacteristics.LENS\_FACING);}
\DoxyCodeLine{3006     \}}
\DoxyCodeLine{3007 }
\DoxyCodeLine{3008     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{3009     \textcolor{keywordtype}{void} cameraOpenFinished (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{3010     \{}
\DoxyCodeLine{3011         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraOpenFinished(), error = "{}} + \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{3012 }
\DoxyCodeLine{3013         \textcolor{keywordflow}{if} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.\mbox{\hyperlink{class_string_ab31a36bda8c789ba3c0ed37bb16c978c}{isEmpty}}())}
\DoxyCodeLine{3014         \{}
\DoxyCodeLine{3015             setupStillImageSize();}
\DoxyCodeLine{3016             startPreviewMode (*imageReader);}
\DoxyCodeLine{3017         \}}
\DoxyCodeLine{3018 }
\DoxyCodeLine{3019         \textcolor{comment}{// Do not notify about camera being reopened on app resume.}}
\DoxyCodeLine{3020         \textcolor{keywordflow}{if} (! notifiedOfCameraOpening)}
\DoxyCodeLine{3021         \{}
\DoxyCodeLine{3022             notifiedOfCameraOpening = \textcolor{keyword}{true};}
\DoxyCodeLine{3023 }
\DoxyCodeLine{3024             invokeCameraOpenCallback (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{3025         \}}
\DoxyCodeLine{3026     \}}
\DoxyCodeLine{3027 }
\DoxyCodeLine{3028     \textcolor{keywordtype}{void} cameraDeviceError (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{3029     \{}
\DoxyCodeLine{3030         \textcolor{keywordflow}{if} (owner.onErrorOccurred != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{3031             owner.onErrorOccurred (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{3032     \}}
\DoxyCodeLine{3033 }
\DoxyCodeLine{3034     \textcolor{keywordtype}{void} invokeCameraOpenCallback (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{3035     \{}
\DoxyCodeLine{3036         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}invokeCameraOpenCallback(), error = "{}} + \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{3037 }
\DoxyCodeLine{3038         \textcolor{keywordflow}{if} (cameraOpenCallback != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{3039             cameraOpenCallback (cameraId, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{3040     \}}
\DoxyCodeLine{3041 }
\DoxyCodeLine{3042     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{3043     \textcolor{keywordtype}{void} callListeners (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\& \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}})}
\DoxyCodeLine{3044     \{}
\DoxyCodeLine{3045         \textcolor{keyword}{const} \mbox{\hyperlink{class_generic_scoped_lock}{ScopedLock}} sl (listenerLock);}
\DoxyCodeLine{3046         listeners.\mbox{\hyperlink{class_listener_list_adea25521b1707f2f5ae242b3353f5751}{call}} ([=] (Listener\& l) \{ l.imageReceived (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}); \});}
\DoxyCodeLine{3047     \}}
\DoxyCodeLine{3048 }
\DoxyCodeLine{3049     \textcolor{keywordtype}{void} notifyPictureTaken (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\& \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}})}
\DoxyCodeLine{3050     \{}
\DoxyCodeLine{3051         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}notifyPictureTaken()"{}});}
\DoxyCodeLine{3052 }
\DoxyCodeLine{3053         \textcolor{keywordflow}{if} (pictureTakenCallback != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{3054             pictureTakenCallback (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{3055     \}}
\DoxyCodeLine{3056 }
\DoxyCodeLine{3057     \textcolor{keywordtype}{void} triggerStillPictureCapture()}
\DoxyCodeLine{3058     \{}
\DoxyCodeLine{3059         currentCaptureSessionMode-\/>triggerStillPictureCapture();}
\DoxyCodeLine{3060     \}}
\DoxyCodeLine{3061 }
\DoxyCodeLine{3062     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{3063     \textcolor{keywordtype}{void} setupStillImageSize()}
\DoxyCodeLine{3064     \{}
\DoxyCodeLine{3065         imageReader.reset();}
\DoxyCodeLine{3066 }
\DoxyCodeLine{3067         \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a536d0d7dfa78c4c18598e95babec8f7e}{imageSize}} = chooseBestSize (minWidth, minHeight, maxWidth, maxHeight,}
\DoxyCodeLine{3068                                          streamConfigurationMap.getSupportedStillImageOutputSizes());}
\DoxyCodeLine{3069 }
\DoxyCodeLine{3070         imageReader.reset (\textcolor{keyword}{new} ImageReader (*\textcolor{keyword}{this}, handler, \mbox{\hyperlink{namespacegl_a536d0d7dfa78c4c18598e95babec8f7e}{imageSize}}.getWidth(), \mbox{\hyperlink{namespacegl_a536d0d7dfa78c4c18598e95babec8f7e}{imageSize}}.getHeight(),}
\DoxyCodeLine{3071                                             getCameraSensorOrientation()));}
\DoxyCodeLine{3072     \}}
\DoxyCodeLine{3073 }
\DoxyCodeLine{3074     \textcolor{keyword}{static} \mbox{\hyperlink{class_rectangle}{Rectangle<int>}} chooseBestSize (\textcolor{keywordtype}{int} minWidth, \textcolor{keywordtype}{int} minHeight, \textcolor{keywordtype}{int} maxWidth, \textcolor{keywordtype}{int} maxHeight,}
\DoxyCodeLine{3075                                           \mbox{\hyperlink{class_array}{Array}}<\mbox{\hyperlink{class_rectangle}{Rectangle<int>}}> supportedSizes)}
\DoxyCodeLine{3076     \{}
\DoxyCodeLine{3077         \mbox{\hyperlink{class_rectangle}{Rectangle<int>}} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}};}
\DoxyCodeLine{3078 }
\DoxyCodeLine{3079         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}} : supportedSizes)}
\DoxyCodeLine{3080         \{}
\DoxyCodeLine{3081             \textcolor{keyword}{auto} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}}  = \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}.getWidth();}
\DoxyCodeLine{3082             \textcolor{keyword}{auto} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} = \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}.getHeight();}
\DoxyCodeLine{3083 }
\DoxyCodeLine{3084             \textcolor{keywordflow}{if} (width < minWidth || width > maxWidth || height < minHeight || height > maxHeight)}
\DoxyCodeLine{3085                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{3086 }
\DoxyCodeLine{3087             \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}}.contains (\mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}}))}
\DoxyCodeLine{3088                 \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} = \mbox{\hyperlink{namespacegl_a441d79156826d7dfbf89100bb934a38d}{size}};}
\DoxyCodeLine{3089         \}}
\DoxyCodeLine{3090 }
\DoxyCodeLine{3091         \textcolor{comment}{// None of the supported sizes matches required width \& height limitations, picking}}
\DoxyCodeLine{3092         \textcolor{comment}{// the first one available...}}
\DoxyCodeLine{3093         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (! \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}}.isEmpty());}
\DoxyCodeLine{3094 }
\DoxyCodeLine{3095         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}}.isEmpty())}
\DoxyCodeLine{3096             \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} = supportedSizes[0];}
\DoxyCodeLine{3097 }
\DoxyCodeLine{3098         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}};}
\DoxyCodeLine{3099     \}}
\DoxyCodeLine{3100 }
\DoxyCodeLine{3101     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{3102     \textcolor{keywordtype}{void} startPreviewMode (ImageReader\& ir)}
\DoxyCodeLine{3103     \{}
\DoxyCodeLine{3104         \textcolor{keywordflow}{if} (currentCaptureSessionMode != \textcolor{keyword}{nullptr} \&\& ! currentCaptureSessionMode-\/>isVideoRecordSession())}
\DoxyCodeLine{3105             \textcolor{keywordflow}{return};}
\DoxyCodeLine{3106 }
\DoxyCodeLine{3107         \textcolor{comment}{// previous mode has to be stopped first}}
\DoxyCodeLine{3108         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (currentCaptureSessionMode.get() == \textcolor{keyword}{nullptr});}
\DoxyCodeLine{3109 }
\DoxyCodeLine{3110         \textcolor{keywordflow}{if} (scopedCameraDevice == \textcolor{keyword}{nullptr} || ! scopedCameraDevice-\/>openedOk())}
\DoxyCodeLine{3111             \textcolor{keywordflow}{return};}
\DoxyCodeLine{3112 }
\DoxyCodeLine{3113         currentCaptureSessionMode.reset (\textcolor{keyword}{new} CaptureSessionPreviewMode (*\textcolor{keyword}{this}, *scopedCameraDevice, handler,}
\DoxyCodeLine{3114                                                                         previewDisplay, ir,}
\DoxyCodeLine{3115                                                                         getCameraSensorOrientation(),}
\DoxyCodeLine{3116                                                                         getCameraLensFacing(),}
\DoxyCodeLine{3117                                                                         streamConfigurationMap));}
\DoxyCodeLine{3118     \}}
\DoxyCodeLine{3119 }
\DoxyCodeLine{3120     \textcolor{keywordtype}{void} startVideoRecordingMode (MediaRecorder\& mr)}
\DoxyCodeLine{3121     \{}
\DoxyCodeLine{3122         \textcolor{keywordflow}{if} (currentCaptureSessionMode != \textcolor{keyword}{nullptr} \&\& currentCaptureSessionMode-\/>isVideoRecordSession())}
\DoxyCodeLine{3123             \textcolor{keywordflow}{return};}
\DoxyCodeLine{3124 }
\DoxyCodeLine{3125         \textcolor{comment}{// previous mode has to be stopped first}}
\DoxyCodeLine{3126         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (currentCaptureSessionMode.get() == \textcolor{keyword}{nullptr});}
\DoxyCodeLine{3127 }
\DoxyCodeLine{3128         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (scopedCameraDevice != \textcolor{keyword}{nullptr} \&\& scopedCameraDevice-\/>openedOk());}
\DoxyCodeLine{3129 }
\DoxyCodeLine{3130         \textcolor{keywordflow}{if} (scopedCameraDevice == \textcolor{keyword}{nullptr} || ! scopedCameraDevice-\/>openedOk())}
\DoxyCodeLine{3131             \textcolor{keywordflow}{return};}
\DoxyCodeLine{3132 }
\DoxyCodeLine{3133         currentCaptureSessionMode.reset (\textcolor{keyword}{new} CaptureSessionVideoRecordingMode (*\textcolor{keyword}{this}, *scopedCameraDevice, handler,}
\DoxyCodeLine{3134                                                                                previewDisplay, mr,}
\DoxyCodeLine{3135                                                                                getCameraSensorOrientation(),}
\DoxyCodeLine{3136                                                                                getCameraLensFacing(),}
\DoxyCodeLine{3137                                                                                streamConfigurationMap));}
\DoxyCodeLine{3138     \}}
\DoxyCodeLine{3139 }
\DoxyCodeLine{3140     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{3141     \textcolor{keywordtype}{void} onActivityPaused (jobject)\textcolor{keyword}{ override}}
\DoxyCodeLine{3142 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3143         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}appPaused, closing camera..."{}});}
\DoxyCodeLine{3144 }
\DoxyCodeLine{3145         appWasPaused = \textcolor{keyword}{true};}
\DoxyCodeLine{3146 }
\DoxyCodeLine{3147         deviceOrientationChangeListener.setEnabled (\textcolor{keyword}{false});}
\DoxyCodeLine{3148 }
\DoxyCodeLine{3149         \textcolor{comment}{// We need to restart the whole session mode when the app gets resumed.}}
\DoxyCodeLine{3150         currentCaptureSessionMode.reset();}
\DoxyCodeLine{3151 }
\DoxyCodeLine{3152         \textcolor{keywordflow}{if} (scopedCameraDevice != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{3153             scopedCameraDevice-\/>close();}
\DoxyCodeLine{3154 }
\DoxyCodeLine{3155         stopBackgroundThread();}
\DoxyCodeLine{3156     \}}
\DoxyCodeLine{3157 }
\DoxyCodeLine{3158     \textcolor{keywordtype}{void} onActivityResumed (jobject)\textcolor{keyword}{ override}}
\DoxyCodeLine{3159 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3160         \textcolor{comment}{// Only care about resumed event when paused event was called first.}}
\DoxyCodeLine{3161         \textcolor{keywordflow}{if} (! appWasPaused)}
\DoxyCodeLine{3162             \textcolor{keywordflow}{return};}
\DoxyCodeLine{3163 }
\DoxyCodeLine{3164         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}appResumed, opening camera..."{}});}
\DoxyCodeLine{3165 }
\DoxyCodeLine{3166         deviceOrientationChangeListener.setEnabled (\textcolor{keyword}{true});}
\DoxyCodeLine{3167 }
\DoxyCodeLine{3168         startBackgroundThread();}
\DoxyCodeLine{3169 }
\DoxyCodeLine{3170         \textcolor{keywordflow}{if} (scopedCameraDevice != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{3171             scopedCameraDevice-\/>open();}
\DoxyCodeLine{3172     \}}
\DoxyCodeLine{3173 }
\DoxyCodeLine{3174     \textcolor{keywordtype}{void} startBackgroundThread()}
\DoxyCodeLine{3175     \{}
\DoxyCodeLine{3176         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{3177 }
\DoxyCodeLine{3178         handlerThread = GlobalRef (LocalRef<jobject> (env-\/>NewObject (AndroidHandlerThread,}
\DoxyCodeLine{3179                                                                       AndroidHandlerThread.constructor,}
\DoxyCodeLine{3180                                                                       javaString (\textcolor{stringliteral}{"{}JuceCameraDeviceBackgroundThread"{}}).\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}())));}
\DoxyCodeLine{3181         \textcolor{comment}{// handler thread has to be started before its looper can be fetched}}
\DoxyCodeLine{3182         env-\/>CallVoidMethod (handlerThread, AndroidHandlerThread.start);}
\DoxyCodeLine{3183         handler = GlobalRef (LocalRef<jobject> (env-\/>NewObject (AndroidHandler,}
\DoxyCodeLine{3184                                                                 AndroidHandler.constructorWithLooper,}
\DoxyCodeLine{3185                                                                 env-\/>CallObjectMethod (handlerThread, AndroidHandlerThread.getLooper))));}
\DoxyCodeLine{3186     \}}
\DoxyCodeLine{3187 }
\DoxyCodeLine{3188     \textcolor{keywordtype}{void} stopBackgroundThread()}
\DoxyCodeLine{3189     \{}
\DoxyCodeLine{3190         \textcolor{keyword}{auto}* env = \mbox{\hyperlink{namespacejuce_a4f3642abf35d22b0f69c4361d90ce667}{getEnv}}();}
\DoxyCodeLine{3191 }
\DoxyCodeLine{3192         \textcolor{keyword}{auto} quitSafelyMethod = env-\/>GetMethodID(AndroidHandlerThread, \textcolor{stringliteral}{"{}quitSafely"{}}, \textcolor{stringliteral}{"{}()Z"{}});}
\DoxyCodeLine{3193 }
\DoxyCodeLine{3194         \textcolor{comment}{// this code will only run on SDK >= 21}}
\DoxyCodeLine{3195         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}}(quitSafelyMethod != \textcolor{keyword}{nullptr});}
\DoxyCodeLine{3196 }
\DoxyCodeLine{3197         env-\/>CallBooleanMethod (handlerThread, quitSafelyMethod);}
\DoxyCodeLine{3198         env-\/>CallVoidMethod (handlerThread, AndroidHandlerThread.join);}
\DoxyCodeLine{3199 }
\DoxyCodeLine{3200         jniCheckHasExceptionOccurredAndClear();}
\DoxyCodeLine{3201 }
\DoxyCodeLine{3202         handlerThread.clear();}
\DoxyCodeLine{3203         handler.clear();}
\DoxyCodeLine{3204     \}}
\DoxyCodeLine{3205 }
\DoxyCodeLine{3206     \textcolor{keyword}{friend} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_viewer_component}{CameraDevice::ViewerComponent}};}
\DoxyCodeLine{3207 }
\DoxyCodeLine{3208     \mbox{\hyperlink{group__juce__core-system_ga6ab7a603bf4435c7cb286b1744366eb2}{JUCE\_DECLARE\_NON\_COPYABLE}} (\mbox{\hyperlink{struct_camera_device_1_1_pimpl}{Pimpl}})}
\DoxyCodeLine{3209 \};}
\DoxyCodeLine{3210 }
\DoxyCodeLine{3211 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{3212 \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_viewer_component}{CameraDevice::ViewerComponent}}  : \textcolor{keyword}{public} \mbox{\hyperlink{class_component}{Component}},}
\DoxyCodeLine{3213                                         \textcolor{keyword}{private} \mbox{\hyperlink{class_component_movement_watcher}{ComponentMovementWatcher}}}
\DoxyCodeLine{3214 \{}
\DoxyCodeLine{3215     \mbox{\hyperlink{struct_camera_device_1_1_viewer_component_aa2953d6c88d135bab35a703fcf7276f9}{ViewerComponent}} (CameraDevice\& device) : \mbox{\hyperlink{class_component_movement_watcher}{ComponentMovementWatcher}} (this)}
\DoxyCodeLine{3216     \{}
\DoxyCodeLine{3217         \textcolor{keyword}{auto} previewSize = device.pimpl-\/>streamConfigurationMap.getDefaultPreviewSize();}
\DoxyCodeLine{3218 }
\DoxyCodeLine{3219         targetAspectRatio = (float) previewSize.getWidth() / (float) previewSize.getHeight();}
\DoxyCodeLine{3220 }
\DoxyCodeLine{3221         \textcolor{keywordflow}{if} (isOrientationLandscape())}
\DoxyCodeLine{3222             \mbox{\hyperlink{class_component_a64cbeee83a441e20ed5e7acb600ae107}{setBounds}} (previewSize);}
\DoxyCodeLine{3223         \textcolor{keywordflow}{else}}
\DoxyCodeLine{3224             \mbox{\hyperlink{class_component_a64cbeee83a441e20ed5e7acb600ae107}{setBounds}} (0, 0, previewSize.getHeight(), previewSize.getWidth());}
\DoxyCodeLine{3225 }
\DoxyCodeLine{3226         \mbox{\hyperlink{class_component_a909c90277e8e95db68001a94e06b83bc}{addAndMakeVisible}} (viewerComponent);}
\DoxyCodeLine{3227         viewerComponent.setView (device.pimpl-\/>previewDisplay.getNativeView());}
\DoxyCodeLine{3228     \}}
\DoxyCodeLine{3229 }
\DoxyCodeLine{3230 \textcolor{keyword}{private}:}
\DoxyCodeLine{3231     AndroidViewComponent viewerComponent;}
\DoxyCodeLine{3232 }
\DoxyCodeLine{3233     \textcolor{keywordtype}{float} targetAspectRatio = 1.0f;}
\DoxyCodeLine{3234 }
\DoxyCodeLine{3235     \textcolor{keywordtype}{void} componentMovedOrResized (\textcolor{keywordtype}{bool}, \textcolor{keywordtype}{bool})\textcolor{keyword}{ override}}
\DoxyCodeLine{3236 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3237         \textcolor{keyword}{auto} \mbox{\hyperlink{jpegint_8h_af320905358fa78701e4cc60b6135601f}{b}} = \mbox{\hyperlink{class_component_a0bb195a619802a5e8d4ed2218394816f}{getLocalBounds}}().toFloat();}
\DoxyCodeLine{3238 }
\DoxyCodeLine{3239         \textcolor{keyword}{auto} targetWidth  = \mbox{\hyperlink{jpegint_8h_af320905358fa78701e4cc60b6135601f}{b}}.getWidth();}
\DoxyCodeLine{3240         \textcolor{keyword}{auto} targetHeight = \mbox{\hyperlink{jpegint_8h_af320905358fa78701e4cc60b6135601f}{b}}.getHeight();}
\DoxyCodeLine{3241 }
\DoxyCodeLine{3242         \textcolor{keywordflow}{if} (isOrientationLandscape())}
\DoxyCodeLine{3243         \{}
\DoxyCodeLine{3244             \textcolor{keyword}{auto} currentAspectRatio = \mbox{\hyperlink{jpegint_8h_af320905358fa78701e4cc60b6135601f}{b}}.getWidth() / \mbox{\hyperlink{jpegint_8h_af320905358fa78701e4cc60b6135601f}{b}}.getHeight();}
\DoxyCodeLine{3245 }
\DoxyCodeLine{3246             \textcolor{keywordflow}{if} (currentAspectRatio > targetAspectRatio)}
\DoxyCodeLine{3247                 targetWidth = targetWidth * targetAspectRatio / currentAspectRatio;}
\DoxyCodeLine{3248             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3249                 targetHeight = targetHeight * currentAspectRatio / targetAspectRatio;}
\DoxyCodeLine{3250         \}}
\DoxyCodeLine{3251         \textcolor{keywordflow}{else}}
\DoxyCodeLine{3252         \{}
\DoxyCodeLine{3253             \textcolor{keyword}{auto} currentAspectRatio = \mbox{\hyperlink{jpegint_8h_af320905358fa78701e4cc60b6135601f}{b}}.getHeight() / \mbox{\hyperlink{jpegint_8h_af320905358fa78701e4cc60b6135601f}{b}}.getWidth();}
\DoxyCodeLine{3254 }
\DoxyCodeLine{3255             \textcolor{keywordflow}{if} (currentAspectRatio > targetAspectRatio)}
\DoxyCodeLine{3256                 targetHeight = targetHeight * targetAspectRatio / currentAspectRatio;}
\DoxyCodeLine{3257             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3258                 targetWidth = targetWidth * currentAspectRatio / targetAspectRatio;}
\DoxyCodeLine{3259         \}}
\DoxyCodeLine{3260 }
\DoxyCodeLine{3261         viewerComponent.setBounds (\mbox{\hyperlink{class_rectangle}{Rectangle<float>}} (targetWidth, targetHeight).withCentre (\mbox{\hyperlink{jpegint_8h_af320905358fa78701e4cc60b6135601f}{b}}.getCentre()).\mbox{\hyperlink{class_rectangle_a122fd9ac41bfcdf629402effabf02a43}{toNearestInt}}());}
\DoxyCodeLine{3262     \}}
\DoxyCodeLine{3263 }
\DoxyCodeLine{3264     \textcolor{keywordtype}{bool} isOrientationLandscape()\textcolor{keyword}{ const}}
\DoxyCodeLine{3265 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3266         \textcolor{keyword}{auto} o = \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_a02ae21e312faf1715e8311f1f53e5e00}{getCurrentOrientation}}();}
\DoxyCodeLine{3267         \textcolor{keywordflow}{return} o == \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aae1e0629de1668ef16f700b7278fd0f04}{Desktop::rotatedClockwise}} || o == \mbox{\hyperlink{class_desktop_a5e06947d2d1295bdb6f5c4fab7beb98aab48176789b5764aae6aae6a393916712}{Desktop::rotatedAntiClockwise}};}
\DoxyCodeLine{3268     \}}
\DoxyCodeLine{3269 }
\DoxyCodeLine{3270     \textcolor{keywordtype}{void} componentPeerChanged()\textcolor{keyword}{ override }\{\}}
\DoxyCodeLine{3271     \textcolor{keywordtype}{void} componentVisibilityChanged()\textcolor{keyword}{ override }\{\}}
\DoxyCodeLine{3272 }
\DoxyCodeLine{3273     \mbox{\hyperlink{group__juce__core-system_ga6ab7a603bf4435c7cb286b1744366eb2}{JUCE\_DECLARE\_NON\_COPYABLE}} (\mbox{\hyperlink{struct_camera_device_1_1_viewer_component_aa2953d6c88d135bab35a703fcf7276f9}{ViewerComponent}})}
\DoxyCodeLine{3274 \};}
\DoxyCodeLine{3275 }
\DoxyCodeLine{3276 \mbox{\hyperlink{class_string}{String}} CameraDevice::getFileExtension()}
\DoxyCodeLine{3277 \{}
\DoxyCodeLine{3278     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}.mp4"{}};}
\DoxyCodeLine{3279 \}}
\DoxyCodeLine{3280 }
\DoxyCodeLine{3281 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{3282 CameraDevice::Pimpl::ScopedCameraDevice::CaptureSession::StillPictureTaker::CameraCaptureSessionCaptureCallback\_Class CameraDevice::Pimpl::ScopedCameraDevice::CaptureSession::StillPictureTaker::CameraCaptureSessionCaptureCallback;}
\DoxyCodeLine{3283 CameraDevice::Pimpl::ScopedCameraDevice::CameraDeviceStateCallback\_Class CameraDevice::Pimpl::ScopedCameraDevice::CameraDeviceStateCallback;}
\DoxyCodeLine{3284 CameraDevice::Pimpl::ScopedCameraDevice::CaptureSession::CameraCaptureSessionStateCallback\_Class CameraDevice::Pimpl::ScopedCameraDevice::CaptureSession::CameraCaptureSessionStateCallback;}
\DoxyCodeLine{3285 CameraDevice::Pimpl::DeviceOrientationChangeListener::OrientationEventListener\_Class CameraDevice::Pimpl::DeviceOrientationChangeListener::OrientationEventListener;}

\end{DoxyCode}
