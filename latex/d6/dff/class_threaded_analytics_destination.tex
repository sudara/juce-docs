\hypertarget{class_threaded_analytics_destination}{}\doxysection{Threaded\+Analytics\+Destination Class Reference}
\label{class_threaded_analytics_destination}\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}


{\ttfamily \#include $<$juce\+\_\+\+Threaded\+Analytics\+Destination.\+h$>$}

Inheritance diagram for Threaded\+Analytics\+Destination\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{d6/dff/class_threaded_analytics_destination}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_threaded_analytics_destination_ab9a6dfe1046433c3b5b9ec764fc6260d}{Threaded\+Analytics\+Destination}} (\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{class_string}{String}} \&thread\+Name=\char`\"{}Analytics thread\char`\"{})
\item 
\mbox{\hyperlink{class_threaded_analytics_destination_aae993dee10c7bc385e9437472792b03b}{$\sim$\+Threaded\+Analytics\+Destination}} () override
\item 
virtual \mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}} \mbox{\hyperlink{class_threaded_analytics_destination_afd72d3a1b982b1fe5c2bdbef147a5aae}{get\+Maximum\+Batch\+Size}} ()=0
\item 
virtual bool \mbox{\hyperlink{class_threaded_analytics_destination_a72822517bc35699a4f474a35979e1430}{log\+Batched\+Events}} (\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{class_array}{Array}}$<$ \mbox{\hyperlink{struct_analytics_destination_1_1_analytics_event}{Analytics\+Event}} $>$ \&events)=0
\item 
virtual \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{class_threaded_analytics_destination_accb9697247b2816d09954d5ed16ed3a7}{stop\+Logging\+Events}} ()=0
\item 
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{class_threaded_analytics_destination_a338523778a4c5502c3faad51b3759c47}{set\+Batch\+Period}} (\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}} new\+Submission\+Period\+Milliseconds)
\item 
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{class_threaded_analytics_destination_ae4eef47f1255ba739ff571a600804526}{log\+Event}} (\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{struct_analytics_destination_1_1_analytics_event}{Analytics\+Event}} \&event) override final
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{class_threaded_analytics_destination_a73fc7de0e7468f8e0324bba6b0a1d69f}{start\+Analytics\+Thread}} (\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}} initial\+Batch\+Period\+Milliseconds)
\item 
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{class_threaded_analytics_destination_a5815b24414f5f982e796ce9690be8421}{stop\+Analytics\+Thread}} (\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}} timeout\+Milliseconds)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A base class for dispatching analytics events on a dedicated thread.

This class is particularly useful for sending analytics events to a web server without blocking the message thread. It can also save (and restore) events that were not dispatched so no information is lost when an internet connection is absent or something else prevents successful logging.

Once start\+Analytics\+Thread is called the log\+Batched\+Events method is periodically invoked on an analytics thread, with the period determined by calls to set\+Batch\+Period. Here events are grouped together into batches, with the maximum batch size set by the implementation of get\+Maximum\+Batch\+Size.

It\textquotesingle{}s important to call stop\+Analytics\+Thread in the destructor of your subclass (or before then) to give the analytics thread time to shut down. Calling stop\+Analytics\+Thread will, in turn, call stop\+Logging\+Events, which you should use to terminate the currently running log\+Batched\+Events call.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_analytics}{Analytics}}, \mbox{\hyperlink{struct_analytics_destination}{Analytics\+Destination}}, \mbox{\hyperlink{struct_analytics_destination_1_1_analytics_event}{Analytics\+Destination\+::\+Analytics\+Event}}
\end{DoxySeeAlso}
@tags\{\mbox{\hyperlink{class_analytics}{Analytics}}\} 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_threaded_analytics_destination_ab9a6dfe1046433c3b5b9ec764fc6260d}\label{class_threaded_analytics_destination_ab9a6dfe1046433c3b5b9ec764fc6260d}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{ThreadedAnalyticsDestination()}{ThreadedAnalyticsDestination()}}
{\footnotesize\ttfamily Threaded\+Analytics\+Destination\+::\+Threaded\+Analytics\+Destination (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{class_string}{String}} \&}]{thread\+Name = {\ttfamily \char`\"{}Analytics~thread\char`\"{}} }\end{DoxyParamCaption})}

Creates a \mbox{\hyperlink{class_threaded_analytics_destination}{Threaded\+Analytics\+Destination}}.


\begin{DoxyParams}{Parameters}
{\em thread\+Name} & used to identify the analytics thread in debug builds \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_threaded_analytics_destination_aae993dee10c7bc385e9437472792b03b}\label{class_threaded_analytics_destination_aae993dee10c7bc385e9437472792b03b}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!````~ThreadedAnalyticsDestination@{$\sim$ThreadedAnalyticsDestination}}
\index{````~ThreadedAnalyticsDestination@{$\sim$ThreadedAnalyticsDestination}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{$\sim$ThreadedAnalyticsDestination()}{~ThreadedAnalyticsDestination()}}
{\footnotesize\ttfamily Threaded\+Analytics\+Destination\+::$\sim$\+Threaded\+Analytics\+Destination (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}}

Destructor. 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_threaded_analytics_destination_afd72d3a1b982b1fe5c2bdbef147a5aae}\label{class_threaded_analytics_destination_afd72d3a1b982b1fe5c2bdbef147a5aae}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!getMaximumBatchSize@{getMaximumBatchSize}}
\index{getMaximumBatchSize@{getMaximumBatchSize}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{getMaximumBatchSize()}{getMaximumBatchSize()}}
{\footnotesize\ttfamily virtual \mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}} Threaded\+Analytics\+Destination\+::get\+Maximum\+Batch\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}

Override this method to provide the maximum batch size you can handle in your subclass.

Calls to log\+Batched\+Events will contain no more than this number of events. \mbox{\Hypertarget{class_threaded_analytics_destination_a72822517bc35699a4f474a35979e1430}\label{class_threaded_analytics_destination_a72822517bc35699a4f474a35979e1430}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!logBatchedEvents@{logBatchedEvents}}
\index{logBatchedEvents@{logBatchedEvents}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{logBatchedEvents()}{logBatchedEvents()}}
{\footnotesize\ttfamily virtual bool Threaded\+Analytics\+Destination\+::log\+Batched\+Events (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{class_array}{Array}}$<$ \mbox{\hyperlink{struct_analytics_destination_1_1_analytics_event}{Analytics\+Event}} $>$ \&}]{events }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}

This method will be called periodically on the analytics thread.

If this method returns false then the subsequent call of this function will contain the same events as previous call, plus any new events that have been generated in the period between calls. The order of events will not be changed. This allows you to retry logging events until they are logged successfully.


\begin{DoxyParams}{Parameters}
{\em events} & a list of events to be logged \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
if the events were successfully logged 
\end{DoxyReturn}
\mbox{\Hypertarget{class_threaded_analytics_destination_ae4eef47f1255ba739ff571a600804526}\label{class_threaded_analytics_destination_ae4eef47f1255ba739ff571a600804526}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!logEvent@{logEvent}}
\index{logEvent@{logEvent}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{logEvent()}{logEvent()}}
{\footnotesize\ttfamily \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} Threaded\+Analytics\+Destination\+::log\+Event (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{struct_analytics_destination_1_1_analytics_event}{Analytics\+Event}} \&}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [final]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Adds an event to the queue, which will ultimately be submitted to log\+Batched\+Events.

This method is thread safe.


\begin{DoxyParams}{Parameters}
{\em event} & the analytics event to add to the queue \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{struct_analytics_destination_a915afe9dfa5adb575454363e5367a4bd}{Analytics\+Destination}}.

\mbox{\Hypertarget{class_threaded_analytics_destination_a338523778a4c5502c3faad51b3759c47}\label{class_threaded_analytics_destination_a338523778a4c5502c3faad51b3759c47}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!setBatchPeriod@{setBatchPeriod}}
\index{setBatchPeriod@{setBatchPeriod}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{setBatchPeriod()}{setBatchPeriod()}}
{\footnotesize\ttfamily \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} Threaded\+Analytics\+Destination\+::set\+Batch\+Period (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}}}]{new\+Submission\+Period\+Milliseconds }\end{DoxyParamCaption})}

Call this to set the period between log\+Batched\+Events invocations.

This method is thread safe and can be used to implements things like exponential backoff in log\+Batched\+Events calls.


\begin{DoxyParams}{Parameters}
{\em new\+Submission\+Period\+Milliseconds} & the new submission period to use in milliseconds \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_threaded_analytics_destination_a73fc7de0e7468f8e0324bba6b0a1d69f}\label{class_threaded_analytics_destination_a73fc7de0e7468f8e0324bba6b0a1d69f}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!startAnalyticsThread@{startAnalyticsThread}}
\index{startAnalyticsThread@{startAnalyticsThread}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{startAnalyticsThread()}{startAnalyticsThread()}}
{\footnotesize\ttfamily \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} Threaded\+Analytics\+Destination\+::start\+Analytics\+Thread (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}}}]{initial\+Batch\+Period\+Milliseconds }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Starts the analytics thread, with an initial event batching period.


\begin{DoxyParams}{Parameters}
{\em initial\+Batch\+Period\+Milliseconds} & the initial event batching period in milliseconds \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_threaded_analytics_destination_a5815b24414f5f982e796ce9690be8421}\label{class_threaded_analytics_destination_a5815b24414f5f982e796ce9690be8421}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!stopAnalyticsThread@{stopAnalyticsThread}}
\index{stopAnalyticsThread@{stopAnalyticsThread}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{stopAnalyticsThread()}{stopAnalyticsThread()}}
{\footnotesize\ttfamily \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} Threaded\+Analytics\+Destination\+::stop\+Analytics\+Thread (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__juce__audio__plugin__client-_unity_ga966b05a42d98c7296097e073c627dcd0}{int}}}]{timeout\+Milliseconds }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Triggers the shutdown of the analytics thread.

You must call this method in the destructor of your subclass (or before then) to give the analytics thread time to shut down.

This method invokes stop\+Logging\+Events and you should ensure that both the analytics thread and a call to save\+Unlogged\+Events are able to finish before the supplied timeout. This timeout is important because on platforms like i\+OS an app is killed if it takes too long to shut down.


\begin{DoxyParams}{Parameters}
{\em timeout\+Milliseconds} & the number of milliseconds before the analytics thread is forcibly terminated \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_threaded_analytics_destination_accb9697247b2816d09954d5ed16ed3a7}\label{class_threaded_analytics_destination_accb9697247b2816d09954d5ed16ed3a7}} 
\index{ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}!stopLoggingEvents@{stopLoggingEvents}}
\index{stopLoggingEvents@{stopLoggingEvents}!ThreadedAnalyticsDestination@{ThreadedAnalyticsDestination}}
\doxysubsubsection{\texorpdfstring{stopLoggingEvents()}{stopLoggingEvents()}}
{\footnotesize\ttfamily virtual \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} Threaded\+Analytics\+Destination\+::stop\+Logging\+Events (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}

You must always call stop\+Analytics\+Thread in the destructor of your subclass (or before then) to give the analytics thread time to shut down.

Calling stop\+Analytics\+Thread triggers a call to this method. At this point you are guaranteed that log\+Batched\+Events has been called for the last time and you should make sure that the current call to log\+Batched\+Events finishes as quickly as possible. This method and a subsequent call to save\+Unlogged\+Events must both complete before the timeout supplied to stop\+Analytics\+Thread.

In a normal use case stop\+Logging\+Events will be called on the message thread from the destructor of your \mbox{\hyperlink{class_threaded_analytics_destination}{Threaded\+Analytics\+Destination}} subclass, and must stop the log\+Batched\+Events method which is running on the analytics thread.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_threaded_analytics_destination_a5815b24414f5f982e796ce9690be8421}{stop\+Analytics\+Thread}} 
\end{DoxySeeAlso}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
build/juce\+\_\+analytics/destinations/\mbox{\hyperlink{juce___threaded_analytics_destination_8h}{juce\+\_\+\+Threaded\+Analytics\+Destination.\+h}}\item 
build/juce\+\_\+analytics/destinations/\mbox{\hyperlink{juce___threaded_analytics_destination_8cpp}{juce\+\_\+\+Threaded\+Analytics\+Destination.\+cpp}}\end{DoxyCompactItemize}
