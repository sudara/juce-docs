\hypertarget{juce___linux_message_thread_8h_source}{}\doxysection{juce\+\_\+\+Linux\+Message\+Thread.\+h}
\label{juce___linux_message_thread_8h_source}\index{build/juce\_audio\_plugin\_client/utility/juce\_LinuxMessageThread.h@{build/juce\_audio\_plugin\_client/utility/juce\_LinuxMessageThread.h}}
\mbox{\hyperlink{juce___linux_message_thread_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{5 \textcolor{comment}{/*}}
\DoxyCodeLine{6 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{7 \textcolor{comment}{}}
\DoxyCodeLine{8 \textcolor{comment}{   This file is part of the JUCE library.}}
\DoxyCodeLine{9 \textcolor{comment}{   Copyright (c) 2020 -\/ Raw Material Software Limited}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{   JUCE is an open source library subject to commercial or open-\/source}}
\DoxyCodeLine{12 \textcolor{comment}{   licensing.}}
\DoxyCodeLine{13 \textcolor{comment}{}}
\DoxyCodeLine{14 \textcolor{comment}{   By using JUCE, you agree to the terms of both the JUCE 6 End-\/User License}}
\DoxyCodeLine{15 \textcolor{comment}{   Agreement and JUCE Privacy Policy (both effective as of the 16th June 2020).}}
\DoxyCodeLine{16 \textcolor{comment}{}}
\DoxyCodeLine{17 \textcolor{comment}{   End User License Agreement: www.juce.com/juce-\/6-\/licence}}
\DoxyCodeLine{18 \textcolor{comment}{   Privacy Policy: www.juce.com/juce-\/privacy-\/policy}}
\DoxyCodeLine{19 \textcolor{comment}{}}
\DoxyCodeLine{20 \textcolor{comment}{   Or: You may also use this code under the terms of the GPL v3 (see}}
\DoxyCodeLine{21 \textcolor{comment}{   www.gnu.org/licenses).}}
\DoxyCodeLine{22 \textcolor{comment}{}}
\DoxyCodeLine{23 \textcolor{comment}{   JUCE IS PROVIDED "{}AS IS"{} WITHOUT ANY WARRANTY, AND ALL WARRANTIES, WHETHER}}
\DoxyCodeLine{24 \textcolor{comment}{   EXPRESSED OR IMPLIED, INCLUDING MERCHANTABILITY AND FITNESS FOR PURPOSE, ARE}}
\DoxyCodeLine{25 \textcolor{comment}{   DISCLAIMED.}}
\DoxyCodeLine{26 \textcolor{comment}{}}
\DoxyCodeLine{27 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{28 \textcolor{comment}{*/}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#if JUCE\_LINUX || JUCE\_BSD}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <thread>}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{comment}{// Implemented in juce\_linux\_Messaging.cpp}}
\DoxyCodeLine{35 \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacejuce_aaecb4dafdf66ed7ca381c39e2ef40f1f}{dispatchNextMessageOnSystemQueue}} (\textcolor{keywordtype}{bool} returnIfNoPendingMessages);}
\DoxyCodeLine{36 }
\DoxyCodeLine{38 \textcolor{keyword}{class }MessageThread}
\DoxyCodeLine{39 \{}
\DoxyCodeLine{40 \textcolor{keyword}{public}:}
\DoxyCodeLine{41     MessageThread()}
\DoxyCodeLine{42     \{}
\DoxyCodeLine{43         \mbox{\hyperlink{namespacegl_adad3a3824fbe72fb0b01074bb01ebe75}{start}}();}
\DoxyCodeLine{44     \}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \string~MessageThread()}
\DoxyCodeLine{47     \{}
\DoxyCodeLine{48         \mbox{\hyperlink{class_message_manager_a4367fa495f95a5562b58dde1ad0e965b}{MessageManager::getInstance}}()-\/>\mbox{\hyperlink{class_message_manager_a283b20c2b3786537b31952670d2df7bf}{stopDispatchLoop}}();}
\DoxyCodeLine{49         stop();}
\DoxyCodeLine{50     \}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacegl_adad3a3824fbe72fb0b01074bb01ebe75}{start}}()}
\DoxyCodeLine{53     \{}
\DoxyCodeLine{54         \textcolor{keywordflow}{if} (isRunning())}
\DoxyCodeLine{55             stop();}
\DoxyCodeLine{56 }
\DoxyCodeLine{57         shouldExit = \textcolor{keyword}{false};}
\DoxyCodeLine{58 }
\DoxyCodeLine{59         thread = std::thread \{ [\textcolor{keyword}{this}]}
\DoxyCodeLine{60         \{}
\DoxyCodeLine{61             \mbox{\hyperlink{class_thread_abb8ff2e372728df9bc5293388b6a243f}{Thread::setCurrentThreadPriority}} (7);}
\DoxyCodeLine{62             \mbox{\hyperlink{class_thread_ac82782d05f278543bdcedf68ae9fd2cd}{Thread::setCurrentThreadName}} (\textcolor{stringliteral}{"{}JUCE Plugin Message Thread"{}});}
\DoxyCodeLine{63 }
\DoxyCodeLine{64             \mbox{\hyperlink{class_message_manager_a4367fa495f95a5562b58dde1ad0e965b}{MessageManager::getInstance}}()-\/>\mbox{\hyperlink{class_message_manager_af94f78debd3b3d70acade65f50c5058e}{setCurrentThreadAsMessageThread}}();}
\DoxyCodeLine{65             XWindowSystem::getInstance();}
\DoxyCodeLine{66 }
\DoxyCodeLine{67             threadInitialised.signal();}
\DoxyCodeLine{68 }
\DoxyCodeLine{69             \textcolor{keywordflow}{for} (;;)}
\DoxyCodeLine{70             \{}
\DoxyCodeLine{71                 \textcolor{keywordflow}{if} (! \mbox{\hyperlink{namespacejuce_aaecb4dafdf66ed7ca381c39e2ef40f1f}{dispatchNextMessageOnSystemQueue}} (\textcolor{keyword}{true}))}
\DoxyCodeLine{72                     \mbox{\hyperlink{class_thread_ace8d1c984cb6900b2b47912a69261bc4}{Thread::sleep}} (1);}
\DoxyCodeLine{73 }
\DoxyCodeLine{74                 \textcolor{keywordflow}{if} (shouldExit)}
\DoxyCodeLine{75                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{76             \}}
\DoxyCodeLine{77         \} \};}
\DoxyCodeLine{78 }
\DoxyCodeLine{79         threadInitialised.wait();}
\DoxyCodeLine{80     \}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     \textcolor{keywordtype}{void} stop()}
\DoxyCodeLine{83     \{}
\DoxyCodeLine{84         \textcolor{keywordflow}{if} (! isRunning())}
\DoxyCodeLine{85             \textcolor{keywordflow}{return};}
\DoxyCodeLine{86 }
\DoxyCodeLine{87         shouldExit = \textcolor{keyword}{true};}
\DoxyCodeLine{88         thread.join();}
\DoxyCodeLine{89     \}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{keywordtype}{bool} isRunning() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept  \{ \textcolor{keywordflow}{return} thread.joinable(); \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{keyword}{private}:}
\DoxyCodeLine{94     \mbox{\hyperlink{class_waitable_event}{WaitableEvent}} threadInitialised;}
\DoxyCodeLine{95     std::thread thread;}
\DoxyCodeLine{96 }
\DoxyCodeLine{97     std::atomic<bool> shouldExit \{ \textcolor{keyword}{false} \};}
\DoxyCodeLine{98 }
\DoxyCodeLine{99     \mbox{\hyperlink{group__juce__core-system_ga599c5e38096f3427fea328a9deb3fde7}{JUCE\_DECLARE\_NON\_MOVEABLE}} (MessageThread)}
\DoxyCodeLine{100     \mbox{\hyperlink{group__juce__core-system_ga851b02724a8158a7f746c66b5758b3dd}{JUCE\_DECLARE\_NON\_COPYABLE\_WITH\_LEAK\_DETECTOR}} (MessageThread)}
\DoxyCodeLine{101 \};}
\DoxyCodeLine{102 }
\DoxyCodeLine{103  \textcolor{comment}{// namespace juce}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{106 }

\end{DoxyCode}
