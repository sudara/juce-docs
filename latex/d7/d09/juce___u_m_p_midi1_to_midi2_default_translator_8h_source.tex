\hypertarget{juce___u_m_p_midi1_to_midi2_default_translator_8h_source}{}\doxysection{juce\+\_\+\+UMPMidi1\+To\+Midi2\+Default\+Translator.\+h}
\label{juce___u_m_p_midi1_to_midi2_default_translator_8h_source}\index{build/juce\_audio\_basics/midi/ump/juce\_UMPMidi1ToMidi2DefaultTranslator.h@{build/juce\_audio\_basics/midi/ump/juce\_UMPMidi1ToMidi2DefaultTranslator.h}}
\mbox{\hyperlink{juce___u_m_p_midi1_to_midi2_default_translator_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{5 \textcolor{comment}{/*}}
\DoxyCodeLine{6 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{7 \textcolor{comment}{}}
\DoxyCodeLine{8 \textcolor{comment}{   This file is part of the JUCE library.}}
\DoxyCodeLine{9 \textcolor{comment}{   Copyright (c) 2020 -\/ Raw Material Software Limited}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{   JUCE is an open source library subject to commercial or open-\/source}}
\DoxyCodeLine{12 \textcolor{comment}{   licensing.}}
\DoxyCodeLine{13 \textcolor{comment}{}}
\DoxyCodeLine{14 \textcolor{comment}{   The code included in this file is provided under the terms of the ISC license}}
\DoxyCodeLine{15 \textcolor{comment}{   http://www.isc.org/downloads/software-\/support-\/policy/isc-\/license. Permission}}
\DoxyCodeLine{16 \textcolor{comment}{   To use, copy, modify, and/or distribute this software for any purpose with or}}
\DoxyCodeLine{17 \textcolor{comment}{   without fee is hereby granted provided that the above copyright notice and}}
\DoxyCodeLine{18 \textcolor{comment}{   this permission notice appear in all copies.}}
\DoxyCodeLine{19 \textcolor{comment}{}}
\DoxyCodeLine{20 \textcolor{comment}{   JUCE IS PROVIDED "{}AS IS"{} WITHOUT ANY WARRANTY, AND ALL WARRANTIES, WHETHER}}
\DoxyCodeLine{21 \textcolor{comment}{   EXPRESSED OR IMPLIED, INCLUDING MERCHANTABILITY AND FITNESS FOR PURPOSE, ARE}}
\DoxyCodeLine{22 \textcolor{comment}{   DISCLAIMED.}}
\DoxyCodeLine{23 \textcolor{comment}{}}
\DoxyCodeLine{24 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{25 \textcolor{comment}{*/}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#ifndef DOXYGEN}}
\DoxyCodeLine{28 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceuniversal__midi__packets}{universal\_midi\_packets}}}
\DoxyCodeLine{29 \{}
\DoxyCodeLine{30 }
\DoxyCodeLine{37 \textcolor{keyword}{class }\mbox{\hyperlink{classuniversal__midi__packets_1_1_midi1_to_midi2_default_translator}{Midi1ToMidi2DefaultTranslator}}}
\DoxyCodeLine{38 \{}
\DoxyCodeLine{39 \textcolor{keyword}{public}:}
\DoxyCodeLine{40     \mbox{\hyperlink{classuniversal__midi__packets_1_1_midi1_to_midi2_default_translator_ad5b2e8d1aef3421de97f92cc1073d255}{Midi1ToMidi2DefaultTranslator}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{41 }
\DoxyCodeLine{51     \textcolor{keyword}{template} <\textcolor{keyword}{typename} PacketCallback>}
\DoxyCodeLine{52     \textcolor{keywordtype}{void} \mbox{\hyperlink{classuniversal__midi__packets_1_1_midi1_to_midi2_default_translator_a0415565a431040daf9f65d49aca0e448}{dispatch}} (\textcolor{keyword}{const} \mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}}\& \mbox{\hyperlink{namespacegl_a90222d5e414af4ac542dabf3b3097a7f}{v}}, PacketCallback\&\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}})}
\DoxyCodeLine{53     \{}
\DoxyCodeLine{54         \textcolor{keyword}{const} \textcolor{keyword}{auto} firstWord = \mbox{\hyperlink{namespacegl_a90222d5e414af4ac542dabf3b3097a7f}{v}}[0];}
\DoxyCodeLine{55         \textcolor{keyword}{const} \textcolor{keyword}{auto} messageType = \mbox{\hyperlink{structuniversal__midi__packets_1_1_utils_aa8f83c90a4548bcb1f078f0fad117fbc}{Utils::getMessageType}} (firstWord);}
\DoxyCodeLine{56 }
\DoxyCodeLine{57         \textcolor{keywordflow}{if} (messageType != 0x2)}
\DoxyCodeLine{58         \{}
\DoxyCodeLine{59             \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}} (\mbox{\hyperlink{namespacegl_a90222d5e414af4ac542dabf3b3097a7f}{v}});}
\DoxyCodeLine{60             \textcolor{keywordflow}{return};}
\DoxyCodeLine{61         \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63         \textcolor{keyword}{const} HelperValues helperValues}
\DoxyCodeLine{64         \{}
\DoxyCodeLine{65             (uint8\_t) ((0x4 << 0x4) | \mbox{\hyperlink{structuniversal__midi__packets_1_1_utils_af8301cd14206b11fde7a047b2aa612ff}{Utils::getGroup}} (firstWord)),}
\DoxyCodeLine{66             (uint8\_t) ((firstWord >> 0x10) \& 0xff),}
\DoxyCodeLine{67             (uint8\_t) ((firstWord >> 0x08) \& 0x7f),}
\DoxyCodeLine{68             (uint8\_t) ((firstWord >> 0x00) \& 0x7f),}
\DoxyCodeLine{69         \};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71         \textcolor{keywordflow}{switch} (\mbox{\hyperlink{structuniversal__midi__packets_1_1_utils_acd7746fa8dec805d039ed7c5f2f84ab7}{Utils::getStatus}} (firstWord))}
\DoxyCodeLine{72         \{}
\DoxyCodeLine{73             \textcolor{keywordflow}{case} 0x8:}
\DoxyCodeLine{74             \textcolor{keywordflow}{case} 0x9:}
\DoxyCodeLine{75             \{}
\DoxyCodeLine{76                 \textcolor{keyword}{const} \textcolor{keyword}{auto} packet = processNoteOnOrOff (helperValues);}
\DoxyCodeLine{77                 \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}} (\mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}} (packet.data()));}
\DoxyCodeLine{78                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{79             \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81             \textcolor{keywordflow}{case} 0xa:}
\DoxyCodeLine{82             \{}
\DoxyCodeLine{83                 \textcolor{keyword}{const} \textcolor{keyword}{auto} packet = processPolyPressure (helperValues);}
\DoxyCodeLine{84                 \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}} (\mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}} (packet.data()));}
\DoxyCodeLine{85                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{86             \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88             \textcolor{keywordflow}{case} 0xb:}
\DoxyCodeLine{89             \{}
\DoxyCodeLine{90                 \mbox{\hyperlink{classuniversal__midi__packets_1_1_packet}{PacketX2}} packet;}
\DoxyCodeLine{91 }
\DoxyCodeLine{92                 \textcolor{keywordflow}{if} (processControlChange (helperValues, packet))}
\DoxyCodeLine{93                     \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}} (\mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}} (packet.\mbox{\hyperlink{classuniversal__midi__packets_1_1_packet_afbe78b260379c6ac1edfbacc88415e72}{data}}()));}
\DoxyCodeLine{94 }
\DoxyCodeLine{95                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{96             \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98             \textcolor{keywordflow}{case} 0xc:}
\DoxyCodeLine{99             \{}
\DoxyCodeLine{100                 \textcolor{keyword}{const} \textcolor{keyword}{auto} packet = processProgramChange (helperValues);}
\DoxyCodeLine{101                 \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}} (\mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}} (packet.data()));}
\DoxyCodeLine{102                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{103             \}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105             \textcolor{keywordflow}{case} 0xd:}
\DoxyCodeLine{106             \{}
\DoxyCodeLine{107                 \textcolor{keyword}{const} \textcolor{keyword}{auto} packet = processChannelPressure (helperValues);}
\DoxyCodeLine{108                 \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}} (\mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}} (packet.data()));}
\DoxyCodeLine{109                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{110             \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112             \textcolor{keywordflow}{case} 0xe:}
\DoxyCodeLine{113             \{}
\DoxyCodeLine{114                 \textcolor{keyword}{const} \textcolor{keyword}{auto} packet = processPitchBend (helperValues);}
\DoxyCodeLine{115                 \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}} (\mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}} (packet.data()));}
\DoxyCodeLine{116                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{117             \}}
\DoxyCodeLine{118         \}}
\DoxyCodeLine{119     \}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{keywordtype}{void} \mbox{\hyperlink{classuniversal__midi__packets_1_1_midi1_to_midi2_default_translator_a016f92f0727315b0e9ae88813ff0382a}{reset}}()}
\DoxyCodeLine{122     \{}
\DoxyCodeLine{123         groupAccumulators = \{\};}
\DoxyCodeLine{124         groupBanks = \{\};}
\DoxyCodeLine{125     \}}
\DoxyCodeLine{126 }
\DoxyCodeLine{127 \textcolor{keyword}{private}:}
\DoxyCodeLine{128     \textcolor{keyword}{enum class} PnKind \{ nrpn, rpn \};}
\DoxyCodeLine{129 }
\DoxyCodeLine{130     \textcolor{keyword}{struct }HelperValues}
\DoxyCodeLine{131     \{}
\DoxyCodeLine{132         uint8\_t typeAndGroup;}
\DoxyCodeLine{133         uint8\_t byte0;}
\DoxyCodeLine{134         uint8\_t byte1;}
\DoxyCodeLine{135         uint8\_t byte2;}
\DoxyCodeLine{136     \};}
\DoxyCodeLine{137 }
\DoxyCodeLine{138     \textcolor{keyword}{static} \mbox{\hyperlink{namespaceuniversal__midi__packets_aaed1d831a4a30fb100391efde3aae458}{PacketX2}} processNoteOnOrOff (\textcolor{keyword}{const} HelperValues helpers);}
\DoxyCodeLine{139     \textcolor{keyword}{static} \mbox{\hyperlink{namespaceuniversal__midi__packets_aaed1d831a4a30fb100391efde3aae458}{PacketX2}} processPolyPressure (\textcolor{keyword}{const} HelperValues helpers);}
\DoxyCodeLine{140 }
\DoxyCodeLine{141     \textcolor{keywordtype}{bool} processControlChange (\textcolor{keyword}{const} HelperValues helpers, \mbox{\hyperlink{namespaceuniversal__midi__packets_aaed1d831a4a30fb100391efde3aae458}{PacketX2}}\& packet);}
\DoxyCodeLine{142 }
\DoxyCodeLine{143     \mbox{\hyperlink{namespaceuniversal__midi__packets_aaed1d831a4a30fb100391efde3aae458}{PacketX2}} processProgramChange (\textcolor{keyword}{const} HelperValues helpers) \textcolor{keyword}{const};}
\DoxyCodeLine{144 }
\DoxyCodeLine{145     \textcolor{keyword}{static} \mbox{\hyperlink{namespaceuniversal__midi__packets_aaed1d831a4a30fb100391efde3aae458}{PacketX2}} processChannelPressure (\textcolor{keyword}{const} HelperValues helpers);}
\DoxyCodeLine{146     \textcolor{keyword}{static} \mbox{\hyperlink{namespaceuniversal__midi__packets_aaed1d831a4a30fb100391efde3aae458}{PacketX2}} processPitchBend (\textcolor{keyword}{const} HelperValues helpers);}
\DoxyCodeLine{147 }
\DoxyCodeLine{148     \textcolor{keyword}{class }PnAccumulator}
\DoxyCodeLine{149     \{}
\DoxyCodeLine{150     \textcolor{keyword}{public}:}
\DoxyCodeLine{151         \textcolor{keywordtype}{bool} addByte (uint8\_t cc, uint8\_t \textcolor{keywordtype}{byte});}
\DoxyCodeLine{152 }
\DoxyCodeLine{153         \textcolor{keyword}{const} std::array<uint8\_t, 4>\& getBytes() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} bytes; \}}
\DoxyCodeLine{154         PnKind getKind() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} kind; \}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156     \textcolor{keyword}{private}:}
\DoxyCodeLine{157         std::array<uint8\_t, 4> bytes;}
\DoxyCodeLine{158         uint8\_t \mbox{\hyperlink{namespacegl_a06a196a98fd7b17e699cbea6c66c37cb}{index}} = 0;}
\DoxyCodeLine{159         PnKind kind = PnKind::nrpn;}
\DoxyCodeLine{160     \};}
\DoxyCodeLine{161 }
\DoxyCodeLine{162     \textcolor{keyword}{class }Bank}
\DoxyCodeLine{163     \{}
\DoxyCodeLine{164     \textcolor{keyword}{public}:}
\DoxyCodeLine{165         \textcolor{keywordtype}{bool} isValid() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} ! (msb \& 0x80); \}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167         uint8\_t getMsb() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} msb \& 0x7f; \}}
\DoxyCodeLine{168         uint8\_t getLsb() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} lsb \& 0x7f; \}}
\DoxyCodeLine{169 }
\DoxyCodeLine{170         \textcolor{keywordtype}{void} setMsb (uint8\_t i) \textcolor{keyword}{noexcept} \{ msb = i \& 0x7f; \}}
\DoxyCodeLine{171         \textcolor{keywordtype}{void} setLsb (uint8\_t i) \textcolor{keyword}{noexcept} \{ msb \&= 0x7f; lsb = i \& 0x7f; \}}
\DoxyCodeLine{172 }
\DoxyCodeLine{173     \textcolor{keyword}{private}:}
\DoxyCodeLine{174         \textcolor{comment}{// We use the top bit to indicate whether this bank is valid.}}
\DoxyCodeLine{175         \textcolor{comment}{// After reading the spec, it's not clear how we should determine whether}}
\DoxyCodeLine{176         \textcolor{comment}{// there are valid values, so we'll just assume that the bank is valid}}
\DoxyCodeLine{177         \textcolor{comment}{// once either the lsb or msb have been written.}}
\DoxyCodeLine{178         uint8\_t msb = 0x80;}
\DoxyCodeLine{179         uint8\_t lsb = 0x00;}
\DoxyCodeLine{180     \};}
\DoxyCodeLine{181 }
\DoxyCodeLine{182     \textcolor{keyword}{using} ChannelAccumulators = std::array<PnAccumulator, 16>;}
\DoxyCodeLine{183     std::array<ChannelAccumulators, 16> groupAccumulators;}
\DoxyCodeLine{184 }
\DoxyCodeLine{185     \textcolor{keyword}{using} ChannelBanks = std::array<Bank, 16>;}
\DoxyCodeLine{186     std::array<ChannelBanks, 16> groupBanks;}
\DoxyCodeLine{187 \};}
\DoxyCodeLine{188 }
\DoxyCodeLine{189 \}}
\DoxyCodeLine{190 }
\DoxyCodeLine{191 }
\DoxyCodeLine{192 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{193 }

\end{DoxyCode}
