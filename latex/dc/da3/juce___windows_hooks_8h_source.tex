\hypertarget{juce___windows_hooks_8h_source}{}\doxysection{juce\+\_\+\+Windows\+Hooks.\+h}
\label{juce___windows_hooks_8h_source}\index{build/juce\_audio\_plugin\_client/utility/juce\_WindowsHooks.h@{build/juce\_audio\_plugin\_client/utility/juce\_WindowsHooks.h}}
\mbox{\hyperlink{juce___windows_hooks_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{5 \textcolor{comment}{/*}}
\DoxyCodeLine{6 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{7 \textcolor{comment}{}}
\DoxyCodeLine{8 \textcolor{comment}{   This file is part of the JUCE library.}}
\DoxyCodeLine{9 \textcolor{comment}{   Copyright (c) 2020 -\/ Raw Material Software Limited}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{   JUCE is an open source library subject to commercial or open-\/source}}
\DoxyCodeLine{12 \textcolor{comment}{   licensing.}}
\DoxyCodeLine{13 \textcolor{comment}{}}
\DoxyCodeLine{14 \textcolor{comment}{   By using JUCE, you agree to the terms of both the JUCE 6 End-\/User License}}
\DoxyCodeLine{15 \textcolor{comment}{   Agreement and JUCE Privacy Policy (both effective as of the 16th June 2020).}}
\DoxyCodeLine{16 \textcolor{comment}{}}
\DoxyCodeLine{17 \textcolor{comment}{   End User License Agreement: www.juce.com/juce-\/6-\/licence}}
\DoxyCodeLine{18 \textcolor{comment}{   Privacy Policy: www.juce.com/juce-\/privacy-\/policy}}
\DoxyCodeLine{19 \textcolor{comment}{}}
\DoxyCodeLine{20 \textcolor{comment}{   Or: You may also use this code under the terms of the GPL v3 (see}}
\DoxyCodeLine{21 \textcolor{comment}{   www.gnu.org/licenses).}}
\DoxyCodeLine{22 \textcolor{comment}{}}
\DoxyCodeLine{23 \textcolor{comment}{   JUCE IS PROVIDED "{}AS IS"{} WITHOUT ANY WARRANTY, AND ALL WARRANTIES, WHETHER}}
\DoxyCodeLine{24 \textcolor{comment}{   EXPRESSED OR IMPLIED, INCLUDING MERCHANTABILITY AND FITNESS FOR PURPOSE, ARE}}
\DoxyCodeLine{25 \textcolor{comment}{   DISCLAIMED.}}
\DoxyCodeLine{26 \textcolor{comment}{}}
\DoxyCodeLine{27 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{28 \textcolor{comment}{*/}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#if JUCE\_WINDOWS}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{comment}{// This function is in juce\_win32\_Windowing.cpp}}
\DoxyCodeLine{33 \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespacejuce_a1f0a2f59b98344c19d5703b34838a2a6}{offerKeyMessageToJUCEWindow}} (MSG\&);}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{keyword}{static} HHOOK mouseWheelHook = \textcolor{keyword}{nullptr}, keyboardHook = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{36 \textcolor{keyword}{static} \textcolor{keywordtype}{int} numHookUsers = 0;}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{keyword}{struct }WindowsHooks}
\DoxyCodeLine{39 \{}
\DoxyCodeLine{40     WindowsHooks()}
\DoxyCodeLine{41     \{}
\DoxyCodeLine{42         \textcolor{keywordflow}{if} (numHookUsers++ == 0)}
\DoxyCodeLine{43         \{}
\DoxyCodeLine{44             mouseWheelHook = SetWindowsHookEx (WH\_MOUSE, mouseWheelHookCallback,}
\DoxyCodeLine{45                                                (HINSTANCE) juce::Process::getCurrentModuleInstanceHandle(),}
\DoxyCodeLine{46                                                GetCurrentThreadId());}
\DoxyCodeLine{47 }
\DoxyCodeLine{48             keyboardHook = SetWindowsHookEx (WH\_GETMESSAGE, keyboardHookCallback,}
\DoxyCodeLine{49                                              (HINSTANCE) juce::Process::getCurrentModuleInstanceHandle(),}
\DoxyCodeLine{50                                              GetCurrentThreadId());}
\DoxyCodeLine{51         \}}
\DoxyCodeLine{52     \}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54     \string~WindowsHooks()}
\DoxyCodeLine{55     \{}
\DoxyCodeLine{56         \textcolor{keywordflow}{if} (-\/-\/numHookUsers == 0)}
\DoxyCodeLine{57         \{}
\DoxyCodeLine{58             \textcolor{keywordflow}{if} (mouseWheelHook != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{59             \{}
\DoxyCodeLine{60                 UnhookWindowsHookEx (mouseWheelHook);}
\DoxyCodeLine{61                 mouseWheelHook = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{62             \}}
\DoxyCodeLine{63 }
\DoxyCodeLine{64             \textcolor{keywordflow}{if} (keyboardHook != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{65             \{}
\DoxyCodeLine{66                 UnhookWindowsHookEx (keyboardHook);}
\DoxyCodeLine{67                 keyboardHook = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{68             \}}
\DoxyCodeLine{69         \}}
\DoxyCodeLine{70     \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     \textcolor{keyword}{static} LRESULT CALLBACK mouseWheelHookCallback (\textcolor{keywordtype}{int} nCode, WPARAM wParam, LPARAM lParam)}
\DoxyCodeLine{73     \{}
\DoxyCodeLine{74         \textcolor{keywordflow}{if} (nCode >= 0 \&\& wParam == WM\_MOUSEWHEEL)}
\DoxyCodeLine{75         \{}
\DoxyCodeLine{76             \textcolor{comment}{// using a local copy of this struct to support old mingw libraries}}
\DoxyCodeLine{77             \textcolor{keyword}{struct }MOUSEHOOKSTRUCTEX\_  : \textcolor{keyword}{public} MOUSEHOOKSTRUCT  \{ DWORD mouseData; \};}
\DoxyCodeLine{78 }
\DoxyCodeLine{79             \textcolor{keyword}{auto}\& hs = *(MOUSEHOOKSTRUCTEX\_*) lParam;}
\DoxyCodeLine{80 }
\DoxyCodeLine{81             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* comp = \mbox{\hyperlink{class_desktop_aedeca95ef32376027263bd39c693eeda}{Desktop::getInstance}}().\mbox{\hyperlink{class_desktop_a60f4a595660beaa9a70581ddd28c19d3}{findComponentAt}} (\{ hs.pt.x, hs.pt.y \}))}
\DoxyCodeLine{82                 \textcolor{keywordflow}{if} (comp-\/>getWindowHandle() != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{83                     \textcolor{keywordflow}{return} PostMessage ((\mbox{\hyperlink{namespacejuce_a1b3c3cf7cdbe394e401d5db42e094ac5}{HWND}}) comp-\/>getWindowHandle(), WM\_MOUSEWHEEL,}
\DoxyCodeLine{84                                         hs.mouseData \& 0xffff0000, (hs.pt.x \& 0xffff) | (hs.pt.y << 16));}
\DoxyCodeLine{85         \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87         \textcolor{keywordflow}{return} CallNextHookEx (mouseWheelHook, nCode, wParam, lParam);}
\DoxyCodeLine{88     \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90     \textcolor{keyword}{static} LRESULT CALLBACK keyboardHookCallback (\textcolor{keywordtype}{int} nCode, WPARAM wParam, LPARAM lParam)}
\DoxyCodeLine{91     \{}
\DoxyCodeLine{92         MSG\& msg = *(MSG*) lParam;}
\DoxyCodeLine{93 }
\DoxyCodeLine{94         \textcolor{keywordflow}{if} (nCode == HC\_ACTION \&\& wParam == PM\_REMOVE}
\DoxyCodeLine{95              \&\& \mbox{\hyperlink{namespacejuce_a1f0a2f59b98344c19d5703b34838a2a6}{offerKeyMessageToJUCEWindow}} (msg))}
\DoxyCodeLine{96         \{}
\DoxyCodeLine{97             \mbox{\hyperlink{group__juce__core-memory_ga1f3dbe374ad9280ed9ba72f510d8e5b0}{zerostruct}} (msg);}
\DoxyCodeLine{98             msg.message = WM\_USER;}
\DoxyCodeLine{99             \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{100         \}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102         \textcolor{keywordflow}{return} CallNextHookEx (keyboardHook, nCode, wParam, lParam);}
\DoxyCodeLine{103     \}}
\DoxyCodeLine{104 \};}
\DoxyCodeLine{105 }
\DoxyCodeLine{106  \textcolor{comment}{// namespace juce}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{109 }

\end{DoxyCode}
