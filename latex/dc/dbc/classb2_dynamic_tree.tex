\hypertarget{classb2_dynamic_tree}{}\doxysection{b2\+Dynamic\+Tree Class Reference}
\label{classb2_dynamic_tree}\index{b2DynamicTree@{b2DynamicTree}}


{\ttfamily \#include $<$b2\+Dynamic\+Tree.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classb2_dynamic_tree_a8af64cf6a1566fa4c5b5c9683bd937d9}{b2\+Dynamic\+Tree}} ()
\begin{DoxyCompactList}\small\item\em Constructing the tree initializes the node pool. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classb2_dynamic_tree_a9060565fc63b4dd87d9560775c076786}{$\sim$b2\+Dynamic\+Tree}} ()
\begin{DoxyCompactList}\small\item\em Destroy the tree, freeing the node pool. \end{DoxyCompactList}\item 
\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}} \mbox{\hyperlink{classb2_dynamic_tree_ae44676f12977dada46037da47fc7ffbf}{Create\+Proxy}} (\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_a_a_b_b}{b2\+AABB}} \&aabb, \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} $\ast$user\+Data)
\begin{DoxyCompactList}\small\item\em Create a proxy. Provide a tight fitting AABB and a user\+Data pointer. \end{DoxyCompactList}\item 
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{classb2_dynamic_tree_aa06a007b97f6d351f5eab3cd4daf0291}{Destroy\+Proxy}} (\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}} proxy\+Id)
\begin{DoxyCompactList}\small\item\em Destroy a proxy. This asserts if the id is invalid. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classb2_dynamic_tree_a9b78c4a3fd3a255be96d08422d7be580}{Move\+Proxy}} (\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}} proxy\+Id, \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_a_a_b_b}{b2\+AABB}} \&aabb1, \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_vec2}{b2\+Vec2}} \&displacement)
\item 
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} $\ast$ \mbox{\hyperlink{classb2_dynamic_tree_a87a0af38e156b5fefb94b38472918a1e}{Get\+User\+Data}} (\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}} proxy\+Id) \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}}
\item 
\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_a_a_b_b}{b2\+AABB}} \& \mbox{\hyperlink{classb2_dynamic_tree_ae7f0f4489966ee6a5502d595ca21ce74}{Get\+Fat\+AABB}} (\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}} proxy\+Id) \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}}
\begin{DoxyCompactList}\small\item\em Get the fat AABB for a proxy. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{classb2_dynamic_tree_a324df3eb65dfc22d3dcdca387737b193}{Query}} (T $\ast$\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}}, \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_a_a_b_b}{b2\+AABB}} \&aabb) \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}}
\item 
{\footnotesize template$<$typename T $>$ }\\\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{classb2_dynamic_tree_aebd2dc6ee462e0cd0763a5f472243a13}{Ray\+Cast}} (T $\ast$\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}}, \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_ray_cast_input}{b2\+Ray\+Cast\+Input}} \&input) \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}}
\item 
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{classb2_dynamic_tree_ae9b989f0c04e38f9c940623d4e1728b9}{Validate}} () \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}}
\begin{DoxyCompactList}\small\item\em Validate this tree. For testing. \end{DoxyCompactList}\item 
\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}} \mbox{\hyperlink{classb2_dynamic_tree_ae3c7dc771d596f1f95fd3a3d7f2f3e97}{Get\+Height}} () \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}}
\item 
\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}} \mbox{\hyperlink{classb2_dynamic_tree_a3feab170229e0acd17f6a4ad3fca406e}{Get\+Max\+Balance}} () \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}}
\item 
\mbox{\hyperlink{b2_settings_8h_aacdc525d6f7bddb3ae95d5c311bd06a1}{float32}} \mbox{\hyperlink{classb2_dynamic_tree_a87da9819c4f190faec38f7fe4608caae}{Get\+Area\+Ratio}} () \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}}
\begin{DoxyCompactList}\small\item\em Get the ratio of the sum of the node areas to the root area. \end{DoxyCompactList}\item 
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} \mbox{\hyperlink{classb2_dynamic_tree_abd146017cfec1cf5ea7b87331f30a3ff}{Rebuild\+Bottom\+Up}} ()
\begin{DoxyCompactList}\small\item\em Build an optimal tree. Very expensive. For testing. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A dynamic AABB tree broad-\/phase, inspired by Nathanael Presson\textquotesingle{}s bt\+Dbvt. A dynamic tree arranges data in a binary tree to accelerate queries such as volume queries and ray casts. Leafs are proxies with an AABB. In the tree we expand the proxy AABB by b2\+\_\+fat\+AABBFactor so that the proxy AABB is bigger than the client object. This allows the client object to move by small amounts without triggering a tree update.

Nodes are pooled and relocatable, so we use node indices rather than pointers. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classb2_dynamic_tree_a8af64cf6a1566fa4c5b5c9683bd937d9}\label{classb2_dynamic_tree_a8af64cf6a1566fa4c5b5c9683bd937d9}} 
\index{b2DynamicTree@{b2DynamicTree}!b2DynamicTree@{b2DynamicTree}}
\index{b2DynamicTree@{b2DynamicTree}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{b2DynamicTree()}{b2DynamicTree()}}
{\footnotesize\ttfamily b2\+Dynamic\+Tree\+::b2\+Dynamic\+Tree (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Constructing the tree initializes the node pool. 

\mbox{\Hypertarget{classb2_dynamic_tree_a9060565fc63b4dd87d9560775c076786}\label{classb2_dynamic_tree_a9060565fc63b4dd87d9560775c076786}} 
\index{b2DynamicTree@{b2DynamicTree}!````~b2DynamicTree@{$\sim$b2DynamicTree}}
\index{````~b2DynamicTree@{$\sim$b2DynamicTree}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{$\sim$b2DynamicTree()}{~b2DynamicTree()}}
{\footnotesize\ttfamily b2\+Dynamic\+Tree\+::$\sim$b2\+Dynamic\+Tree (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Destroy the tree, freeing the node pool. 



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classb2_dynamic_tree_ae44676f12977dada46037da47fc7ffbf}\label{classb2_dynamic_tree_ae44676f12977dada46037da47fc7ffbf}} 
\index{b2DynamicTree@{b2DynamicTree}!CreateProxy@{CreateProxy}}
\index{CreateProxy@{CreateProxy}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{CreateProxy()}{CreateProxy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{juce__box2d_8cpp_a6a5a8e94340b94579afb83ab477a983c}{int32}} b2\+Dynamic\+Tree\+::\+Create\+Proxy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_a_a_b_b}{b2\+AABB}} \&}]{aabb,  }\item[{\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} $\ast$}]{user\+Data }\end{DoxyParamCaption})}



Create a proxy. Provide a tight fitting AABB and a user\+Data pointer. 

\mbox{\Hypertarget{classb2_dynamic_tree_aa06a007b97f6d351f5eab3cd4daf0291}\label{classb2_dynamic_tree_aa06a007b97f6d351f5eab3cd4daf0291}} 
\index{b2DynamicTree@{b2DynamicTree}!DestroyProxy@{DestroyProxy}}
\index{DestroyProxy@{DestroyProxy}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{DestroyProxy()}{DestroyProxy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} b2\+Dynamic\+Tree\+::\+Destroy\+Proxy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}}}]{proxy\+Id }\end{DoxyParamCaption})}



Destroy a proxy. This asserts if the id is invalid. 

\mbox{\Hypertarget{classb2_dynamic_tree_a87da9819c4f190faec38f7fe4608caae}\label{classb2_dynamic_tree_a87da9819c4f190faec38f7fe4608caae}} 
\index{b2DynamicTree@{b2DynamicTree}!GetAreaRatio@{GetAreaRatio}}
\index{GetAreaRatio@{GetAreaRatio}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{GetAreaRatio()}{GetAreaRatio()}}
{\footnotesize\ttfamily \mbox{\hyperlink{b2_settings_8h_aacdc525d6f7bddb3ae95d5c311bd06a1}{float32}} b2\+Dynamic\+Tree\+::\+Get\+Area\+Ratio (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Get the ratio of the sum of the node areas to the root area. 

\mbox{\Hypertarget{classb2_dynamic_tree_ae7f0f4489966ee6a5502d595ca21ce74}\label{classb2_dynamic_tree_ae7f0f4489966ee6a5502d595ca21ce74}} 
\index{b2DynamicTree@{b2DynamicTree}!GetFatAABB@{GetFatAABB}}
\index{GetFatAABB@{GetFatAABB}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{GetFatAABB()}{GetFatAABB()}}
{\footnotesize\ttfamily \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_a_a_b_b}{b2\+AABB}} \& b2\+Dynamic\+Tree\+::\+Get\+Fat\+AABB (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}}}]{proxy\+Id }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the fat AABB for a proxy. 

\mbox{\Hypertarget{classb2_dynamic_tree_ae3c7dc771d596f1f95fd3a3d7f2f3e97}\label{classb2_dynamic_tree_ae3c7dc771d596f1f95fd3a3d7f2f3e97}} 
\index{b2DynamicTree@{b2DynamicTree}!GetHeight@{GetHeight}}
\index{GetHeight@{GetHeight}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{GetHeight()}{GetHeight()}}
{\footnotesize\ttfamily \mbox{\hyperlink{juce__box2d_8cpp_a6a5a8e94340b94579afb83ab477a983c}{int32}} b2\+Dynamic\+Tree\+::\+Get\+Height (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Compute the height of the binary tree in O(\+N) time. Should not be called often. \mbox{\Hypertarget{classb2_dynamic_tree_a3feab170229e0acd17f6a4ad3fca406e}\label{classb2_dynamic_tree_a3feab170229e0acd17f6a4ad3fca406e}} 
\index{b2DynamicTree@{b2DynamicTree}!GetMaxBalance@{GetMaxBalance}}
\index{GetMaxBalance@{GetMaxBalance}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{GetMaxBalance()}{GetMaxBalance()}}
{\footnotesize\ttfamily \mbox{\hyperlink{juce__box2d_8cpp_a6a5a8e94340b94579afb83ab477a983c}{int32}} b2\+Dynamic\+Tree\+::\+Get\+Max\+Balance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Get the maximum balance of an node in the tree. The balance is the difference in height of the two children of a node. \mbox{\Hypertarget{classb2_dynamic_tree_a87a0af38e156b5fefb94b38472918a1e}\label{classb2_dynamic_tree_a87a0af38e156b5fefb94b38472918a1e}} 
\index{b2DynamicTree@{b2DynamicTree}!GetUserData@{GetUserData}}
\index{GetUserData@{GetUserData}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{GetUserData()}{GetUserData()}}
{\footnotesize\ttfamily \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} $\ast$ b2\+Dynamic\+Tree\+::\+Get\+User\+Data (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}}}]{proxy\+Id }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get proxy user data. \begin{DoxyReturn}{Returns}
the proxy user data or 0 if the id is invalid. 
\end{DoxyReturn}
\mbox{\Hypertarget{classb2_dynamic_tree_a9b78c4a3fd3a255be96d08422d7be580}\label{classb2_dynamic_tree_a9b78c4a3fd3a255be96d08422d7be580}} 
\index{b2DynamicTree@{b2DynamicTree}!MoveProxy@{MoveProxy}}
\index{MoveProxy@{MoveProxy}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{MoveProxy()}{MoveProxy()}}
{\footnotesize\ttfamily bool b2\+Dynamic\+Tree\+::\+Move\+Proxy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__juce__core-maths_ga9a46025711a83f0e8339c6cb2eda8426}{juce\+::int32}}}]{proxy\+Id,  }\item[{\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_a_a_b_b}{b2\+AABB}} \&}]{aabb1,  }\item[{\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_vec2}{b2\+Vec2}} \&}]{displacement }\end{DoxyParamCaption})}

Move a proxy with a swepted AABB. If the proxy has moved outside of its fattened AABB, then the proxy is removed from the tree and re-\/inserted. Otherwise the function returns immediately. \begin{DoxyReturn}{Returns}
true if the proxy was re-\/inserted. 
\end{DoxyReturn}
\mbox{\Hypertarget{classb2_dynamic_tree_a324df3eb65dfc22d3dcdca387737b193}\label{classb2_dynamic_tree_a324df3eb65dfc22d3dcdca387737b193}} 
\index{b2DynamicTree@{b2DynamicTree}!Query@{Query}}
\index{Query@{Query}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{Query()}{Query()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} b2\+Dynamic\+Tree\+::\+Query (\begin{DoxyParamCaption}\item[{T $\ast$}]{callback,  }\item[{\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_a_a_b_b}{b2\+AABB}} \&}]{aabb }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Query an AABB for overlapping proxies. The callback class is called for each proxy that overlaps the supplied AABB. \mbox{\Hypertarget{classb2_dynamic_tree_aebd2dc6ee462e0cd0763a5f472243a13}\label{classb2_dynamic_tree_aebd2dc6ee462e0cd0763a5f472243a13}} 
\index{b2DynamicTree@{b2DynamicTree}!RayCast@{RayCast}}
\index{RayCast@{RayCast}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{RayCast()}{RayCast()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} b2\+Dynamic\+Tree\+::\+Ray\+Cast (\begin{DoxyParamCaption}\item[{T $\ast$}]{callback,  }\item[{\mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{structb2_ray_cast_input}{b2\+Ray\+Cast\+Input}} \&}]{input }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Ray-\/cast against the proxies in the tree. This relies on the callback to perform a exact ray-\/cast in the case were the proxy contains a shape. The callback also performs the any collision filtering. This has performance roughly equal to k $\ast$ log(n), where k is the number of collisions and n is the number of proxies in the tree. 
\begin{DoxyParams}{Parameters}
{\em input} & the ray-\/cast input data. The ray extends from p1 to p1 + max\+Fraction $\ast$ (p2 -\/ p1). \\
\hline
{\em callback} & a callback class that is called for each proxy that is hit by the ray. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classb2_dynamic_tree_abd146017cfec1cf5ea7b87331f30a3ff}\label{classb2_dynamic_tree_abd146017cfec1cf5ea7b87331f30a3ff}} 
\index{b2DynamicTree@{b2DynamicTree}!RebuildBottomUp@{RebuildBottomUp}}
\index{RebuildBottomUp@{RebuildBottomUp}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{RebuildBottomUp()}{RebuildBottomUp()}}
{\footnotesize\ttfamily \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} b2\+Dynamic\+Tree\+::\+Rebuild\+Bottom\+Up (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Build an optimal tree. Very expensive. For testing. 

\mbox{\Hypertarget{classb2_dynamic_tree_ae9b989f0c04e38f9c940623d4e1728b9}\label{classb2_dynamic_tree_ae9b989f0c04e38f9c940623d4e1728b9}} 
\index{b2DynamicTree@{b2DynamicTree}!Validate@{Validate}}
\index{Validate@{Validate}!b2DynamicTree@{b2DynamicTree}}
\doxysubsubsection{\texorpdfstring{Validate()}{Validate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} b2\+Dynamic\+Tree\+::\+Validate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Validate this tree. For testing. 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
build/juce\+\_\+box2d/box2d/\+Collision/\mbox{\hyperlink{b2_dynamic_tree_8h}{b2\+Dynamic\+Tree.\+h}}\item 
build/juce\+\_\+box2d/box2d/\+Collision/\mbox{\hyperlink{b2_dynamic_tree_8cpp}{b2\+Dynamic\+Tree.\+cpp}}\end{DoxyCompactItemize}
