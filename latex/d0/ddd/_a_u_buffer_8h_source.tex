\hypertarget{_a_u_buffer_8h_source}{}\doxysection{AUBuffer.\+h}
\label{_a_u_buffer_8h_source}\index{build/juce\_audio\_plugin\_client/AU/CoreAudioUtilityClasses/AUBuffer.h@{build/juce\_audio\_plugin\_client/AU/CoreAudioUtilityClasses/AUBuffer.h}}
\mbox{\hyperlink{_a_u_buffer_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{     File: AUBuffer.h}}
\DoxyCodeLine{3 \textcolor{comment}{ Abstract: Part of CoreAudio Utility Classes}}
\DoxyCodeLine{4 \textcolor{comment}{  Version: 1.1}}
\DoxyCodeLine{5 \textcolor{comment}{}}
\DoxyCodeLine{6 \textcolor{comment}{ Disclaimer: IMPORTANT:  This Apple software is supplied to you by Apple}}
\DoxyCodeLine{7 \textcolor{comment}{ Inc. ("{}Apple"{}) in consideration of your agreement to the following}}
\DoxyCodeLine{8 \textcolor{comment}{ terms, and your use, installation, modification or redistribution of}}
\DoxyCodeLine{9 \textcolor{comment}{ this Apple software constitutes acceptance of these terms.  If you do}}
\DoxyCodeLine{10 \textcolor{comment}{ not agree with these terms, please do not use, install, modify or}}
\DoxyCodeLine{11 \textcolor{comment}{ redistribute this Apple software.}}
\DoxyCodeLine{12 \textcolor{comment}{}}
\DoxyCodeLine{13 \textcolor{comment}{ In consideration of your agreement to abide by the following terms, and}}
\DoxyCodeLine{14 \textcolor{comment}{ subject to these terms, Apple grants you a personal, non-\/exclusive}}
\DoxyCodeLine{15 \textcolor{comment}{ license, under Apple's copyrights in this original Apple software (the}}
\DoxyCodeLine{16 \textcolor{comment}{ "{}Apple Software"{}), to use, reproduce, modify and redistribute the Apple}}
\DoxyCodeLine{17 \textcolor{comment}{ Software, with or without modifications, in source and/or binary forms;}}
\DoxyCodeLine{18 \textcolor{comment}{ provided that if you redistribute the Apple Software in its entirety and}}
\DoxyCodeLine{19 \textcolor{comment}{ without modifications, you must retain this notice and the following}}
\DoxyCodeLine{20 \textcolor{comment}{ text and disclaimers in all such redistributions of the Apple Software.}}
\DoxyCodeLine{21 \textcolor{comment}{ Neither the name, trademarks, service marks or logos of Apple Inc. may}}
\DoxyCodeLine{22 \textcolor{comment}{ be used to endorse or promote products derived from the Apple Software}}
\DoxyCodeLine{23 \textcolor{comment}{ without specific prior written permission from Apple.  Except as}}
\DoxyCodeLine{24 \textcolor{comment}{ expressly stated in this notice, no other rights or licenses, express or}}
\DoxyCodeLine{25 \textcolor{comment}{ implied, are granted by Apple herein, including but not limited to any}}
\DoxyCodeLine{26 \textcolor{comment}{ patent rights that may be infringed by your derivative works or by other}}
\DoxyCodeLine{27 \textcolor{comment}{ works in which the Apple Software may be incorporated.}}
\DoxyCodeLine{28 \textcolor{comment}{}}
\DoxyCodeLine{29 \textcolor{comment}{ The Apple Software is provided by Apple on an "{}AS IS"{} basis.  APPLE}}
\DoxyCodeLine{30 \textcolor{comment}{ MAKES NO WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION}}
\DoxyCodeLine{31 \textcolor{comment}{ THE IMPLIED WARRANTIES OF NON-\/INFRINGEMENT, MERCHANTABILITY AND FITNESS}}
\DoxyCodeLine{32 \textcolor{comment}{ FOR A PARTICULAR PURPOSE, REGARDING THE APPLE SOFTWARE OR ITS USE AND}}
\DoxyCodeLine{33 \textcolor{comment}{ OPERATION ALONE OR IN COMBINATION WITH YOUR PRODUCTS.}}
\DoxyCodeLine{34 \textcolor{comment}{}}
\DoxyCodeLine{35 \textcolor{comment}{ IN NO EVENT SHALL APPLE BE LIABLE FOR ANY SPECIAL, INDIRECT, INCIDENTAL}}
\DoxyCodeLine{36 \textcolor{comment}{ OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF}}
\DoxyCodeLine{37 \textcolor{comment}{ SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS}}
\DoxyCodeLine{38 \textcolor{comment}{ INTERRUPTION) ARISING IN ANY WAY OUT OF THE USE, REPRODUCTION,}}
\DoxyCodeLine{39 \textcolor{comment}{ MODIFICATION AND/OR DISTRIBUTION OF THE APPLE SOFTWARE, HOWEVER CAUSED}}
\DoxyCodeLine{40 \textcolor{comment}{ AND WHETHER UNDER THEORY OF CONTRACT, TORT (INCLUDING NEGLIGENCE),}}
\DoxyCodeLine{41 \textcolor{comment}{ STRICT LIABILITY OR OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF THE}}
\DoxyCodeLine{42 \textcolor{comment}{ POSSIBILITY OF SUCH DAMAGE.}}
\DoxyCodeLine{43 \textcolor{comment}{}}
\DoxyCodeLine{44 \textcolor{comment}{ Copyright (C) 2014 Apple Inc. All Rights Reserved.}}
\DoxyCodeLine{45 \textcolor{comment}{}}
\DoxyCodeLine{46 \textcolor{comment}{*/}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#ifndef \_\_AUBuffer\_h\_\_}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#define \_\_AUBuffer\_h\_\_}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{preprocessor}{\#include <TargetConditionals.h>}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#if !defined(\_\_COREAUDIO\_USE\_FLAT\_INCLUDES\_\_)}}
\DoxyCodeLine{52 \textcolor{preprocessor}{    \#include <AudioUnit/AudioUnit.h>}}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{54 \textcolor{preprocessor}{    \#include <AudioUnit.h>}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{58 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_c_a_stream_basic_description_8h}{CAStreamBasicDescription.h}}"{}}}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_c_a_auto_disposer_8h}{CAAutoDisposer.h}}"{}}}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_c_a_debug_macros_8h}{CADebugMacros.h}}"{}}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{comment}{// make this usable outside the stricter context of AudiUnits}}
\DoxyCodeLine{63 \textcolor{preprocessor}{\#ifndef COMPONENT\_THROW}}
\DoxyCodeLine{64 \textcolor{preprocessor}{    \#define COMPONENT\_THROW(err) \(\backslash\)}}
\DoxyCodeLine{65 \textcolor{preprocessor}{        do \{ DebugMessage(\#err); throw static\_cast<OSStatus>(err); \} while (0)}}
\DoxyCodeLine{66 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 }
\DoxyCodeLine{70 \textcolor{keyword}{class }\mbox{\hyperlink{class_a_u_buffer_list}{AUBufferList}} \{}
\DoxyCodeLine{71     \textcolor{keyword}{enum} EPtrState \{}
\DoxyCodeLine{72         kPtrsInvalid,}
\DoxyCodeLine{73         kPtrsToMyMemory,}
\DoxyCodeLine{74         kPtrsToExternalMemory}
\DoxyCodeLine{75     \};}
\DoxyCodeLine{76 \textcolor{keyword}{public}:}
\DoxyCodeLine{78     \mbox{\hyperlink{class_a_u_buffer_list_a13d02a76214931bd7355fbefcffeb83c}{AUBufferList}}() : mPtrState(kPtrsInvalid), mExternalMemory(\mbox{\hyperlink{ordinals_8h_a65e9886d74aaee76545e83dd09011727}{false}}), mPtrs(NULL), mMemory(NULL),}
\DoxyCodeLine{79         mAllocatedStreams(0), mAllocatedFrames(0), mAllocatedBytes(0) \{ \}}
\DoxyCodeLine{81     \mbox{\hyperlink{class_a_u_buffer_list_a1410f1d6d0c2a5ac02132d35ff83f5f4}{\string~AUBufferList}}();}
\DoxyCodeLine{82 }
\DoxyCodeLine{84     AudioBufferList \&   \mbox{\hyperlink{class_a_u_buffer_list_a6e0d86b78523ffcc3621b068f27cd741}{PrepareBuffer}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_c_a_stream_basic_description}{CAStreamBasicDescription}} \&\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}, UInt32 nFrames);}
\DoxyCodeLine{86     AudioBufferList \&   \mbox{\hyperlink{class_a_u_buffer_list_a72358f99c28a999eea69ece6071fc0e6}{PrepareNullBuffer}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_c_a_stream_basic_description}{CAStreamBasicDescription}} \&\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}, UInt32 nFrames);}
\DoxyCodeLine{87 }
\DoxyCodeLine{89     AudioBufferList \&   \mbox{\hyperlink{class_a_u_buffer_list_ad7314ee4fafb41ba5b67a2296f352cf7}{SetBufferList}}(\textcolor{keyword}{const} AudioBufferList \&abl) \{}
\DoxyCodeLine{90                             \textcolor{keywordflow}{if} (mAllocatedStreams < abl.mNumberBuffers)}
\DoxyCodeLine{91                                 \mbox{\hyperlink{_a_u_buffer_8h_a1ef03fa89bd4d61e8b4b34e3be9138e7}{COMPONENT\_THROW}}(-\/1);}
\DoxyCodeLine{92                             mPtrState = kPtrsToExternalMemory;}
\DoxyCodeLine{93                             memcpy(mPtrs, \&abl, (\textcolor{keywordtype}{char} *)\&abl.mBuffers[abl.mNumberBuffers] -\/ (\textcolor{keywordtype}{char} *)\&abl);}
\DoxyCodeLine{94                             \textcolor{keywordflow}{return} *mPtrs;}
\DoxyCodeLine{95                         \}}
\DoxyCodeLine{96 }
\DoxyCodeLine{98     \textcolor{keywordtype}{void}                \mbox{\hyperlink{class_a_u_buffer_list_ac6b2a65995c730d8f3c37f40983136ba}{SetBuffer}}(UInt32 \mbox{\hyperlink{namespacegl_a06a196a98fd7b17e699cbea6c66c37cb}{index}}, \textcolor{keyword}{const} \mbox{\hyperlink{class_audio_buffer}{AudioBuffer}} \&ab) \{}
\DoxyCodeLine{99                             \textcolor{keywordflow}{if} (mPtrState == kPtrsInvalid || \mbox{\hyperlink{namespacegl_a06a196a98fd7b17e699cbea6c66c37cb}{index}} >= mPtrs-\/>mNumberBuffers)}
\DoxyCodeLine{100                                 \mbox{\hyperlink{_a_u_buffer_8h_a1ef03fa89bd4d61e8b4b34e3be9138e7}{COMPONENT\_THROW}}(-\/1);}
\DoxyCodeLine{101                             mPtrState = kPtrsToExternalMemory;}
\DoxyCodeLine{102                             mPtrs-\/>mBuffers[\mbox{\hyperlink{namespacegl_a06a196a98fd7b17e699cbea6c66c37cb}{index}}] = ab;}
\DoxyCodeLine{103                         \}}
\DoxyCodeLine{104 }
\DoxyCodeLine{106     \textcolor{keywordtype}{void}                \mbox{\hyperlink{class_a_u_buffer_list_aaf8ef9ddb82980545da40eeaee8b7ff1}{InvalidateBufferList}}() \{ mPtrState = kPtrsInvalid; \}}
\DoxyCodeLine{107 }
\DoxyCodeLine{109     AudioBufferList \&   \mbox{\hyperlink{class_a_u_buffer_list_ae7515dcb8ba07a863e92a33d0c764ed3}{GetBufferList}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{110                             \textcolor{keywordflow}{if} (mPtrState == kPtrsInvalid)}
\DoxyCodeLine{111                                 \mbox{\hyperlink{_a_u_buffer_8h_a1ef03fa89bd4d61e8b4b34e3be9138e7}{COMPONENT\_THROW}}(-\/1);}
\DoxyCodeLine{112                             \textcolor{keywordflow}{return} *mPtrs;}
\DoxyCodeLine{113                         \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{116     \textcolor{keywordtype}{void}                \mbox{\hyperlink{class_a_u_buffer_list_ac27238d4a6c8fc8fa51b2a2556d5b055}{CopyBufferListTo}}(AudioBufferList \&abl)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{117                             \textcolor{keywordflow}{if} (mPtrState == kPtrsInvalid)}
\DoxyCodeLine{118                                 \mbox{\hyperlink{_a_u_buffer_8h_a1ef03fa89bd4d61e8b4b34e3be9138e7}{COMPONENT\_THROW}}(-\/1);}
\DoxyCodeLine{119                             memcpy(\&abl, mPtrs, (\textcolor{keywordtype}{char} *)\&abl.mBuffers[abl.mNumberBuffers] -\/ (\textcolor{keywordtype}{char} *)\&abl);}
\DoxyCodeLine{120                         \}}
\DoxyCodeLine{121 }
\DoxyCodeLine{123     \textcolor{keywordtype}{void}                \mbox{\hyperlink{class_a_u_buffer_list_a480477041f7d32ba19c0f34da3925c77}{CopyBufferContentsTo}}(AudioBufferList \&abl)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{124                             \textcolor{keywordflow}{if} (mPtrState == kPtrsInvalid)}
\DoxyCodeLine{125                                 \mbox{\hyperlink{_a_u_buffer_8h_a1ef03fa89bd4d61e8b4b34e3be9138e7}{COMPONENT\_THROW}}(-\/1);}
\DoxyCodeLine{126                             \textcolor{keyword}{const} \mbox{\hyperlink{class_audio_buffer}{AudioBuffer}} *srcbuf = mPtrs-\/>mBuffers;}
\DoxyCodeLine{127                             \mbox{\hyperlink{class_audio_buffer}{AudioBuffer}} *destbuf = abl.mBuffers;}
\DoxyCodeLine{128 }
\DoxyCodeLine{129                             \textcolor{keywordflow}{for} (UInt32 i = 0; i < abl.mNumberBuffers; ++i, ++srcbuf, ++destbuf) \{}
\DoxyCodeLine{130                                 \textcolor{keywordflow}{if} (i >= mPtrs-\/>mNumberBuffers) \textcolor{comment}{// duplicate last source to additional outputs [4341137]}}
\DoxyCodeLine{131                                     -\/-\/srcbuf;}
\DoxyCodeLine{132                                 \textcolor{keywordflow}{if} (destbuf-\/>mData != srcbuf-\/>mData)}
\DoxyCodeLine{133                                     memmove(destbuf-\/>mData, srcbuf-\/>mData, srcbuf-\/>mDataByteSize);}
\DoxyCodeLine{134                                 destbuf-\/>mDataByteSize = srcbuf-\/>mDataByteSize;}
\DoxyCodeLine{135                             \}}
\DoxyCodeLine{136                         \}}
\DoxyCodeLine{137 }
\DoxyCodeLine{139     \textcolor{keywordtype}{void}                \mbox{\hyperlink{class_a_u_buffer_list_a1d94b80abeaeaccc98abaf6f712e4185}{Allocate}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_c_a_stream_basic_description}{CAStreamBasicDescription}} \&\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}, UInt32 nFrames);}
\DoxyCodeLine{141     \textcolor{keywordtype}{void}                \mbox{\hyperlink{class_a_u_buffer_list_abd67d1a06823ddd65af196f71d6de6de}{Deallocate}}();}
\DoxyCodeLine{142 }
\DoxyCodeLine{144     \textcolor{keywordtype}{void}                \mbox{\hyperlink{class_a_u_buffer_list_a699419c2c30da7d1feec28c7c6552db1}{UseExternalBuffer}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_c_a_stream_basic_description}{CAStreamBasicDescription}} \&\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}, \textcolor{keyword}{const} AudioUnitExternalBuffer \&\mbox{\hyperlink{namespacegl_ab998012e627da2312fc60f51c0c2f313}{buf}});}
\DoxyCodeLine{145 }
\DoxyCodeLine{146     \textcolor{comment}{// AudioBufferList utilities}}
\DoxyCodeLine{148 \textcolor{comment}{}    \textcolor{keyword}{static} \textcolor{keywordtype}{void}         \mbox{\hyperlink{class_a_u_buffer_list_a820bbcdc274d91cb7718b1c8b268973c}{ZeroBuffer}}(AudioBufferList \&abl) \{}
\DoxyCodeLine{149                             \mbox{\hyperlink{class_audio_buffer}{AudioBuffer}} *\mbox{\hyperlink{namespacegl_ab998012e627da2312fc60f51c0c2f313}{buf}} = abl.mBuffers;}
\DoxyCodeLine{150                             \textcolor{keywordflow}{for} (UInt32 i = abl.mNumberBuffers ; i-\/-\/; ++\mbox{\hyperlink{namespacegl_ab998012e627da2312fc60f51c0c2f313}{buf}})}
\DoxyCodeLine{151                                 memset(\mbox{\hyperlink{namespacegl_ab998012e627da2312fc60f51c0c2f313}{buf}}-\/>mData, 0, \mbox{\hyperlink{namespacegl_ab998012e627da2312fc60f51c0c2f313}{buf}}-\/>mDataByteSize);}
\DoxyCodeLine{152                         \}}
\DoxyCodeLine{153 \textcolor{preprocessor}{\#if DEBUG}}
\DoxyCodeLine{155     \textcolor{keyword}{static} \textcolor{keywordtype}{void}         PrintBuffer(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682cad304ba20e96d87411588eeabac850e34}{label}}, \textcolor{keywordtype}{int} subscript, \textcolor{keyword}{const} AudioBufferList \&abl, UInt32 nFrames = 8, \textcolor{keywordtype}{bool} asFloats = \textcolor{keyword}{true});}
\DoxyCodeLine{156 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{157 }
\DoxyCodeLine{159     UInt32              \mbox{\hyperlink{class_a_u_buffer_list_a33590fadfa3ce8755092ccdf65b6bf38}{GetAllocatedFrames}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} mAllocatedFrames; \}}
\DoxyCodeLine{160 }
\DoxyCodeLine{161 \textcolor{keyword}{private}:}
\DoxyCodeLine{163     \mbox{\hyperlink{class_a_u_buffer_list_a13d02a76214931bd7355fbefcffeb83c}{AUBufferList}}(\mbox{\hyperlink{class_a_u_buffer_list}{AUBufferList}} \&) \{ \}    \textcolor{comment}{// prohibit copy constructor}}
\DoxyCodeLine{164 }
\DoxyCodeLine{166     EPtrState                   mPtrState;}
\DoxyCodeLine{168     \textcolor{keywordtype}{bool}                        mExternalMemory;}
\DoxyCodeLine{170     AudioBufferList *           mPtrs;}
\DoxyCodeLine{172     \mbox{\hyperlink{zconf_8h_ae3a497195d617519e5353ea7b417940f}{Byte}} *                      mMemory;}
\DoxyCodeLine{174     UInt32                      mAllocatedStreams;}
\DoxyCodeLine{176     UInt32                      mAllocatedFrames;}
\DoxyCodeLine{178     UInt32                      mAllocatedBytes;}
\DoxyCodeLine{179 \};}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 }
\DoxyCodeLine{182 \textcolor{comment}{// Allocates an array of samples (type T), to be optimally aligned for the processor}}
\DoxyCodeLine{184 \textcolor{comment}{}\textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{185 \textcolor{keyword}{class }\mbox{\hyperlink{class_t_a_u_buffer}{TAUBuffer}} \{}
\DoxyCodeLine{186 \textcolor{keyword}{public}:}
\DoxyCodeLine{187     \textcolor{keyword}{enum} \{}
\DoxyCodeLine{188         \mbox{\hyperlink{class_t_a_u_buffer_a48b4b14fef4e19ee9da7556100abd440a2425ea048095f8ee596c24dce4c88bcd}{kAlignInterval}} = 0x10,}
\DoxyCodeLine{189         \mbox{\hyperlink{class_t_a_u_buffer_a48b4b14fef4e19ee9da7556100abd440a6afa5455ee3c7680b34e72a8ce0f1379}{kAlignMask}} = \mbox{\hyperlink{class_t_a_u_buffer_a48b4b14fef4e19ee9da7556100abd440a2425ea048095f8ee596c24dce4c88bcd}{kAlignInterval}} -\/ 1}
\DoxyCodeLine{190     \};}
\DoxyCodeLine{191 }
\DoxyCodeLine{193     \mbox{\hyperlink{class_t_a_u_buffer_a8538595a73e0eab972e2792f990ed791}{TAUBuffer}}() :  mMemObject(NULL), mAlignedBuffer(NULL), mBufferSizeBytes(0)}
\DoxyCodeLine{194     \{}
\DoxyCodeLine{195     \}}
\DoxyCodeLine{196 }
\DoxyCodeLine{198     \mbox{\hyperlink{class_t_a_u_buffer_ad80d3e677703087d8cd2ce6f3d2daccb}{TAUBuffer}}(UInt32 numElems, UInt32 numChannels) :   mMemObject(NULL), mAlignedBuffer(NULL),}
\DoxyCodeLine{199                                                         mBufferSizeBytes(0)}
\DoxyCodeLine{200     \{}
\DoxyCodeLine{201         \mbox{\hyperlink{class_t_a_u_buffer_ac377f3a0d55210de2d3601032f234fd2}{Allocate}}(numElems, numChannels);}
\DoxyCodeLine{202     \}}
\DoxyCodeLine{203 }
\DoxyCodeLine{205     \mbox{\hyperlink{class_t_a_u_buffer_a027767fdfe7237de501c4cae8af1ae30}{\string~TAUBuffer}}()}
\DoxyCodeLine{206     \{}
\DoxyCodeLine{207         \mbox{\hyperlink{class_t_a_u_buffer_a8f5706222968f7cf7d12b9678147d229}{Deallocate}}();}
\DoxyCodeLine{208     \}}
\DoxyCodeLine{209 }
\DoxyCodeLine{211     \textcolor{keywordtype}{void}    \mbox{\hyperlink{class_t_a_u_buffer_ac377f3a0d55210de2d3601032f234fd2}{Allocate}}(UInt32 numElems)           \textcolor{comment}{// can also re-\/allocate}}
\DoxyCodeLine{212     \{}
\DoxyCodeLine{213         UInt32 reqSize = numElems * \textcolor{keyword}{sizeof}(T);}
\DoxyCodeLine{214 }
\DoxyCodeLine{215         \textcolor{keywordflow}{if} (mMemObject != NULL \&\& reqSize == mBufferSizeBytes)}
\DoxyCodeLine{216             \textcolor{keywordflow}{return}; \textcolor{comment}{// already allocated}}
\DoxyCodeLine{217 }
\DoxyCodeLine{218         mBufferSizeBytes = reqSize;}
\DoxyCodeLine{219         mMemObject = \mbox{\hyperlink{_c_a_auto_disposer_8h_abedc5e523e3949ea1035955078173f02}{CA\_realloc}}(mMemObject, reqSize);}
\DoxyCodeLine{220         UInt32 misalign = (uintptr\_t)mMemObject \& \mbox{\hyperlink{class_t_a_u_buffer_a48b4b14fef4e19ee9da7556100abd440a6afa5455ee3c7680b34e72a8ce0f1379}{kAlignMask}};}
\DoxyCodeLine{221         \textcolor{keywordflow}{if} (misalign) \{}
\DoxyCodeLine{222             mMemObject = \mbox{\hyperlink{_c_a_auto_disposer_8h_abedc5e523e3949ea1035955078173f02}{CA\_realloc}}(mMemObject, reqSize + \mbox{\hyperlink{class_t_a_u_buffer_a48b4b14fef4e19ee9da7556100abd440a6afa5455ee3c7680b34e72a8ce0f1379}{kAlignMask}});}
\DoxyCodeLine{223             mAlignedBuffer = (T *)((\textcolor{keywordtype}{char} *)mMemObject + \mbox{\hyperlink{class_t_a_u_buffer_a48b4b14fef4e19ee9da7556100abd440a2425ea048095f8ee596c24dce4c88bcd}{kAlignInterval}} -\/ misalign);}
\DoxyCodeLine{224         \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{225             mAlignedBuffer = (T *)mMemObject;}
\DoxyCodeLine{226     \}}
\DoxyCodeLine{227 }
\DoxyCodeLine{229     \textcolor{keywordtype}{void}    \mbox{\hyperlink{class_t_a_u_buffer_a8f5706222968f7cf7d12b9678147d229}{Deallocate}}()}
\DoxyCodeLine{230     \{}
\DoxyCodeLine{231         \textcolor{keywordflow}{if} (mMemObject == NULL) \textcolor{keywordflow}{return};         \textcolor{comment}{// so this method has no effect if we're using}}
\DoxyCodeLine{232                                                 \textcolor{comment}{// an external buffer}}
\DoxyCodeLine{233 }
\DoxyCodeLine{234         \mbox{\hyperlink{_c_a_auto_disposer_8h_ad6789ba73d47afb261058c686ba7089e}{free}}(mMemObject);}
\DoxyCodeLine{235         mMemObject = NULL;}
\DoxyCodeLine{236         mAlignedBuffer = NULL;}
\DoxyCodeLine{237         mBufferSizeBytes = 0;}
\DoxyCodeLine{238     \}}
\DoxyCodeLine{239 }
\DoxyCodeLine{241     \textcolor{keywordtype}{void}    \mbox{\hyperlink{class_t_a_u_buffer_adbce06a00d5aee4da3d5de87b35fe179}{AllocateClear}}(UInt32 numElems)     \textcolor{comment}{// can also re-\/allocate}}
\DoxyCodeLine{242     \{}
\DoxyCodeLine{243         \mbox{\hyperlink{class_t_a_u_buffer_ac377f3a0d55210de2d3601032f234fd2}{Allocate}}(numElems);}
\DoxyCodeLine{244         \mbox{\hyperlink{class_t_a_u_buffer_aa6f3c15a01d8236c27beee76e72086eb}{Clear}}();}
\DoxyCodeLine{245     \}}
\DoxyCodeLine{246 }
\DoxyCodeLine{248     \textcolor{keywordtype}{void}    \mbox{\hyperlink{class_t_a_u_buffer_aa6f3c15a01d8236c27beee76e72086eb}{Clear}}()}
\DoxyCodeLine{249     \{}
\DoxyCodeLine{250         memset(mAlignedBuffer, 0, mBufferSizeBytes);}
\DoxyCodeLine{251     \}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253     \textcolor{comment}{// accessors}}
\DoxyCodeLine{254 }
\DoxyCodeLine{256     \textcolor{keyword}{operator} T *()              \{ \textcolor{keywordflow}{return} mAlignedBuffer; \}}
\DoxyCodeLine{257 }
\DoxyCodeLine{258 \textcolor{keyword}{private}:}
\DoxyCodeLine{260     \textcolor{keywordtype}{void} *      mMemObject;         \textcolor{comment}{// null when using an external buffer}}
\DoxyCodeLine{262 \textcolor{comment}{}    T *         mAlignedBuffer;     \textcolor{comment}{// always valid once allocated}}
\DoxyCodeLine{264 \textcolor{comment}{}    UInt32      mBufferSizeBytes;}
\DoxyCodeLine{265 \};}
\DoxyCodeLine{266 }
\DoxyCodeLine{267 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// \_\_AUBuffer\_h\_\_}}

\end{DoxyCode}
