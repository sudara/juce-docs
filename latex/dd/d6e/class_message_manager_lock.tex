\hypertarget{class_message_manager_lock}{}\doxysection{Message\+Manager\+Lock Class Reference}
\label{class_message_manager_lock}\index{MessageManagerLock@{MessageManagerLock}}


{\ttfamily \#include $<$juce\+\_\+\+Message\+Manager.\+h$>$}

Inheritance diagram for Message\+Manager\+Lock\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{dd/d6e/class_message_manager_lock}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_message_manager_lock_a294fab36d4e9fe48cc2b52b36974111c}{Message\+Manager\+Lock}} (\mbox{\hyperlink{class_thread}{Thread}} $\ast$thread\+To\+Check\+For\+Exit\+Signal=nullptr)
\item 
\mbox{\hyperlink{class_message_manager_lock_ac6da971e61e376e8216da1f39ccb5582}{Message\+Manager\+Lock}} (\mbox{\hyperlink{class_thread_pool_job}{Thread\+Pool\+Job}} $\ast$job\+To\+Check\+For\+Exit\+Signal)
\item 
\mbox{\hyperlink{class_message_manager_lock_a6751b59129320288758ba7d2773f40e7}{$\sim$\+Message\+Manager\+Lock}} () override
\item 
bool \mbox{\hyperlink{class_message_manager_lock_a5f3d8b6abc27aa324a882abc6e2d96ba}{lock\+Was\+Gained}} () \mbox{\hyperlink{zconf_8in_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Used to make sure that the calling thread has exclusive access to the message loop.

Because it\textquotesingle{}s not thread-\/safe to call any of the \mbox{\hyperlink{class_component}{Component}} or other UI classes from threads other than the message thread, one of these objects can be used to lock the message loop and allow this to be done. The message thread will be suspended for the lifetime of the \mbox{\hyperlink{class_message_manager_lock}{Message\+Manager\+Lock}} object, so create one on the stack like this\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} MyThread::run()}
\DoxyCodeLine{\{}
\DoxyCodeLine{    someData = 1234;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{const} \mbox{\hyperlink{class_message_manager_lock}{MessageManagerLock}} mmLock;}
\DoxyCodeLine{    \textcolor{comment}{// the event loop will now be locked so it's safe to make a few calls..}}
\DoxyCodeLine{}
\DoxyCodeLine{    myComponent-\/>setBounds (newBounds);}
\DoxyCodeLine{    myComponent-\/>repaint();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// ..the event loop will now be unlocked as the MessageManagerLock goes out of scope}}
\DoxyCodeLine{\}}

\end{DoxyCode}


Obviously be careful not to create one of these and leave it lying around, or your app will grind to a halt!

Message\+Manager\+Locks are re-\/entrant, so can be safely nested if the current thread already has the lock.

Another caveat is that using this in conjunction with other Critical\+Sections can create lots of interesting ways of producing a deadlock! In particular, if your message thread calls stop\+Thread() for a thread that uses these locks, you\textquotesingle{}ll get an (occasional) deadlock..

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_message_manager}{Message\+Manager}}, \mbox{\hyperlink{class_message_manager_aebd4b8896d7b6bdfa34d3cd8eb2e1777}{Message\+Manager\+::current\+Thread\+Has\+Locked\+Message\+Manager}}
\end{DoxySeeAlso}
@tags\{Events\} 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_message_manager_lock_a294fab36d4e9fe48cc2b52b36974111c}\label{class_message_manager_lock_a294fab36d4e9fe48cc2b52b36974111c}} 
\index{MessageManagerLock@{MessageManagerLock}!MessageManagerLock@{MessageManagerLock}}
\index{MessageManagerLock@{MessageManagerLock}!MessageManagerLock@{MessageManagerLock}}
\doxysubsubsection{\texorpdfstring{MessageManagerLock()}{MessageManagerLock()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Message\+Manager\+Lock\+::\+Message\+Manager\+Lock (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_thread}{Thread}} $\ast$}]{thread\+To\+Check\+For\+Exit\+Signal = {\ttfamily nullptr} }\end{DoxyParamCaption})}

Tries to acquire a lock on the message manager.

The constructor attempts to gain a lock on the message loop, and the lock will be kept for the lifetime of this object.

Optionally, you can pass a thread object here, and while waiting to obtain the lock, this method will keep checking whether the thread has been given the \mbox{\hyperlink{class_thread_affe168e27c6ee50b0d10522810772268}{Thread\+::signal\+Thread\+Should\+Exit()}} signal. If this happens, then it will return without gaining the lock. If you pass a thread, you must check whether the lock was successful by calling \mbox{\hyperlink{class_message_manager_lock_a5f3d8b6abc27aa324a882abc6e2d96ba}{lock\+Was\+Gained()}}. If this is false, your thread is being told to die, so you should take evasive action.

If you pass nullptr for the thread object, it will wait indefinitely for the lock -\/ be careful when doing this, because it\textquotesingle{}s very easy to deadlock if your message thread attempts to call stop\+Thread() on a thread just as that thread attempts to get the message lock.

If the calling thread already has the lock, nothing will be done, so it\textquotesingle{}s safe and quick to use these locks recursively.

E.\+g. 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} run()}
\DoxyCodeLine{\{}
\DoxyCodeLine{    ...}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{while} (! threadShouldExit())}
\DoxyCodeLine{    \{}
\DoxyCodeLine{        \mbox{\hyperlink{class_message_manager_lock}{MessageManagerLock}} mml (\mbox{\hyperlink{class_thread_aa2121cb538b34f34c5c1123514caffb0}{Thread::getCurrentThread}}());}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{keywordflow}{if} (! mml.lockWasGained())}
\DoxyCodeLine{            \textcolor{keywordflow}{return}; \textcolor{comment}{// another thread is trying to kill us!}}
\DoxyCodeLine{}
\DoxyCodeLine{        ..\textcolor{keywordflow}{do} some locked stuff here..}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    ..and now the MM is now unlocked..}
\DoxyCodeLine{\}}

\end{DoxyCode}
 \mbox{\Hypertarget{class_message_manager_lock_ac6da971e61e376e8216da1f39ccb5582}\label{class_message_manager_lock_ac6da971e61e376e8216da1f39ccb5582}} 
\index{MessageManagerLock@{MessageManagerLock}!MessageManagerLock@{MessageManagerLock}}
\index{MessageManagerLock@{MessageManagerLock}!MessageManagerLock@{MessageManagerLock}}
\doxysubsubsection{\texorpdfstring{MessageManagerLock()}{MessageManagerLock()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Message\+Manager\+Lock\+::\+Message\+Manager\+Lock (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_thread_pool_job}{Thread\+Pool\+Job}} $\ast$}]{job\+To\+Check\+For\+Exit\+Signal }\end{DoxyParamCaption})}

This has the same behaviour as the other constructor, but takes a \mbox{\hyperlink{class_thread_pool_job}{Thread\+Pool\+Job}} instead of a thread.

See the \mbox{\hyperlink{class_message_manager_lock}{Message\+Manager\+Lock}} (Thread$\ast$) constructor for details on how this works. \mbox{\Hypertarget{class_message_manager_lock_a6751b59129320288758ba7d2773f40e7}\label{class_message_manager_lock_a6751b59129320288758ba7d2773f40e7}} 
\index{MessageManagerLock@{MessageManagerLock}!````~MessageManagerLock@{$\sim$MessageManagerLock}}
\index{````~MessageManagerLock@{$\sim$MessageManagerLock}!MessageManagerLock@{MessageManagerLock}}
\doxysubsubsection{\texorpdfstring{$\sim$MessageManagerLock()}{~MessageManagerLock()}}
{\footnotesize\ttfamily Message\+Manager\+Lock\+::$\sim$\+Message\+Manager\+Lock (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}}

Releases the current thread\textquotesingle{}s lock on the message manager.

Make sure this object is created and deleted by the same thread, otherwise there are no guarantees what will happen! 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_message_manager_lock_a5f3d8b6abc27aa324a882abc6e2d96ba}\label{class_message_manager_lock_a5f3d8b6abc27aa324a882abc6e2d96ba}} 
\index{MessageManagerLock@{MessageManagerLock}!lockWasGained@{lockWasGained}}
\index{lockWasGained@{lockWasGained}!MessageManagerLock@{MessageManagerLock}}
\doxysubsubsection{\texorpdfstring{lockWasGained()}{lockWasGained()}}
{\footnotesize\ttfamily bool Message\+Manager\+Lock\+::lock\+Was\+Gained (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}

Returns true if the lock was successfully acquired. (See the constructor that takes a \mbox{\hyperlink{class_thread}{Thread}} for more info). 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
build/juce\+\_\+events/messages/\mbox{\hyperlink{juce___message_manager_8h}{juce\+\_\+\+Message\+Manager.\+h}}\item 
build/juce\+\_\+events/messages/\mbox{\hyperlink{juce___message_manager_8cpp}{juce\+\_\+\+Message\+Manager.\+cpp}}\end{DoxyCompactItemize}
