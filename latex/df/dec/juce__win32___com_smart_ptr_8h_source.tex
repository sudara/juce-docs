\hypertarget{juce__win32___com_smart_ptr_8h_source}{}\doxysection{juce\+\_\+win32\+\_\+\+Com\+Smart\+Ptr.\+h}
\label{juce__win32___com_smart_ptr_8h_source}\index{build/juce\_core/native/juce\_win32\_ComSmartPtr.h@{build/juce\_core/native/juce\_win32\_ComSmartPtr.h}}
\mbox{\hyperlink{juce__win32___com_smart_ptr_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{   This file is part of the JUCE library.}}
\DoxyCodeLine{5 \textcolor{comment}{   Copyright (c) 2020 -\/ Raw Material Software Limited}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{   JUCE is an open source library subject to commercial or open-\/source}}
\DoxyCodeLine{8 \textcolor{comment}{   licensing.}}
\DoxyCodeLine{9 \textcolor{comment}{}}
\DoxyCodeLine{10 \textcolor{comment}{   The code included in this file is provided under the terms of the ISC license}}
\DoxyCodeLine{11 \textcolor{comment}{   http://www.isc.org/downloads/software-\/support-\/policy/isc-\/license. Permission}}
\DoxyCodeLine{12 \textcolor{comment}{   To use, copy, modify, and/or distribute this software for any purpose with or}}
\DoxyCodeLine{13 \textcolor{comment}{   without fee is hereby granted provided that the above copyright notice and}}
\DoxyCodeLine{14 \textcolor{comment}{   this permission notice appear in all copies.}}
\DoxyCodeLine{15 \textcolor{comment}{}}
\DoxyCodeLine{16 \textcolor{comment}{   JUCE IS PROVIDED "{}AS IS"{} WITHOUT ANY WARRANTY, AND ALL WARRANTIES, WHETHER}}
\DoxyCodeLine{17 \textcolor{comment}{   EXPRESSED OR IMPLIED, INCLUDING MERCHANTABILITY AND FITNESS FOR PURPOSE, ARE}}
\DoxyCodeLine{18 \textcolor{comment}{   DISCLAIMED.}}
\DoxyCodeLine{19 \textcolor{comment}{}}
\DoxyCodeLine{20 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{21 \textcolor{comment}{*/}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacejuce}{juce}}}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#if (JUCE\_MINGW \&\& JUCE\_32BIT) || (! defined (\_MSC\_VER) \&\& ! defined (\_\_uuidof))}}
\DoxyCodeLine{27 \textcolor{preprocessor}{ \#ifdef \_\_uuidof}}
\DoxyCodeLine{28 \textcolor{preprocessor}{  \#undef \_\_uuidof}}
\DoxyCodeLine{29 \textcolor{preprocessor}{ \#endif}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31  \textcolor{keyword}{template} <\textcolor{keyword}{typename} Type> \textcolor{keyword}{struct }\mbox{\hyperlink{structjuce_1_1_u_u_i_d_getter}{UUIDGetter}} \{ \textcolor{keyword}{static} CLSID \mbox{\hyperlink{structjuce_1_1_u_u_i_d_getter_a05fed5bef3ceff863f1395c12ecea28b}{get}}() \{ \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}}; \textcolor{keywordflow}{return} \{\}; \} \};}
\DoxyCodeLine{32 \textcolor{preprocessor}{ \#define \_\_uuidof(x)  UUIDGetter<x>::get()}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34  \textcolor{keyword}{template} <>}
\DoxyCodeLine{35  \textcolor{keyword}{struct }\mbox{\hyperlink{structjuce_1_1_u_u_i_d_getter}{UUIDGetter}}<::IUnknown>}
\DoxyCodeLine{36  \{}
\DoxyCodeLine{37      \textcolor{keyword}{static} CLSID \mbox{\hyperlink{structjuce_1_1_u_u_i_d_getter_3_1_1_i_unknown_01_4_a12bdd349b2aa3a72df1274c0a0475416}{get}}()     \{ \textcolor{keywordflow}{return} \{ 0, 0, 0, \{ 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46 \} \}; \}}
\DoxyCodeLine{38  \};}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{preprocessor}{ \#define JUCE\_DECLARE\_UUID\_GETTER(name, uuid) \(\backslash\)}}
\DoxyCodeLine{41 \textcolor{preprocessor}{    template <> struct UUIDGetter<name> \{ static CLSID get()  \{ return uuidFromString (uuid); \} \};}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{preprocessor}{ \#define JUCE\_COMCLASS(name, guid) \(\backslash\)}}
\DoxyCodeLine{44 \textcolor{preprocessor}{    struct name; \(\backslash\)}}
\DoxyCodeLine{45 \textcolor{preprocessor}{    JUCE\_DECLARE\_UUID\_GETTER (name, guid) \(\backslash\)}}
\DoxyCodeLine{46 \textcolor{preprocessor}{    struct name}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{49 \textcolor{preprocessor}{ \#define JUCE\_DECLARE\_UUID\_GETTER(name, uuid)}}
\DoxyCodeLine{50 \textcolor{preprocessor}{ \#define JUCE\_COMCLASS(name, guid)       struct DECLSPEC\_UUID (guid) name}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{preprocessor}{\#define JUCE\_IUNKNOWNCLASS(name, guid)   JUCE\_COMCLASS(name, guid) : public IUnknown}}
\DoxyCodeLine{54 \textcolor{preprocessor}{\#define JUCE\_COMRESULT                   HRESULT STDMETHODCALLTYPE}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#define JUCE\_COMCALL                     virtual HRESULT STDMETHODCALLTYPE}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \mbox{\hyperlink{group__juce__core-system_ga0112339834a6548e4123e394b9ed95e2}{JUCE\_BEGIN\_IGNORE\_WARNINGS\_GCC\_LIKE}} (\textcolor{stringliteral}{"{}-\/Wlanguage-\/extension-\/token"{}})}
\DoxyCodeLine{58 }
\DoxyCodeLine{59 inline GUID \mbox{\hyperlink{namespacejuce_a0f34a279af3720e6495441bca4151098}{uuidFromString}} (\mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} \textcolor{keywordtype}{char}* \mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}}) noexcept}
\DoxyCodeLine{60 \{}
\DoxyCodeLine{61     \mbox{\hyperlink{juce__box2d_8cpp_a9a119f677d620a08be866b14a7f8f00e}{uint32}} ints[4] = \{\};}
\DoxyCodeLine{62 }
\DoxyCodeLine{63     \textcolor{keywordflow}{for} (\mbox{\hyperlink{juce__box2d_8cpp_a9a119f677d620a08be866b14a7f8f00e}{uint32}} digitIndex = 0; digitIndex < 32;)}
\DoxyCodeLine{64     \{}
\DoxyCodeLine{65         \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} = (\mbox{\hyperlink{namespace_steinberg_af4518d725547bee20d4e185e8d3f1965}{uint32}}) *\mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}}++;}
\DoxyCodeLine{66         \mbox{\hyperlink{juce__box2d_8cpp_a9a119f677d620a08be866b14a7f8f00e}{uint32}} digit;}
\DoxyCodeLine{67 }
\DoxyCodeLine{68         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} >= \textcolor{charliteral}{'0'} \&\& \mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} <= \textcolor{charliteral}{'9'})       digit = \mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} -\/ \textcolor{charliteral}{'0'};}
\DoxyCodeLine{69         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} >= \textcolor{charliteral}{'a'} \&\& \mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} <= \textcolor{charliteral}{'f'})  digit = \mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} -\/ \textcolor{charliteral}{'a'} + 10;}
\DoxyCodeLine{70         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} >= \textcolor{charliteral}{'A'} \&\& \mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} <= \textcolor{charliteral}{'F'})  digit = \mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} -\/ \textcolor{charliteral}{'A'} + 10;}
\DoxyCodeLine{71         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}} == \textcolor{charliteral}{'-\/'})              \textcolor{keywordflow}{continue};}
\DoxyCodeLine{72         \textcolor{keywordflow}{else} \textcolor{keywordflow}{break};}
\DoxyCodeLine{73 }
\DoxyCodeLine{74         ints[digitIndex / 8] |= (digit << 4 * (7 -\/ (digitIndex \& 7)));}
\DoxyCodeLine{75         ++digitIndex;}
\DoxyCodeLine{76     \}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78     \textcolor{keywordflow}{return} \{ ints[0],}
\DoxyCodeLine{79              (\mbox{\hyperlink{namespace_steinberg_a5f06a8622e4753e2f9617feb26f625ae}{uint16}}) (ints[1] >> 16),}
\DoxyCodeLine{80              (\mbox{\hyperlink{namespace_steinberg_a5f06a8622e4753e2f9617feb26f625ae}{uint16}}) ints[1],}
\DoxyCodeLine{81              \{ (\mbox{\hyperlink{namespace_steinberg_ac26ab57d77dced6ef40e21775a18e4fd}{uint8}}) (ints[2] >> 24), (\mbox{\hyperlink{namespace_steinberg_ac26ab57d77dced6ef40e21775a18e4fd}{uint8}}) (ints[2] >> 16), (\mbox{\hyperlink{namespace_steinberg_ac26ab57d77dced6ef40e21775a18e4fd}{uint8}}) (ints[2] >> 8), (\mbox{\hyperlink{namespace_steinberg_ac26ab57d77dced6ef40e21775a18e4fd}{uint8}}) ints[2],}
\DoxyCodeLine{82                (\mbox{\hyperlink{juce__box2d_8cpp_a4a0dc603b03692b2e16aca65cd3f7c35}{uint8}}) (ints[3] >> 24), (\mbox{\hyperlink{juce__box2d_8cpp_a4a0dc603b03692b2e16aca65cd3f7c35}{uint8}}) (ints[3] >> 16), (\mbox{\hyperlink{juce__box2d_8cpp_a4a0dc603b03692b2e16aca65cd3f7c35}{uint8}}) (ints[3] >> 8), (\mbox{\hyperlink{juce__box2d_8cpp_a4a0dc603b03692b2e16aca65cd3f7c35}{uint8}}) ints[3] \}\};}
\DoxyCodeLine{83 \}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{90 \textcolor{comment}{}\textcolor{keyword}{template} <\textcolor{keyword}{class} ComClass>}
\DoxyCodeLine{91 \textcolor{keyword}{class }\mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr}}}
\DoxyCodeLine{92 \{}
\DoxyCodeLine{93 \textcolor{keyword}{public}:}
\DoxyCodeLine{94     \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a18814a1175569f63001f91dac53bcbb0}{ComSmartPtr}}() noexcept \{\}}
\DoxyCodeLine{95     \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a68635bd746dded05b7d9d5ae1c99c8a9}{ComSmartPtr}} (ComClass* \mbox{\hyperlink{namespacegl_a5005400d1adacbeae9bca0afbc7cb101}{obj}}) : p (\mbox{\hyperlink{namespacegl_a5005400d1adacbeae9bca0afbc7cb101}{obj}})                   \{ \textcolor{keywordflow}{if} (p) p-\/>AddRef(); \}}
\DoxyCodeLine{96     \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a78f93147245d4407c305419741bd7223}{ComSmartPtr}} (\textcolor{keyword}{const} \mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr}}\& other) : p (other.p)    \{ \textcolor{keywordflow}{if} (p) p-\/>AddRef(); \}}
\DoxyCodeLine{97     \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a34210e56f1cea4a40698a5ab29039644}{\string~ComSmartPtr}}()                                          \{ release(); \}}
\DoxyCodeLine{98 }
\DoxyCodeLine{99     \textcolor{keyword}{operator} ComClass*() \textcolor{keyword}{const} \textcolor{keyword}{noexcept}     \{ \textcolor{keywordflow}{return} p; \}}
\DoxyCodeLine{100     ComClass\& \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_ab492e8587227dbad1bdf31f65bbf497f}{operator*}}() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept    \{ \textcolor{keywordflow}{return} *p; \}}
\DoxyCodeLine{101     ComClass* \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a3f3bdb5915505cf0d050cfa7a76c0ed0}{operator-\/>}}() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept   \{ \textcolor{keywordflow}{return} p; \}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103     \mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr}}\& \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a2f499e348fd98574582f00522a30e02a}{operator= }}(ComClass* \textcolor{keyword}{const} newP)}
\DoxyCodeLine{104     \{}
\DoxyCodeLine{105         \textcolor{keywordflow}{if} (newP != \textcolor{keyword}{nullptr})  newP-\/>AddRef();}
\DoxyCodeLine{106         release();}
\DoxyCodeLine{107         p = newP;}
\DoxyCodeLine{108         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{109     \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111     \mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr}}\& \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a2f499e348fd98574582f00522a30e02a}{operator= }}(\textcolor{keyword}{const} \mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr}}\& newP)  \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a2f499e348fd98574582f00522a30e02a}{operator= }}(newP.p); \}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{comment}{// Releases and nullifies this pointer and returns its address}}
\DoxyCodeLine{114     ComClass** \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a719b6e40223f6be85c0ca699feefe66d}{resetAndGetPointerAddress}}()}
\DoxyCodeLine{115     \{}
\DoxyCodeLine{116         release();}
\DoxyCodeLine{117         p = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{118         \textcolor{keywordflow}{return} \&p;}
\DoxyCodeLine{119     \}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     HRESULT \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a9bbc5e808c6bbcdef7120d94c09a4a24}{CoCreateInstance}} (REFCLSID classUUID, DWORD dwClsContext = CLSCTX\_INPROC\_SERVER)}
\DoxyCodeLine{122     \{}
\DoxyCodeLine{123         \textcolor{keyword}{auto} hr = \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a9bbc5e808c6bbcdef7120d94c09a4a24}{::CoCreateInstance}} (classUUID, \textcolor{keyword}{nullptr}, dwClsContext, \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_ae3b9af23b20d9586ee6bd9297ad38b73}{\_\_uuidof}} (ComClass), (\textcolor{keywordtype}{void}**) \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a719b6e40223f6be85c0ca699feefe66d}{resetAndGetPointerAddress}}());}
\DoxyCodeLine{124         \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (hr != CO\_E\_NOTINITIALIZED); \textcolor{comment}{// You haven't called CoInitialize for the current thread!}}
\DoxyCodeLine{125         \textcolor{keywordflow}{return} hr;}
\DoxyCodeLine{126     \}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128     \textcolor{keyword}{template} <\textcolor{keyword}{class} OtherComClass>}
\DoxyCodeLine{129     HRESULT \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_ad0628fe8c8859799c224b07719eaaf23}{QueryInterface}} (REFCLSID classUUID, \mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr<OtherComClass>}}\& destObject)\textcolor{keyword}{ const}}
\DoxyCodeLine{130 \textcolor{keyword}{    }\{}
\DoxyCodeLine{131         \textcolor{keywordflow}{if} (p == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{132             \textcolor{keywordflow}{return} E\_POINTER;}
\DoxyCodeLine{133 }
\DoxyCodeLine{134         \textcolor{keywordflow}{return} p-\/>QueryInterface (classUUID, (\textcolor{keywordtype}{void}**) destObject.\mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a719b6e40223f6be85c0ca699feefe66d}{resetAndGetPointerAddress}}());}
\DoxyCodeLine{135     \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{137     \textcolor{keyword}{template} <\textcolor{keyword}{class} OtherComClass>}
\DoxyCodeLine{138     HRESULT \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_a77a9359106a73f70ae5997bf06491aa7}{QueryInterface}} (\mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr<OtherComClass>}}\& destObject)\textcolor{keyword}{ const}}
\DoxyCodeLine{139 \textcolor{keyword}{    }\{}
\DoxyCodeLine{140         \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classjuce_1_1_com_smart_ptr_ad0628fe8c8859799c224b07719eaaf23}{QueryInterface}} (\mbox{\hyperlink{juce__win32___com_smart_ptr_8h_ae3b9af23b20d9586ee6bd9297ad38b73}{\_\_uuidof}} (OtherComClass), destObject);}
\DoxyCodeLine{141     \}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143     \textcolor{keyword}{template} <\textcolor{keyword}{class} OtherComClass>}
\DoxyCodeLine{144     \mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr<OtherComClass>}} \mbox{\hyperlink{classjuce_1_1_com_smart_ptr_aed2bd61e0cfe324049396a0e3c0582eb}{getInterface}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{145 \textcolor{keyword}{    }\{}
\DoxyCodeLine{146         \mbox{\hyperlink{classjuce_1_1_com_smart_ptr}{ComSmartPtr<OtherComClass>}} destObject;}
\DoxyCodeLine{147 }
\DoxyCodeLine{148         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classjuce_1_1_com_smart_ptr_ad0628fe8c8859799c224b07719eaaf23}{QueryInterface}} (destObject) == S\_OK)}
\DoxyCodeLine{149             \textcolor{keywordflow}{return} destObject;}
\DoxyCodeLine{150 }
\DoxyCodeLine{151         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{152     \}}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \textcolor{keyword}{private}:}
\DoxyCodeLine{155     ComClass* p = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{156 }
\DoxyCodeLine{157     \textcolor{keywordtype}{void} release()  \{ \textcolor{keywordflow}{if} (p != \textcolor{keyword}{nullptr}) p-\/>Release(); \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159     ComClass** operator\&() noexcept; \textcolor{comment}{// private to avoid it being used accidentally}}
\DoxyCodeLine{160 \};}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{163 template <class First, class... ComClasses>}
\DoxyCodeLine{164 class \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base}{ComBaseClassHelperBase}}   : public First, public ComClasses...}
\DoxyCodeLine{165 \{}
\DoxyCodeLine{166 \textcolor{keyword}{public}:}
\DoxyCodeLine{167     \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base_ab760811435ba712698e6b64012906bac}{ComBaseClassHelperBase}} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} initialRefCount)  : refCount (initialRefCount) \{\}}
\DoxyCodeLine{168     \textcolor{keyword}{virtual} \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base_ad62d6365130b71cc91dba531b5f5b1b8}{\string~ComBaseClassHelperBase}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{169 }
\DoxyCodeLine{170     ULONG STDMETHODCALLTYPE \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base_ac733e63f0df21e183f8b80f1b5e59824}{AddRef}}()    \{ \textcolor{keywordflow}{return} ++refCount; \}}
\DoxyCodeLine{171     ULONG STDMETHODCALLTYPE \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base_ad67d52fc810aa95c6d3b3f933c9cb582}{Release}}()   \{ \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_aaa813f59532257ed092c4fad1b443fa5}{r}} = -\/-\/refCount; \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_aaa813f59532257ed092c4fad1b443fa5}{r}} == 0) \textcolor{keyword}{delete} \textcolor{keyword}{this}; \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacegl_aaa813f59532257ed092c4fad1b443fa5}{r}}; \}}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 \textcolor{keyword}{protected}:}
\DoxyCodeLine{174     ULONG \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base_a96e74b3a2dc8354c634396edea2de4ea}{refCount}};}
\DoxyCodeLine{175 }
\DoxyCodeLine{176     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base_a52f0b79bc42ccdbb15d2f8ef598357e0}{QueryInterface}} (REFIID refId, \textcolor{keywordtype}{void}** \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}})}
\DoxyCodeLine{177     \{}
\DoxyCodeLine{178         \textcolor{keywordflow}{if} (refId == \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_ae3b9af23b20d9586ee6bd9297ad38b73}{\_\_uuidof}} (IUnknown))}
\DoxyCodeLine{179             \textcolor{keywordflow}{return} castToType<First> (\mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{180 }
\DoxyCodeLine{181         *\mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{182         \textcolor{keywordflow}{return} E\_NOINTERFACE;}
\DoxyCodeLine{183     \}}
\DoxyCodeLine{184 }
\DoxyCodeLine{185     \textcolor{keyword}{template} <\textcolor{keyword}{class} Type>}
\DoxyCodeLine{186     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base_ab4e7db64d2a8ef306170517c8e8cad40}{castToType}} (\textcolor{keywordtype}{void}** \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}})}
\DoxyCodeLine{187     \{}
\DoxyCodeLine{188         this-\/>AddRef();}
\DoxyCodeLine{189         *\mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} = \textcolor{keyword}{dynamic\_cast<}Type*\textcolor{keyword}{>} (\textcolor{keyword}{this});}
\DoxyCodeLine{190 }
\DoxyCodeLine{191         \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{192     \}}
\DoxyCodeLine{193 \};}
\DoxyCodeLine{194 }
\DoxyCodeLine{199 \textcolor{keyword}{template} <\textcolor{keyword}{class}... ComClasses>}
\DoxyCodeLine{200 \textcolor{keyword}{class }\mbox{\hyperlink{classjuce_1_1_com_base_class_helper}{ComBaseClassHelper}}   : \textcolor{keyword}{public} \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base}{ComBaseClassHelperBase}}<ComClasses...>}
\DoxyCodeLine{201 \{}
\DoxyCodeLine{202 \textcolor{keyword}{public}:}
\DoxyCodeLine{203     \textcolor{keyword}{explicit} \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_a01462711b5b6b64f424e4ce75b7ac7a6}{ComBaseClassHelper}} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} initialRefCount = 1)}
\DoxyCodeLine{204         : \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base}{ComBaseClassHelperBase}}<ComClasses...> (initialRefCount) \{\}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_a9344fb3e0c17cf28ce02f1be313bece6}{QueryInterface}} (REFIID refId, \textcolor{keywordtype}{void}** \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}})}
\DoxyCodeLine{207     \{}
\DoxyCodeLine{208         \textcolor{keyword}{const} std::tuple<IID, void*> bases[]}
\DoxyCodeLine{209         \{}
\DoxyCodeLine{210             std::make\_tuple (\mbox{\hyperlink{juce__win32___com_smart_ptr_8h_ae3b9af23b20d9586ee6bd9297ad38b73}{\_\_uuidof}} (ComClasses),}
\DoxyCodeLine{211                              \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{void}*\textcolor{keyword}{>} (\textcolor{keyword}{static\_cast<}ComClasses*\textcolor{keyword}{>} (\textcolor{keyword}{this})))...}
\DoxyCodeLine{212         \};}
\DoxyCodeLine{213 }
\DoxyCodeLine{214         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& base : bases)}
\DoxyCodeLine{215         \{}
\DoxyCodeLine{216             \textcolor{keywordflow}{if} (refId == std::get<0> (base))}
\DoxyCodeLine{217             \{}
\DoxyCodeLine{218                 this-\/>AddRef();}
\DoxyCodeLine{219                 *\mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} = std::get<1> (base);}
\DoxyCodeLine{220                 \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{221             \}}
\DoxyCodeLine{222         \}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224         \textcolor{keywordflow}{return} \mbox{\hyperlink{classjuce_1_1_com_base_class_helper_base_a52f0b79bc42ccdbb15d2f8ef598357e0}{ComBaseClassHelperBase<ComClasses...>::QueryInterface}} (refId, \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}});}
\DoxyCodeLine{225     \}}
\DoxyCodeLine{226 \};}
\DoxyCodeLine{227 }
\DoxyCodeLine{228 \mbox{\hyperlink{group__juce__core-system_ga157f2229764b17137d8814bec95df109}{JUCE\_END\_IGNORE\_WARNINGS\_GCC\_LIKE}}}
\DoxyCodeLine{229 }
\DoxyCodeLine{230 \} \textcolor{comment}{// namespace juce}}

\end{DoxyCode}
