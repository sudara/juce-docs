\hypertarget{juce__ios___camera_device_8h_source}{}\doxysection{juce\+\_\+ios\+\_\+\+Camera\+Device.\+h}
\label{juce__ios___camera_device_8h_source}\index{build/juce\_video/native/juce\_ios\_CameraDevice.h@{build/juce\_video/native/juce\_ios\_CameraDevice.h}}
\mbox{\hyperlink{juce__ios___camera_device_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{   This file is part of the JUCE library.}}
\DoxyCodeLine{5 \textcolor{comment}{   Copyright (c) 2020 -\/ Raw Material Software Limited}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{   JUCE is an open source library subject to commercial or open-\/source}}
\DoxyCodeLine{8 \textcolor{comment}{   licensing.}}
\DoxyCodeLine{9 \textcolor{comment}{}}
\DoxyCodeLine{10 \textcolor{comment}{   By using JUCE, you agree to the terms of both the JUCE 6 End-\/User License}}
\DoxyCodeLine{11 \textcolor{comment}{   Agreement and JUCE Privacy Policy (both effective as of the 16th June 2020).}}
\DoxyCodeLine{12 \textcolor{comment}{}}
\DoxyCodeLine{13 \textcolor{comment}{   End User License Agreement: www.juce.com/juce-\/6-\/licence}}
\DoxyCodeLine{14 \textcolor{comment}{   Privacy Policy: www.juce.com/juce-\/privacy-\/policy}}
\DoxyCodeLine{15 \textcolor{comment}{}}
\DoxyCodeLine{16 \textcolor{comment}{   Or: You may also use this code under the terms of the GPL v3 (see}}
\DoxyCodeLine{17 \textcolor{comment}{   www.gnu.org/licenses).}}
\DoxyCodeLine{18 \textcolor{comment}{}}
\DoxyCodeLine{19 \textcolor{comment}{   JUCE IS PROVIDED "{}AS IS"{} WITHOUT ANY WARRANTY, AND ALL WARRANTIES, WHETHER}}
\DoxyCodeLine{20 \textcolor{comment}{   EXPRESSED OR IMPLIED, INCLUDING MERCHANTABILITY AND FITNESS FOR PURPOSE, ARE}}
\DoxyCodeLine{21 \textcolor{comment}{   DISCLAIMED.}}
\DoxyCodeLine{22 \textcolor{comment}{}}
\DoxyCodeLine{23 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{24 \textcolor{comment}{*/}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#if (defined (\_\_IPHONE\_10\_0) \&\& \_\_IPHONE\_OS\_VERSION\_MAX\_ALLOWED >= \_\_IPHONE\_10\_0)}}
\DoxyCodeLine{27  \mbox{\hyperlink{group__juce__core-system_ga0112339834a6548e4123e394b9ed95e2}{JUCE\_BEGIN\_IGNORE\_WARNINGS\_GCC\_LIKE}} (\textcolor{stringliteral}{"{}-\/Wdeprecated-\/declarations"{}})}
\DoxyCodeLine{28  \textcolor{preprocessor}{\#define JUCE\_USE\_NEW\_CAMERA\_API 1}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_pimpl}{CameraDevice::Pimpl}}}
\DoxyCodeLine{32 \{}
\DoxyCodeLine{33     \textcolor{keyword}{using} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_aee53ed6db5b8ec3bdb39289775eabb76}{InternalOpenCameraResultCallback}} = \mbox{\hyperlink{namespacejuce_a7959b0b488fde11032d8151bf10669a4}{std::function}}<\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \textcolor{comment}{/*cameraId*/}, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \textcolor{comment}{/*error*/})>;}
\DoxyCodeLine{34 }
\DoxyCodeLine{35     \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a16f2fbdd1e08577b3db5d27f39696c22}{Pimpl}} (CameraDevice\& ownerToUse, \textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& cameraIdToUse, \textcolor{keywordtype}{int} \textcolor{comment}{/*index*/},}
\DoxyCodeLine{36            \textcolor{keywordtype}{int} \textcolor{comment}{/*minWidth*/}, \textcolor{keywordtype}{int} \textcolor{comment}{/*minHeight*/}, \textcolor{keywordtype}{int} \textcolor{comment}{/*maxWidth*/}, \textcolor{keywordtype}{int} \textcolor{comment}{/*maxHeight*/},}
\DoxyCodeLine{37            \textcolor{keywordtype}{bool} useHighQuality)}
\DoxyCodeLine{38         : owner (ownerToUse),}
\DoxyCodeLine{39           cameraId (cameraIdToUse),}
\DoxyCodeLine{40           captureSession (*this, useHighQuality)}
\DoxyCodeLine{41     \{}
\DoxyCodeLine{42     \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \mbox{\hyperlink{class_string}{String}} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a27ab46e6132462619815357d87b313d9}{getCameraId}}() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} cameraId; \}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6d14f00cad5a3be6c3490d6cb4d1dd28}{open}} (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_aee53ed6db5b8ec3bdb39289775eabb76}{InternalOpenCameraResultCallback}} cameraOpenCallbackToUse)}
\DoxyCodeLine{47     \{}
\DoxyCodeLine{48         cameraOpenCallback = \mbox{\hyperlink{namespacedsp_1_1detail_afe40dd96c3100ef2d29a2c0ab7947423}{std::move}} (cameraOpenCallbackToUse);}
\DoxyCodeLine{49 }
\DoxyCodeLine{50         \textcolor{keywordflow}{if} (cameraOpenCallback == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{51         \{}
\DoxyCodeLine{52             \textcolor{comment}{// A valid camera open callback must be passed.}}
\DoxyCodeLine{53             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{54             \textcolor{keywordflow}{return};}
\DoxyCodeLine{55         \}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57         [AVCaptureDevice requestAccessForMediaType: AVMediaTypeVideo}
\DoxyCodeLine{58                                  completionHandler: \string^(BOOL granted)}
\DoxyCodeLine{59          \{}
\DoxyCodeLine{60              \textcolor{comment}{// Access to video is required for camera to work,}}
\DoxyCodeLine{61              \textcolor{comment}{// black images will be produced otherwise!}}
\DoxyCodeLine{62              \mbox{\hyperlink{group__juce__core-system_ga61fbc12f0f914e38d0d26e6b4f3ee760}{jassertquiet}} (granted);}
\DoxyCodeLine{63          \}];}
\DoxyCodeLine{64 }
\DoxyCodeLine{65         [AVCaptureDevice requestAccessForMediaType: AVMediaTypeAudio}
\DoxyCodeLine{66                                  completionHandler: \string^(BOOL granted)}
\DoxyCodeLine{67          \{}
\DoxyCodeLine{68              \textcolor{comment}{// Access to audio is required for camera to work,}}
\DoxyCodeLine{69              \textcolor{comment}{// silence will be produced otherwise!}}
\DoxyCodeLine{70              \mbox{\hyperlink{group__juce__core-system_ga61fbc12f0f914e38d0d26e6b4f3ee760}{jassertquiet}} (granted);}
\DoxyCodeLine{71          \}];}
\DoxyCodeLine{72 }
\DoxyCodeLine{73         captureSession.startSessionForDeviceWithId (cameraId);}
\DoxyCodeLine{74     \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{keywordtype}{bool} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} captureSession.openedOk(); \}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5167029331352275c3f62be288392d93}{takeStillPicture}} (\mbox{\hyperlink{namespacejuce_a7959b0b488fde11032d8151bf10669a4}{std::function}}<\textcolor{keywordtype}{void} (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\&)> pictureTakenCallbackToUse)}
\DoxyCodeLine{79     \{}
\DoxyCodeLine{80         \textcolor{keywordflow}{if} (pictureTakenCallbackToUse == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{81         \{}
\DoxyCodeLine{82             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{83             \textcolor{keywordflow}{return};}
\DoxyCodeLine{84         \}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86         pictureTakenCallback = \mbox{\hyperlink{namespacedsp_1_1detail_afe40dd96c3100ef2d29a2c0ab7947423}{std::move}} (pictureTakenCallbackToUse);}
\DoxyCodeLine{87 }
\DoxyCodeLine{88         triggerStillPictureCapture();}
\DoxyCodeLine{89     \}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_afb3d92c684c0bc97a6e2eca8cbb3fa05}{startRecordingToFile}} (\textcolor{keyword}{const} \mbox{\hyperlink{class_file}{File}}\& file, \textcolor{keywordtype}{int} \textcolor{comment}{/*quality*/})}
\DoxyCodeLine{92     \{}
\DoxyCodeLine{93         file.\mbox{\hyperlink{class_file_adc64f67a869db306afd65a67758e5a3e}{deleteFile}}();}
\DoxyCodeLine{94 }
\DoxyCodeLine{95         captureSession.startRecording (file);}
\DoxyCodeLine{96     \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac33ca230910ae42b3171bd149ef0f84e}{stopRecording}}()}
\DoxyCodeLine{99     \{}
\DoxyCodeLine{100         captureSession.stopRecording();}
\DoxyCodeLine{101     \}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103     \mbox{\hyperlink{class_time}{Time}} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a140af780d9abb52ff7f4408c47a69beb}{getTimeOfFirstRecordedFrame}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{104 \textcolor{keyword}{    }\{}
\DoxyCodeLine{105         \textcolor{keywordflow}{return} captureSession.getTimeOfFirstRecordedFrame();}
\DoxyCodeLine{106     \}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     \textcolor{keyword}{static} \mbox{\hyperlink{class_string_array}{StringArray}} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac9188d9367c011ba618a1fade6f01401}{getAvailableDevices}}()}
\DoxyCodeLine{109     \{}
\DoxyCodeLine{110         \mbox{\hyperlink{class_string_array}{StringArray}} results;}
\DoxyCodeLine{111 }
\DoxyCodeLine{112         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Available camera devices: "{}});}
\DoxyCodeLine{113 }
\DoxyCodeLine{114         \textcolor{keywordflow}{for} (AVCaptureDevice* device \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} getDevices())}
\DoxyCodeLine{115         \{}
\DoxyCodeLine{116             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Device start-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{117             printDebugCameraInfo (device);}
\DoxyCodeLine{118             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Device end-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{119 }
\DoxyCodeLine{120             results.\mbox{\hyperlink{class_string_array_a18cb8087b39a81c462e9c67b03453901}{add}} (\mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (device.uniqueID));}
\DoxyCodeLine{121         \}}
\DoxyCodeLine{122 }
\DoxyCodeLine{123         \textcolor{keywordflow}{return} results;}
\DoxyCodeLine{124     \}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a631a4ade218dfddc56d588c5b03fd1ca}{addListener}} (CameraDevice::Listener* listenerToAdd)}
\DoxyCodeLine{127     \{}
\DoxyCodeLine{128         \textcolor{keyword}{const} \mbox{\hyperlink{class_generic_scoped_lock}{ScopedLock}} sl (listenerLock);}
\DoxyCodeLine{129         listeners.add (listenerToAdd);}
\DoxyCodeLine{130 }
\DoxyCodeLine{131         \textcolor{keywordflow}{if} (listeners.size() == 1)}
\DoxyCodeLine{132             triggerStillPictureCapture();}
\DoxyCodeLine{133     \}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135     \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a39c0df63795c33e8e22f16451349a36f}{removeListener}} (CameraDevice::Listener* listenerToRemove)}
\DoxyCodeLine{136     \{}
\DoxyCodeLine{137         \textcolor{keyword}{const} \mbox{\hyperlink{class_generic_scoped_lock}{ScopedLock}} sl (listenerLock);}
\DoxyCodeLine{138         listeners.remove (listenerToRemove);}
\DoxyCodeLine{139     \}}
\DoxyCodeLine{140 }
\DoxyCodeLine{141 \textcolor{keyword}{private}:}
\DoxyCodeLine{142     \textcolor{keyword}{static} NSArray<AVCaptureDevice*>* getDevices()}
\DoxyCodeLine{143     \{}
\DoxyCodeLine{144 \textcolor{preprocessor}{       \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{145         \textcolor{keywordflow}{if} (@available (iOS 10.0, *))}
\DoxyCodeLine{146         \{}
\DoxyCodeLine{147             std::unique\_ptr<NSMutableArray<AVCaptureDeviceType>, NSObjectDeleter> deviceTypes ([[NSMutableArray alloc] initWithCapacity: 2]);}
\DoxyCodeLine{148 }
\DoxyCodeLine{149             [deviceTypes.get() addObject: AVCaptureDeviceTypeBuiltInWideAngleCamera];}
\DoxyCodeLine{150             [deviceTypes.get() addObject: AVCaptureDeviceTypeBuiltInTelephotoCamera];}
\DoxyCodeLine{151 }
\DoxyCodeLine{152             \textcolor{keywordflow}{if} (@available (iOS 10.2, *))}
\DoxyCodeLine{153                 [deviceTypes.get() addObject: AVCaptureDeviceTypeBuiltInDualCamera];}
\DoxyCodeLine{154 }
\DoxyCodeLine{155             \textcolor{keywordflow}{if} (@available (iOS 11.1, *))}
\DoxyCodeLine{156                 [deviceTypes.get() addObject: AVCaptureDeviceTypeBuiltInTrueDepthCamera];}
\DoxyCodeLine{157 }
\DoxyCodeLine{158             \textcolor{keyword}{auto} discoverySession = [AVCaptureDeviceDiscoverySession discoverySessionWithDeviceTypes: deviceTypes.get()}
\DoxyCodeLine{159                                                                                            mediaType: AVMediaTypeVideo}
\DoxyCodeLine{160                                                                                             position: AVCaptureDevicePositionUnspecified];}
\DoxyCodeLine{161 }
\DoxyCodeLine{162             \textcolor{keywordflow}{return} [discoverySession devices];}
\DoxyCodeLine{163         \}}
\DoxyCodeLine{164 \textcolor{preprocessor}{       \#endif}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166         \textcolor{keywordflow}{return} [AVCaptureDevice devicesWithMediaType: AVMediaTypeVideo];}
\DoxyCodeLine{167     \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{170     \textcolor{keyword}{static} \textcolor{keywordtype}{void} printDebugCameraInfo (AVCaptureDevice* device)}
\DoxyCodeLine{171     \{}
\DoxyCodeLine{172         \textcolor{keyword}{auto} position = device.position;}
\DoxyCodeLine{173 }
\DoxyCodeLine{174         \mbox{\hyperlink{class_string}{String}} positionString = position == AVCaptureDevicePositionBack}
\DoxyCodeLine{175                               ? \textcolor{stringliteral}{"{}Back"{}}}
\DoxyCodeLine{176                               : position == AVCaptureDevicePositionFront}
\DoxyCodeLine{177                                          ? \textcolor{stringliteral}{"{}Front"{}}}
\DoxyCodeLine{178                                          : \textcolor{stringliteral}{"{}Unspecified"{}};}
\DoxyCodeLine{179 }
\DoxyCodeLine{180         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Position: "{}} + positionString);}
\DoxyCodeLine{181         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Model ID: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (device.modelID));}
\DoxyCodeLine{182         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Localized name: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (device.localizedName));}
\DoxyCodeLine{183         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Unique ID: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (device.uniqueID));}
\DoxyCodeLine{184         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Lens aperture: "{}} + \mbox{\hyperlink{class_string}{String}} (device.lensAperture));}
\DoxyCodeLine{185 }
\DoxyCodeLine{186         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Has flash: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})device.hasFlash));}
\DoxyCodeLine{187         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports flash always on: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isFlashModeSupported: AVCaptureFlashModeOn]));}
\DoxyCodeLine{188         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports auto flash: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isFlashModeSupported: AVCaptureFlashModeAuto]));}
\DoxyCodeLine{189 }
\DoxyCodeLine{190         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Has torch: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})device.hasTorch));}
\DoxyCodeLine{191         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports torch always on: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isTorchModeSupported: AVCaptureTorchModeOn]));}
\DoxyCodeLine{192         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports auto torch: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isTorchModeSupported: AVCaptureTorchModeAuto]));}
\DoxyCodeLine{193 }
\DoxyCodeLine{194         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Low light boost supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})device.lowLightBoostEnabled));}
\DoxyCodeLine{195 }
\DoxyCodeLine{196         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports auto white balance: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isWhiteBalanceModeSupported: AVCaptureWhiteBalanceModeAutoWhiteBalance]));}
\DoxyCodeLine{197         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports continuous auto white balance: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isWhiteBalanceModeSupported: AVCaptureWhiteBalanceModeContinuousAutoWhiteBalance]));}
\DoxyCodeLine{198 }
\DoxyCodeLine{199         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports auto focus: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isFocusModeSupported: AVCaptureFocusModeAutoFocus]));}
\DoxyCodeLine{200         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports continuous auto focus: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isFocusModeSupported: AVCaptureFocusModeContinuousAutoFocus]));}
\DoxyCodeLine{201         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports point of interest focus: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})device.focusPointOfInterestSupported));}
\DoxyCodeLine{202         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Smooth auto focus supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})device.smoothAutoFocusSupported));}
\DoxyCodeLine{203         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Auto focus range restriction supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})device.autoFocusRangeRestrictionSupported));}
\DoxyCodeLine{204 }
\DoxyCodeLine{205         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports auto exposure: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isExposureModeSupported: AVCaptureExposureModeAutoExpose]));}
\DoxyCodeLine{206         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports continuous auto exposure: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isExposureModeSupported: AVCaptureExposureModeContinuousAutoExposure]));}
\DoxyCodeLine{207         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports custom exposure: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})[device isExposureModeSupported: AVCaptureExposureModeCustom]));}
\DoxyCodeLine{208         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports point of interest exposure: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})device.exposurePointOfInterestSupported));}
\DoxyCodeLine{209 }
\DoxyCodeLine{210 \textcolor{preprocessor}{       \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{211         \textcolor{keywordflow}{if} (@available (iOS 10.0, *))}
\DoxyCodeLine{212         \{}
\DoxyCodeLine{213             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Device type: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (device.deviceType));}
\DoxyCodeLine{214             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Locking focus with custom lens position supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int})device.lockingFocusWithCustomLensPositionSupported));}
\DoxyCodeLine{215         \}}
\DoxyCodeLine{216 \textcolor{preprocessor}{       \#endif}}
\DoxyCodeLine{217 }
\DoxyCodeLine{218 \textcolor{preprocessor}{       \#if defined (\_\_IPHONE\_11\_0) \&\& \_\_IPHONE\_OS\_VERSION\_MAX\_ALLOWED >= \_\_IPHONE\_11\_0}}
\DoxyCodeLine{219         \textcolor{keywordflow}{if} (@available (iOS 11.0, *))}
\DoxyCodeLine{220         \{}
\DoxyCodeLine{221             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Min available video zoom factor: "{}} + \mbox{\hyperlink{class_string}{String}} (device.minAvailableVideoZoomFactor));}
\DoxyCodeLine{222             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Max available video zoom factor: "{}} + \mbox{\hyperlink{class_string}{String}} (device.maxAvailableVideoZoomFactor));}
\DoxyCodeLine{223             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Dual camera switch over video zoom factor: "{}} + \mbox{\hyperlink{class_string}{String}} (device.dualCameraSwitchOverVideoZoomFactor));}
\DoxyCodeLine{224         \}}
\DoxyCodeLine{225 \textcolor{preprocessor}{       \#endif}}
\DoxyCodeLine{226 }
\DoxyCodeLine{227         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Capture formats start-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{228         \textcolor{keywordflow}{for} (AVCaptureDeviceFormat* \mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} device.formats)}
\DoxyCodeLine{229         \{}
\DoxyCodeLine{230             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Capture format start-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{231             printDebugCameraFormatInfo (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}});}
\DoxyCodeLine{232             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Capture format end-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{233         \}}
\DoxyCodeLine{234         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Capture formats end-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{235     \}}
\DoxyCodeLine{236 }
\DoxyCodeLine{237     \textcolor{keyword}{static} \textcolor{keywordtype}{void} printDebugCameraFormatInfo (AVCaptureDeviceFormat* \mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}})}
\DoxyCodeLine{238     \{}
\DoxyCodeLine{239         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Media type: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.mediaType));}
\DoxyCodeLine{240 }
\DoxyCodeLine{241 \textcolor{preprocessor}{       \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{242         \textcolor{keywordflow}{if} (@available (iOS 10.0, *))}
\DoxyCodeLine{243         \{}
\DoxyCodeLine{244             \mbox{\hyperlink{class_string}{String}} colourSpaces;}
\DoxyCodeLine{245 }
\DoxyCodeLine{246             \textcolor{keywordflow}{for} (NSNumber* number \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} \mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.supportedColorSpaces)}
\DoxyCodeLine{247             \{}
\DoxyCodeLine{248                 \textcolor{keywordflow}{switch} ([number intValue])}
\DoxyCodeLine{249                 \{}
\DoxyCodeLine{250                     \textcolor{keywordflow}{case} AVCaptureColorSpace\_sRGB:   colourSpaces << \textcolor{stringliteral}{"{}sRGB "{}};  \textcolor{keywordflow}{break};}
\DoxyCodeLine{251                     \textcolor{keywordflow}{case} AVCaptureColorSpace\_P3\_D65: colourSpaces << \textcolor{stringliteral}{"{}P3\_D65 "{}}; \textcolor{keywordflow}{break};}
\DoxyCodeLine{252                     \textcolor{keywordflow}{default}: \textcolor{keywordflow}{break};}
\DoxyCodeLine{253                 \}}
\DoxyCodeLine{254             \}}
\DoxyCodeLine{255 }
\DoxyCodeLine{256             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supported colour spaces: "{}} + colourSpaces);}
\DoxyCodeLine{257         \}}
\DoxyCodeLine{258 \textcolor{preprocessor}{       \#endif}}
\DoxyCodeLine{259 }
\DoxyCodeLine{260         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Video field of view: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.videoFieldOfView));}
\DoxyCodeLine{261         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Video max zoom factor: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.videoMaxZoomFactor));}
\DoxyCodeLine{262         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Video zoom factor upscale threshold: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.videoZoomFactorUpscaleThreshold));}
\DoxyCodeLine{263 }
\DoxyCodeLine{264         \mbox{\hyperlink{class_string}{String}} videoFrameRateRangesString = \textcolor{stringliteral}{"{}Video supported frame rate ranges: "{}};}
\DoxyCodeLine{265 }
\DoxyCodeLine{266         \textcolor{keywordflow}{for} (AVFrameRateRange* \mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} \mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.videoSupportedFrameRateRanges)}
\DoxyCodeLine{267             videoFrameRateRangesString << frameRateRangeToString (\mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}});}
\DoxyCodeLine{268         JUCE\_CAMERA\_LOG (videoFrameRateRangesString);}
\DoxyCodeLine{269 }
\DoxyCodeLine{270         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Video binned: "{}} + \mbox{\hyperlink{class_string}{String}} (\textcolor{keywordtype}{int} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.videoBinned)));}
\DoxyCodeLine{271 }
\DoxyCodeLine{272         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Video HDR supported: "{}} + \mbox{\hyperlink{class_string}{String}} (\textcolor{keywordtype}{int} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.videoHDRSupported)));}
\DoxyCodeLine{273         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}High resolution still image dimensions: "{}} + getHighResStillImgDimensionsString (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.highResolutionStillImageDimensions));}
\DoxyCodeLine{274         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Min ISO: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.minISO));}
\DoxyCodeLine{275         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Max ISO: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.maxISO));}
\DoxyCodeLine{276         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Min exposure duration: "{}} + cmTimeToString (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.minExposureDuration));}
\DoxyCodeLine{277 }
\DoxyCodeLine{278         \mbox{\hyperlink{class_string}{String}} autoFocusSystemString;}
\DoxyCodeLine{279         \textcolor{keywordflow}{switch} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.autoFocusSystem)}
\DoxyCodeLine{280         \{}
\DoxyCodeLine{281             \textcolor{keywordflow}{case} AVCaptureAutoFocusSystemPhaseDetection:    autoFocusSystemString = \textcolor{stringliteral}{"{}PhaseDetection"{}};    \textcolor{keywordflow}{break};}
\DoxyCodeLine{282             \textcolor{keywordflow}{case} AVCaptureAutoFocusSystemContrastDetection: autoFocusSystemString = \textcolor{stringliteral}{"{}ContrastDetection"{}}; \textcolor{keywordflow}{break};}
\DoxyCodeLine{283             \textcolor{keywordflow}{case} AVCaptureAutoFocusSystemNone:}
\DoxyCodeLine{284             \textcolor{keywordflow}{default}:                                        autoFocusSystemString = \textcolor{stringliteral}{"{}None"{}};}
\DoxyCodeLine{285         \}}
\DoxyCodeLine{286         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Auto focus system: "{}} + autoFocusSystemString);}
\DoxyCodeLine{287 }
\DoxyCodeLine{288         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Standard (iOS 5.0) video stabilization supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) [\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}} isVideoStabilizationModeSupported: AVCaptureVideoStabilizationModeStandard]));}
\DoxyCodeLine{289         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Cinematic video stabilization supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) [\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}} isVideoStabilizationModeSupported: AVCaptureVideoStabilizationModeCinematic]));}
\DoxyCodeLine{290         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Auto video stabilization supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) [\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}} isVideoStabilizationModeSupported: AVCaptureVideoStabilizationModeAuto]));}
\DoxyCodeLine{291 }
\DoxyCodeLine{292 \textcolor{preprocessor}{       \#if defined (\_\_IPHONE\_11\_0) \&\& \_\_IPHONE\_OS\_VERSION\_MAX\_ALLOWED >= \_\_IPHONE\_11\_0}}
\DoxyCodeLine{293         \textcolor{keywordflow}{if} (@available (iOS 11.0, *))}
\DoxyCodeLine{294         \{}
\DoxyCodeLine{295             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Min zoom factor for depth data delivery: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.videoMinZoomFactorForDepthDataDelivery));}
\DoxyCodeLine{296             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Max zoom factor for depth data delivery: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_a597b77c61fc6d444d2bfc6bf69dee277}{format}}.videoMaxZoomFactorForDepthDataDelivery));}
\DoxyCodeLine{297         \}}
\DoxyCodeLine{298 \textcolor{preprocessor}{       \#endif}}
\DoxyCodeLine{299     \}}
\DoxyCodeLine{300 }
\DoxyCodeLine{301     \textcolor{keyword}{static} \mbox{\hyperlink{class_string}{String}} getHighResStillImgDimensionsString (CMVideoDimensions d)}
\DoxyCodeLine{302     \{}
\DoxyCodeLine{303         \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}["{}} + \mbox{\hyperlink{class_string}{String}} (d.width) + \textcolor{stringliteral}{"{} "{}} + \mbox{\hyperlink{class_string}{String}} (d.height) + \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{304     \}}
\DoxyCodeLine{305 }
\DoxyCodeLine{306     \textcolor{keyword}{static} \mbox{\hyperlink{class_string}{String}} cmTimeToString (CMTime time)}
\DoxyCodeLine{307     \{}
\DoxyCodeLine{308         CFUniquePtr<CFStringRef> timeDesc (CMTimeCopyDescription (\textcolor{keyword}{nullptr}, time));}
\DoxyCodeLine{309         \textcolor{keywordflow}{return} String::fromCFString (timeDesc.get());}
\DoxyCodeLine{310     \}}
\DoxyCodeLine{311 }
\DoxyCodeLine{312     \textcolor{keyword}{static} \mbox{\hyperlink{class_string}{String}} frameRateRangeToString (AVFrameRateRange* \mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}})}
\DoxyCodeLine{313     \{}
\DoxyCodeLine{314         \mbox{\hyperlink{class_string}{String}} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}};}
\DoxyCodeLine{315         \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} << \textcolor{stringliteral}{"{}[minFrameDuration: "{}} + cmTimeToString (\mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}}.minFrameDuration);}
\DoxyCodeLine{316         \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} << \textcolor{stringliteral}{"{} maxFrameDuration: "{}} + cmTimeToString (\mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}}.maxFrameDuration);}
\DoxyCodeLine{317         \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} << \textcolor{stringliteral}{"{} minFrameRate: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}}.minFrameRate);}
\DoxyCodeLine{318         \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}} << \textcolor{stringliteral}{"{} maxFrameRate: "{}} + \mbox{\hyperlink{class_string}{String}} (\mbox{\hyperlink{namespacegl_ae32af3c263eaecc21093939cdb44aaf3}{range}}.maxFrameRate) << \textcolor{stringliteral}{"{}] "{}};}
\DoxyCodeLine{319 }
\DoxyCodeLine{320         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacegl_a7cb1126dbc1cb105bcce082cff5ae633}{result}};}
\DoxyCodeLine{321     \}}
\DoxyCodeLine{322 }
\DoxyCodeLine{323     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{324     \textcolor{keyword}{class }CaptureSession}
\DoxyCodeLine{325     \{}
\DoxyCodeLine{326     \textcolor{keyword}{public}:}
\DoxyCodeLine{327         CaptureSession (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& ownerToUse, \textcolor{keywordtype}{bool} useHighQuality)}
\DoxyCodeLine{328             : owner (ownerToUse),}
\DoxyCodeLine{329               captureSessionQueue (dispatch\_queue\_create (\textcolor{stringliteral}{"{}JuceCameraDeviceBackgroundDispatchQueue"{}}, DISPATCH\_QUEUE\_SERIAL)),}
\DoxyCodeLine{330               captureSession ([[AVCaptureSession alloc] init]),}
\DoxyCodeLine{331               delegate (nullptr),}
\DoxyCodeLine{332               stillPictureTaker (*this),}
\DoxyCodeLine{333               videoRecorder (*this)}
\DoxyCodeLine{334         \{}
\DoxyCodeLine{335             \textcolor{keyword}{static} SessionDelegateClass cls;}
\DoxyCodeLine{336             delegate.reset ([cls.createInstance() init]);}
\DoxyCodeLine{337             SessionDelegateClass::setOwner (delegate.get(), \textcolor{keyword}{this});}
\DoxyCodeLine{338 }
\DoxyCodeLine{339             \mbox{\hyperlink{group__juce__core-system_ga0112339834a6548e4123e394b9ed95e2}{JUCE\_BEGIN\_IGNORE\_WARNINGS\_GCC\_LIKE}} (\textcolor{stringliteral}{"{}-\/Wundeclared-\/selector"{}})}
\DoxyCodeLine{340             [[NSNotificationCenter defaultCenter] addObserver: delegate.get()}
\DoxyCodeLine{341                                                      selector: \textcolor{keyword}{@selector} (sessionDidStartRunning:)}
\DoxyCodeLine{342                                                          \mbox{\hyperlink{namespacegl_a23f4d6c2fb3e8fdfb824894be7a695c2}{name}}: AVCaptureSessionDidStartRunningNotification}
\DoxyCodeLine{343                                                        \textcolor{keywordtype}{object}: captureSession.get()];}
\DoxyCodeLine{344 }
\DoxyCodeLine{345             [[NSNotificationCenter defaultCenter] addObserver: delegate.get()}
\DoxyCodeLine{346                                                      selector: \textcolor{keyword}{@selector} (sessionDidStopRunning:)}
\DoxyCodeLine{347                                                          \mbox{\hyperlink{namespacegl_a23f4d6c2fb3e8fdfb824894be7a695c2}{name}}: AVCaptureSessionDidStopRunningNotification}
\DoxyCodeLine{348                                                        \textcolor{keywordtype}{object}: captureSession.get()];}
\DoxyCodeLine{349 }
\DoxyCodeLine{350             [[NSNotificationCenter defaultCenter] addObserver: delegate.get()}
\DoxyCodeLine{351                                                      selector: \textcolor{keyword}{@selector} (runtimeError:)}
\DoxyCodeLine{352                                                          \mbox{\hyperlink{namespacegl_a23f4d6c2fb3e8fdfb824894be7a695c2}{name}}: AVCaptureSessionRuntimeErrorNotification}
\DoxyCodeLine{353                                                        \textcolor{keywordtype}{object}: captureSession.get()];}
\DoxyCodeLine{354 }
\DoxyCodeLine{355             [[NSNotificationCenter defaultCenter] addObserver: delegate.get()}
\DoxyCodeLine{356                                                      selector: \textcolor{keyword}{@selector} (sessionWasInterrupted:)}
\DoxyCodeLine{357                                                          \mbox{\hyperlink{namespacegl_a23f4d6c2fb3e8fdfb824894be7a695c2}{name}}: AVCaptureSessionWasInterruptedNotification}
\DoxyCodeLine{358                                                        \textcolor{keywordtype}{object}: captureSession.get()];}
\DoxyCodeLine{359 }
\DoxyCodeLine{360             [[NSNotificationCenter defaultCenter] addObserver: delegate.get()}
\DoxyCodeLine{361                                                      selector: \textcolor{keyword}{@selector} (sessionInterruptionEnded:)}
\DoxyCodeLine{362                                                          \mbox{\hyperlink{namespacegl_a23f4d6c2fb3e8fdfb824894be7a695c2}{name}}: AVCaptureSessionInterruptionEndedNotification}
\DoxyCodeLine{363                                                        \textcolor{keywordtype}{object}: captureSession.get()];}
\DoxyCodeLine{364             \mbox{\hyperlink{group__juce__core-system_ga157f2229764b17137d8814bec95df109}{JUCE\_END\_IGNORE\_WARNINGS\_GCC\_LIKE}}}
\DoxyCodeLine{365 }
\DoxyCodeLine{366             dispatch\_async (captureSessionQueue,\string^}
\DoxyCodeLine{367                             \{}
\DoxyCodeLine{368                                 [captureSession.get() setSessionPreset: useHighQuality ? AVCaptureSessionPresetHigh}
\DoxyCodeLine{369                                                                                        : AVCaptureSessionPresetMedium];}
\DoxyCodeLine{370                             \});}
\DoxyCodeLine{371 }
\DoxyCodeLine{372             ++numCaptureSessions;}
\DoxyCodeLine{373         \}}
\DoxyCodeLine{374 }
\DoxyCodeLine{375         \string~CaptureSession()}
\DoxyCodeLine{376         \{}
\DoxyCodeLine{377             [[NSNotificationCenter defaultCenter] removeObserver: delegate.get()];}
\DoxyCodeLine{378 }
\DoxyCodeLine{379             \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac33ca230910ae42b3171bd149ef0f84e}{stopRecording}}();}
\DoxyCodeLine{380 }
\DoxyCodeLine{381             \textcolor{keywordflow}{if} (-\/-\/numCaptureSessions == 0)}
\DoxyCodeLine{382             \{}
\DoxyCodeLine{383                 dispatch\_async (captureSessionQueue, \string^}
\DoxyCodeLine{384                                 \{}
\DoxyCodeLine{385                                     \textcolor{keywordflow}{if} (captureSession.get().running)}
\DoxyCodeLine{386                                         [captureSession.get() stopRunning];}
\DoxyCodeLine{387 }
\DoxyCodeLine{388                                     sessionClosedEvent.signal();}
\DoxyCodeLine{389                                 \});}
\DoxyCodeLine{390 }
\DoxyCodeLine{391                 sessionClosedEvent.wait (-\/1);}
\DoxyCodeLine{392             \}}
\DoxyCodeLine{393         \}}
\DoxyCodeLine{394 }
\DoxyCodeLine{395         \textcolor{keywordtype}{bool} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}() \mbox{\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const}} noexcept \{ \textcolor{keywordflow}{return} sessionStarted; \}}
\DoxyCodeLine{396 }
\DoxyCodeLine{397         \textcolor{keywordtype}{void} startSessionForDeviceWithId (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& cameraIdToUse)}
\DoxyCodeLine{398         \{}
\DoxyCodeLine{399             dispatch\_async (captureSessionQueue,\string^}
\DoxyCodeLine{400                             \{}
\DoxyCodeLine{401                                 cameraDevice = [AVCaptureDevice deviceWithUniqueID: \mbox{\hyperlink{namespacejuce_aad733be42bb4bbaddc08213b864faf9c}{juceStringToNS}} (cameraIdToUse)];}
\DoxyCodeLine{402                                 \textcolor{keyword}{auto} audioDevice = [AVCaptureDevice defaultDeviceWithMediaType: AVMediaTypeAudio];}
\DoxyCodeLine{403 }
\DoxyCodeLine{404                                 [captureSession.get() beginConfiguration];}
\DoxyCodeLine{405 }
\DoxyCodeLine{406                                 \textcolor{comment}{// This will add just video...}}
\DoxyCodeLine{407                                 \textcolor{keyword}{auto} \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} = addInputToDevice (cameraDevice);}
\DoxyCodeLine{408 }
\DoxyCodeLine{409                                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.\mbox{\hyperlink{class_string_a46001a29fcbd7c867f0f3a42598a1495}{isNotEmpty}}())}
\DoxyCodeLine{410                                 \{}
\DoxyCodeLine{411                                     \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([weakRef = \mbox{\hyperlink{class_weak_reference}{WeakReference<CaptureSession>}} \{ \textcolor{keyword}{this} \}, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}]() \textcolor{keyword}{mutable}}
\DoxyCodeLine{412                                     \{}
\DoxyCodeLine{413                                         \textcolor{keywordflow}{if} (weakRef != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{414                                             weakRef-\/>owner.cameraOpenCallback (\{\}, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{415                                     \});}
\DoxyCodeLine{416 }
\DoxyCodeLine{417                                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{418                                 \}}
\DoxyCodeLine{419 }
\DoxyCodeLine{420                                 \textcolor{comment}{// ... so add audio explicitly here}}
\DoxyCodeLine{421                                 \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} = addInputToDevice (audioDevice);}
\DoxyCodeLine{422 }
\DoxyCodeLine{423                                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.\mbox{\hyperlink{class_string_a46001a29fcbd7c867f0f3a42598a1495}{isNotEmpty}}())}
\DoxyCodeLine{424                                 \{}
\DoxyCodeLine{425                                     \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([weakRef = \mbox{\hyperlink{class_weak_reference}{WeakReference<CaptureSession>}} \{ \textcolor{keyword}{this} \}, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}]() \textcolor{keyword}{mutable}}
\DoxyCodeLine{426                                     \{}
\DoxyCodeLine{427                                         \textcolor{keywordflow}{if} (weakRef != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{428                                             weakRef-\/>owner.cameraOpenCallback (\{\}, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{429                                     \});}
\DoxyCodeLine{430 }
\DoxyCodeLine{431                                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{432                                 \}}
\DoxyCodeLine{433 }
\DoxyCodeLine{434                                 [captureSession.get() commitConfiguration];}
\DoxyCodeLine{435 }
\DoxyCodeLine{436                                 \textcolor{keywordflow}{if} (! captureSession.get().running)}
\DoxyCodeLine{437                                     [captureSession.get() startRunning];}
\DoxyCodeLine{438                             \});}
\DoxyCodeLine{439         \}}
\DoxyCodeLine{440 }
\DoxyCodeLine{441         AVCaptureVideoPreviewLayer* createPreviewLayer()}
\DoxyCodeLine{442         \{}
\DoxyCodeLine{443             \textcolor{keywordflow}{if} (! \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}())}
\DoxyCodeLine{444             \{}
\DoxyCodeLine{445                 \textcolor{comment}{// A session must be started first!}}
\DoxyCodeLine{446                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{447                 \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{448             \}}
\DoxyCodeLine{449 }
\DoxyCodeLine{450             previewLayer = [AVCaptureVideoPreviewLayer layerWithSession: captureSession.get()];}
\DoxyCodeLine{451             \textcolor{keywordflow}{return} previewLayer;}
\DoxyCodeLine{452         \}}
\DoxyCodeLine{453 }
\DoxyCodeLine{454         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5167029331352275c3f62be288392d93}{takeStillPicture}}()}
\DoxyCodeLine{455         \{}
\DoxyCodeLine{456             \textcolor{keywordflow}{if} (! \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}())}
\DoxyCodeLine{457             \{}
\DoxyCodeLine{458                 \textcolor{comment}{// A session must be started first!}}
\DoxyCodeLine{459                 \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}());}
\DoxyCodeLine{460                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{461             \}}
\DoxyCodeLine{462 }
\DoxyCodeLine{463             stillPictureTaker.takePicture (previewLayer.connection.videoOrientation);}
\DoxyCodeLine{464         \}}
\DoxyCodeLine{465 }
\DoxyCodeLine{466         \textcolor{keywordtype}{void} startRecording (\textcolor{keyword}{const} \mbox{\hyperlink{class_file}{File}}\& file)}
\DoxyCodeLine{467         \{}
\DoxyCodeLine{468             \textcolor{keywordflow}{if} (! \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a79d3488e0970fce52d753c9c0c81aa34}{openedOk}}())}
\DoxyCodeLine{469             \{}
\DoxyCodeLine{470                 \textcolor{comment}{// A session must be started first!}}
\DoxyCodeLine{471                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{472                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{473             \}}
\DoxyCodeLine{474 }
\DoxyCodeLine{475             \textcolor{keywordflow}{if} (file.\mbox{\hyperlink{class_file_a2d79c296f148b00041aeeac0013716d9}{existsAsFile}}())}
\DoxyCodeLine{476             \{}
\DoxyCodeLine{477                 \textcolor{comment}{// File overwriting is not supported by iOS video recorder, the target}}
\DoxyCodeLine{478                 \textcolor{comment}{// file must not exist.}}
\DoxyCodeLine{479                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{480                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{481             \}}
\DoxyCodeLine{482 }
\DoxyCodeLine{483             videoRecorder.startRecording (file, previewLayer.connection.videoOrientation);}
\DoxyCodeLine{484         \}}
\DoxyCodeLine{485 }
\DoxyCodeLine{486         \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac33ca230910ae42b3171bd149ef0f84e}{stopRecording}}()}
\DoxyCodeLine{487         \{}
\DoxyCodeLine{488             videoRecorder.stopRecording();}
\DoxyCodeLine{489         \}}
\DoxyCodeLine{490 }
\DoxyCodeLine{491         \mbox{\hyperlink{class_time}{Time}} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a140af780d9abb52ff7f4408c47a69beb}{getTimeOfFirstRecordedFrame}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{492 \textcolor{keyword}{        }\{}
\DoxyCodeLine{493             \textcolor{keywordflow}{return} videoRecorder.getTimeOfFirstRecordedFrame();}
\DoxyCodeLine{494         \}}
\DoxyCodeLine{495 }
\DoxyCodeLine{496         \mbox{\hyperlink{group__juce__core-memory_ga557fa9dbf924a150e27f0cf0dad368b0}{JUCE\_DECLARE\_WEAK\_REFERENCEABLE}} (CaptureSession)}
\DoxyCodeLine{497 }
\DoxyCodeLine{498     \textcolor{keyword}{private}:}
\DoxyCodeLine{499         \mbox{\hyperlink{class_string}{String}} addInputToDevice (AVCaptureDevice* device)}
\DoxyCodeLine{500         \{}
\DoxyCodeLine{501             NSError* \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} = nil;}
\DoxyCodeLine{502 }
\DoxyCodeLine{503             \textcolor{keyword}{auto} \mbox{\hyperlink{namespacegl_ae94d0a99dc3426b5ac5fc7d881691a61}{input}} = [AVCaptureDeviceInput deviceInputWithDevice: device}
\DoxyCodeLine{504                                                                \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}: \&\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}];}
\DoxyCodeLine{505 }
\DoxyCodeLine{506             \textcolor{keywordflow}{if} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} != nil)}
\DoxyCodeLine{507                 \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription);}
\DoxyCodeLine{508 }
\DoxyCodeLine{509             \textcolor{keywordflow}{if} (! [captureSession.get() canAddInput: \mbox{\hyperlink{namespacegl_ae94d0a99dc3426b5ac5fc7d881691a61}{input}}])}
\DoxyCodeLine{510                 \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Could not add input to camera session."{}};}
\DoxyCodeLine{511 }
\DoxyCodeLine{512             [captureSession.get() addInput: \mbox{\hyperlink{namespacegl_ae94d0a99dc3426b5ac5fc7d881691a61}{input}}];}
\DoxyCodeLine{513             \textcolor{keywordflow}{return} \{\};}
\DoxyCodeLine{514         \}}
\DoxyCodeLine{515 }
\DoxyCodeLine{516         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{517         \textcolor{keyword}{struct }SessionDelegateClass    : \textcolor{keyword}{public} ObjCClass<NSObject>}
\DoxyCodeLine{518         \{}
\DoxyCodeLine{519             SessionDelegateClass()  : ObjCClass<NSObject> (\textcolor{stringliteral}{"{}SessionDelegateClass\_"{}})}
\DoxyCodeLine{520             \{}
\DoxyCodeLine{521                 \mbox{\hyperlink{group__juce__core-system_ga0112339834a6548e4123e394b9ed95e2}{JUCE\_BEGIN\_IGNORE\_WARNINGS\_GCC\_LIKE}} (\textcolor{stringliteral}{"{}-\/Wundeclared-\/selector"{}})}
\DoxyCodeLine{522                 addMethod (@selector (sessionDidStartRunning:),   started);}
\DoxyCodeLine{523                 addMethod (@selector (sessionDidStopRunning:),    stopped);}
\DoxyCodeLine{524                 addMethod (@selector (runtimeError:),             runtimeError);}
\DoxyCodeLine{525                 addMethod (@selector (sessionWasInterrupted:),    interrupted);}
\DoxyCodeLine{526                 addMethod (@selector (sessionInterruptionEnded:), interruptionEnded);}
\DoxyCodeLine{527                 \mbox{\hyperlink{group__juce__core-system_ga157f2229764b17137d8814bec95df109}{JUCE\_END\_IGNORE\_WARNINGS\_GCC\_LIKE}}}
\DoxyCodeLine{528 }
\DoxyCodeLine{529                 addIvar<CaptureSession*> ("{}owner"{});}
\DoxyCodeLine{530 }
\DoxyCodeLine{531                 registerClass();}
\DoxyCodeLine{532             \}}
\DoxyCodeLine{533 }
\DoxyCodeLine{534             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{535             static CaptureSession\& getOwner (\textcolor{keywordtype}{id} self)         \{ \textcolor{keywordflow}{return} *getIvar<CaptureSession*> (\textcolor{keyword}{self}, \textcolor{stringliteral}{"{}owner"{}}); \}}
\DoxyCodeLine{536             \textcolor{keyword}{static} \textcolor{keywordtype}{void} setOwner (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, CaptureSession* \mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}}) \{ object\_setInstanceVariable (\textcolor{keyword}{self}, \textcolor{stringliteral}{"{}owner"{}}, \mbox{\hyperlink{namespacegl_aeadf274ee1110e01be53f496f9ca200c}{s}}); \}}
\DoxyCodeLine{537 }
\DoxyCodeLine{538         \textcolor{keyword}{private}:}
\DoxyCodeLine{539             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{540             \textcolor{keyword}{static} \textcolor{keywordtype}{void} started (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, \textcolor{keywordtype}{SEL}, NSNotification* notification)}
\DoxyCodeLine{541             \{}
\DoxyCodeLine{542                 JUCE\_CAMERA\_LOG (\mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} ([notification description]));}
\DoxyCodeLine{543 }
\DoxyCodeLine{544                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (notification);}
\DoxyCodeLine{545 }
\DoxyCodeLine{546                 dispatch\_async (dispatch\_get\_main\_queue(),}
\DoxyCodeLine{547                                 \string^\{}
\DoxyCodeLine{548                                     getOwner (\textcolor{keyword}{self}).cameraSessionStarted();}
\DoxyCodeLine{549                                 \});}
\DoxyCodeLine{550             \}}
\DoxyCodeLine{551 }
\DoxyCodeLine{552             \textcolor{keyword}{static} \textcolor{keywordtype}{void} stopped (\textcolor{keywordtype}{id}, \textcolor{keywordtype}{SEL}, NSNotification* notification)}
\DoxyCodeLine{553             \{}
\DoxyCodeLine{554                 JUCE\_CAMERA\_LOG (\mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} ([notification description]));}
\DoxyCodeLine{555 }
\DoxyCodeLine{556                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (notification);}
\DoxyCodeLine{557             \}}
\DoxyCodeLine{558 }
\DoxyCodeLine{559             \textcolor{keyword}{static} \textcolor{keywordtype}{void} runtimeError (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, \textcolor{keywordtype}{SEL}, NSNotification* notification)}
\DoxyCodeLine{560             \{}
\DoxyCodeLine{561                 JUCE\_CAMERA\_LOG (\mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} ([notification description]));}
\DoxyCodeLine{562 }
\DoxyCodeLine{563                 dispatch\_async (dispatch\_get\_main\_queue(),}
\DoxyCodeLine{564                                 \string^\{}
\DoxyCodeLine{565                                     NSError* \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} = notification.userInfo[AVCaptureSessionErrorKey];}
\DoxyCodeLine{566                                     \textcolor{keyword}{auto} errorString = \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} != nil ? \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription) : \mbox{\hyperlink{class_string}{String}}();}
\DoxyCodeLine{567                                     getOwner (\textcolor{keyword}{self}).cameraSessionRuntimeError (errorString);}
\DoxyCodeLine{568                                 \});}
\DoxyCodeLine{569             \}}
\DoxyCodeLine{570 }
\DoxyCodeLine{571             \textcolor{keyword}{static} \textcolor{keywordtype}{void} interrupted (\textcolor{keywordtype}{id}, \textcolor{keywordtype}{SEL}, NSNotification* notification)}
\DoxyCodeLine{572             \{}
\DoxyCodeLine{573                 JUCE\_CAMERA\_LOG (\mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} ([notification description]));}
\DoxyCodeLine{574 }
\DoxyCodeLine{575                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (notification);}
\DoxyCodeLine{576             \}}
\DoxyCodeLine{577 }
\DoxyCodeLine{578             \textcolor{keyword}{static} \textcolor{keywordtype}{void} interruptionEnded (\textcolor{keywordtype}{id}, \textcolor{keywordtype}{SEL}, NSNotification* notification)}
\DoxyCodeLine{579             \{}
\DoxyCodeLine{580                 JUCE\_CAMERA\_LOG (\mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} ([notification description]));}
\DoxyCodeLine{581 }
\DoxyCodeLine{582                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (notification);}
\DoxyCodeLine{583             \}}
\DoxyCodeLine{584         \};}
\DoxyCodeLine{585 }
\DoxyCodeLine{586         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{587         \textcolor{keyword}{class }StillPictureTaker}
\DoxyCodeLine{588         \{}
\DoxyCodeLine{589         \textcolor{keyword}{public}:}
\DoxyCodeLine{590             StillPictureTaker (CaptureSession\& cs)}
\DoxyCodeLine{591                 : captureSession (cs),}
\DoxyCodeLine{592                   captureOutput (createCaptureOutput()),}
\DoxyCodeLine{593                   photoOutputDelegate (nullptr)}
\DoxyCodeLine{594             \{}
\DoxyCodeLine{595 \textcolor{preprocessor}{               \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{596                 \textcolor{keywordflow}{if} (@available (iOS 10.0, *))}
\DoxyCodeLine{597                 \{}
\DoxyCodeLine{598                     \textcolor{keyword}{static} PhotoOutputDelegateClass cls;}
\DoxyCodeLine{599                     photoOutputDelegate.reset ([cls.createInstance() init]);}
\DoxyCodeLine{600                     PhotoOutputDelegateClass::setOwner (photoOutputDelegate.get(), \textcolor{keyword}{this});}
\DoxyCodeLine{601                 \}}
\DoxyCodeLine{602 \textcolor{preprocessor}{               \#endif}}
\DoxyCodeLine{603 }
\DoxyCodeLine{604                 captureSession.addOutputIfPossible (captureOutput);}
\DoxyCodeLine{605             \}}
\DoxyCodeLine{606 }
\DoxyCodeLine{607             \textcolor{keywordtype}{void} takePicture (AVCaptureVideoOrientation orientationToUse)}
\DoxyCodeLine{608             \{}
\DoxyCodeLine{609                 \textcolor{keywordflow}{if} (takingPicture)}
\DoxyCodeLine{610                 \{}
\DoxyCodeLine{611                     \textcolor{comment}{// Picture taking already in progress!}}
\DoxyCodeLine{612                     \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{613                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{614                 \}}
\DoxyCodeLine{615 }
\DoxyCodeLine{616                 takingPicture = \textcolor{keyword}{true};}
\DoxyCodeLine{617 }
\DoxyCodeLine{618                 printImageOutputDebugInfo (captureOutput);}
\DoxyCodeLine{619 }
\DoxyCodeLine{620                 \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* connection = findVideoConnection (captureOutput))}
\DoxyCodeLine{621                 \{}
\DoxyCodeLine{622 \textcolor{preprocessor}{                   \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{623                     \textcolor{keywordflow}{if} (@available (iOS 10.0, *))}
\DoxyCodeLine{624                     \{}
\DoxyCodeLine{625                         \textcolor{keywordflow}{if} ([captureOutput isKindOfClass: [AVCapturePhotoOutput \textcolor{keyword}{class}]])}
\DoxyCodeLine{626                         \{}
\DoxyCodeLine{627                             \textcolor{keyword}{auto}* photoOutput = (AVCapturePhotoOutput*) captureOutput;}
\DoxyCodeLine{628                             \textcolor{keyword}{auto} outputConnection = [photoOutput connectionWithMediaType: AVMediaTypeVideo];}
\DoxyCodeLine{629                             outputConnection.videoOrientation = orientationToUse;}
\DoxyCodeLine{630 }
\DoxyCodeLine{631                             [photoOutput capturePhotoWithSettings: [AVCapturePhotoSettings photoSettings]}
\DoxyCodeLine{632                                                          delegate: id<AVCapturePhotoCaptureDelegate> (photoOutputDelegate.get())];}
\DoxyCodeLine{633 }
\DoxyCodeLine{634                             \textcolor{keywordflow}{return};}
\DoxyCodeLine{635                         \}}
\DoxyCodeLine{636                     \}}
\DoxyCodeLine{637 \textcolor{preprocessor}{                   \#endif}}
\DoxyCodeLine{638 }
\DoxyCodeLine{639                     \textcolor{keyword}{auto}* stillImageOutput = (AVCaptureStillImageOutput*) captureOutput;}
\DoxyCodeLine{640                     \textcolor{keyword}{auto} outputConnection = [stillImageOutput connectionWithMediaType: AVMediaTypeVideo];}
\DoxyCodeLine{641                     outputConnection.videoOrientation = orientationToUse;}
\DoxyCodeLine{642 }
\DoxyCodeLine{643                     [stillImageOutput captureStillImageAsynchronouslyFromConnection: connection completionHandler:}
\DoxyCodeLine{644                          \string^(CMSampleBufferRef imageSampleBuffer, NSError* \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{645                          \{}
\DoxyCodeLine{646                              takingPicture = \textcolor{keyword}{false};}
\DoxyCodeLine{647 }
\DoxyCodeLine{648                              \textcolor{keywordflow}{if} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} != nil)}
\DoxyCodeLine{649                              \{}
\DoxyCodeLine{650                                  JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still picture capture failed, error: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription));}
\DoxyCodeLine{651                                  \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{652                                  \textcolor{keywordflow}{return};}
\DoxyCodeLine{653                              \}}
\DoxyCodeLine{654 }
\DoxyCodeLine{655                              NSData* imageData = [AVCaptureStillImageOutput jpegStillImageNSDataRepresentation: imageSampleBuffer];}
\DoxyCodeLine{656 }
\DoxyCodeLine{657                              \textcolor{keyword}{auto} \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}} = \mbox{\hyperlink{class_image_file_format_aa5cf7b6f03682432ae93df3c3defc2b7}{ImageFileFormat::loadFrom}} (imageData.bytes, (\textcolor{keywordtype}{size\_t}) imageData.length);}
\DoxyCodeLine{658 }
\DoxyCodeLine{659                              callListeners (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{660 }
\DoxyCodeLine{661                              \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([\textcolor{keyword}{this}, \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}] \{ notifyPictureTaken (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}); \});}
\DoxyCodeLine{662                          \}];}
\DoxyCodeLine{663                 \}}
\DoxyCodeLine{664                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{665                 \{}
\DoxyCodeLine{666                     \textcolor{comment}{// Could not find a connection of video type}}
\DoxyCodeLine{667                     \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{668                 \}}
\DoxyCodeLine{669             \}}
\DoxyCodeLine{670 }
\DoxyCodeLine{671         \textcolor{keyword}{private}:}
\DoxyCodeLine{672             \textcolor{keyword}{static} AVCaptureOutput* createCaptureOutput()}
\DoxyCodeLine{673             \{}
\DoxyCodeLine{674 \textcolor{preprocessor}{               \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{675                 \textcolor{keywordflow}{if} (@available (iOS 10.0, *))}
\DoxyCodeLine{676                     \textcolor{keywordflow}{return} [AVCapturePhotoOutput \textcolor{keyword}{new}];}
\DoxyCodeLine{677 \textcolor{preprocessor}{               \#endif}}
\DoxyCodeLine{678 }
\DoxyCodeLine{679                 \textcolor{keywordflow}{return} [AVCaptureStillImageOutput \textcolor{keyword}{new}];}
\DoxyCodeLine{680             \}}
\DoxyCodeLine{681 }
\DoxyCodeLine{682             \textcolor{keyword}{static} \textcolor{keywordtype}{void} printImageOutputDebugInfo (AVCaptureOutput* captureOutput)}
\DoxyCodeLine{683             \{}
\DoxyCodeLine{684 \textcolor{preprocessor}{               \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{685                 \textcolor{keywordflow}{if} (@available (iOS 10.0, *))}
\DoxyCodeLine{686                 \{}
\DoxyCodeLine{687                     \textcolor{keywordflow}{if} ([captureOutput isKindOfClass: [AVCapturePhotoOutput \textcolor{keyword}{class}]])}
\DoxyCodeLine{688                     \{}
\DoxyCodeLine{689                         \textcolor{keyword}{auto}* photoOutput = (AVCapturePhotoOutput*) captureOutput;}
\DoxyCodeLine{690 }
\DoxyCodeLine{691                         \mbox{\hyperlink{class_string}{String}} typesString;}
\DoxyCodeLine{692 }
\DoxyCodeLine{693                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{id} \mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} photoOutput.availablePhotoCodecTypes)}
\DoxyCodeLine{694                             typesString << \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{695 }
\DoxyCodeLine{696                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Available image codec types: "{}} + typesString);}
\DoxyCodeLine{697 }
\DoxyCodeLine{698                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still image stabilization supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) photoOutput.stillImageStabilizationSupported));}
\DoxyCodeLine{699                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Dual camera fusion supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) photoOutput.dualCameraFusionSupported));}
\DoxyCodeLine{700                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports flash: "{}}      + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) [photoOutput.supportedFlashModes containsObject: @(AVCaptureFlashModeOn)]));}
\DoxyCodeLine{701                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Supports auto flash: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) [photoOutput.supportedFlashModes containsObject: @(AVCaptureFlashModeAuto)]));}
\DoxyCodeLine{702                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Max bracketed photo count: "{}} + \mbox{\hyperlink{class_string}{String}} (photoOutput.maxBracketedCapturePhotoCount));}
\DoxyCodeLine{703                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Lens stabilization during bracketed capture supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) photoOutput.lensStabilizationDuringBracketedCaptureSupported));}
\DoxyCodeLine{704                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Live photo capture supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) photoOutput.livePhotoCaptureSupported));}
\DoxyCodeLine{705 }
\DoxyCodeLine{706 }
\DoxyCodeLine{707 \textcolor{preprocessor}{                       \#if defined (\_\_IPHONE\_11\_0) \&\& \_\_IPHONE\_OS\_VERSION\_MAX\_ALLOWED >= \_\_IPHONE\_11\_0}}
\DoxyCodeLine{708                         \textcolor{keywordflow}{if} (@available (iOS 11.0, *))}
\DoxyCodeLine{709                         \{}
\DoxyCodeLine{710                             typesString.\mbox{\hyperlink{class_string_a8270e74db4c76725871abda0316d1bec}{clear}}();}
\DoxyCodeLine{711 }
\DoxyCodeLine{712                             \textcolor{keywordflow}{for} (AVFileType \mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} photoOutput.availablePhotoFileTypes)}
\DoxyCodeLine{713                                 typesString << \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{714 }
\DoxyCodeLine{715                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Available photo file types: "{}} + typesString);}
\DoxyCodeLine{716 }
\DoxyCodeLine{717                             typesString.\mbox{\hyperlink{class_string_a8270e74db4c76725871abda0316d1bec}{clear}}();}
\DoxyCodeLine{718 }
\DoxyCodeLine{719                             \textcolor{keywordflow}{for} (AVFileType \mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} photoOutput.availableRawPhotoFileTypes)}
\DoxyCodeLine{720                                 typesString << \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{721 }
\DoxyCodeLine{722                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Available RAW photo file types: "{}} + typesString);}
\DoxyCodeLine{723 }
\DoxyCodeLine{724                             typesString.\mbox{\hyperlink{class_string_a8270e74db4c76725871abda0316d1bec}{clear}}();}
\DoxyCodeLine{725 }
\DoxyCodeLine{726                             \textcolor{keywordflow}{for} (AVFileType \mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} photoOutput.availableLivePhotoVideoCodecTypes)}
\DoxyCodeLine{727                                 typesString << \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{728 }
\DoxyCodeLine{729                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Available live photo video codec types: "{}} + typesString);}
\DoxyCodeLine{730 }
\DoxyCodeLine{731                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Dual camera dual photo delivery supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) photoOutput.dualCameraDualPhotoDeliverySupported));}
\DoxyCodeLine{732                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Camera calibration data delivery supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) photoOutput.cameraCalibrationDataDeliverySupported));}
\DoxyCodeLine{733                             JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Depth data delivery supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) photoOutput.depthDataDeliverySupported));}
\DoxyCodeLine{734                         \}}
\DoxyCodeLine{735 \textcolor{preprocessor}{                       \#endif}}
\DoxyCodeLine{736 }
\DoxyCodeLine{737                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{738                     \}}
\DoxyCodeLine{739                 \}}
\DoxyCodeLine{740 \textcolor{preprocessor}{               \#endif}}
\DoxyCodeLine{741 }
\DoxyCodeLine{742                 \textcolor{keyword}{auto}* stillImageOutput = (AVCaptureStillImageOutput*) captureOutput;}
\DoxyCodeLine{743 }
\DoxyCodeLine{744                 \mbox{\hyperlink{class_string}{String}} typesString;}
\DoxyCodeLine{745 }
\DoxyCodeLine{746                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{id} \mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} stillImageOutput.availableImageDataCodecTypes)}
\DoxyCodeLine{747                     typesString << \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{748 }
\DoxyCodeLine{749                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Available image codec types: "{}} + typesString);}
\DoxyCodeLine{750                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still image stabilization supported: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) stillImageOutput.stillImageStabilizationSupported));}
\DoxyCodeLine{751                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Automatically enables still image stabilization when available: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) stillImageOutput.automaticallyEnablesStillImageStabilizationWhenAvailable));}
\DoxyCodeLine{752 }
\DoxyCodeLine{753                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Output settings for image output: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} ([stillImageOutput.outputSettings description]));}
\DoxyCodeLine{754             \}}
\DoxyCodeLine{755 }
\DoxyCodeLine{756             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{757             \textcolor{keyword}{static} AVCaptureConnection* findVideoConnection (AVCaptureOutput* \mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}})}
\DoxyCodeLine{758             \{}
\DoxyCodeLine{759                 \textcolor{keywordflow}{for} (AVCaptureConnection* connection \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} \mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}}.connections)}
\DoxyCodeLine{760                     \textcolor{keywordflow}{for} (AVCaptureInputPort* \mbox{\hyperlink{namespacejuce_a6d327326870c2c2f1ca1d681842b923f}{port}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} connection.inputPorts)}
\DoxyCodeLine{761                         \textcolor{keywordflow}{if} ([\mbox{\hyperlink{namespacejuce_a6d327326870c2c2f1ca1d681842b923f}{port}}.mediaType isEqual: AVMediaTypeVideo])}
\DoxyCodeLine{762                             \textcolor{keywordflow}{return} connection;}
\DoxyCodeLine{763 }
\DoxyCodeLine{764                 \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{765             \}}
\DoxyCodeLine{766 }
\DoxyCodeLine{767             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{768 \textcolor{preprocessor}{           \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{769             \textcolor{keyword}{class }PhotoOutputDelegateClass : \textcolor{keyword}{public} ObjCClass<NSObject>}
\DoxyCodeLine{770             \{}
\DoxyCodeLine{771             \textcolor{keyword}{public}:}
\DoxyCodeLine{772                 PhotoOutputDelegateClass() : ObjCClass<NSObject> (\textcolor{stringliteral}{"{}PhotoOutputDelegateClass\_"{}})}
\DoxyCodeLine{773                 \{}
\DoxyCodeLine{774                     addMethod (\textcolor{keyword}{@selector} (captureOutput:willBeginCaptureForResolvedSettings:),       willBeginCaptureForSettings);}
\DoxyCodeLine{775                     addMethod (\textcolor{keyword}{@selector} (captureOutput:willCapturePhotoForResolvedSettings:),       willCaptureForSettings);}
\DoxyCodeLine{776                     addMethod (\textcolor{keyword}{@selector} (captureOutput:didCapturePhotoForResolvedSettings:),        didCaptureForSettings);}
\DoxyCodeLine{777                     addMethod (\textcolor{keyword}{@selector} (captureOutput:didFinishCaptureForResolvedSettings:\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}:), didFinishCaptureForSettings);}
\DoxyCodeLine{778 }
\DoxyCodeLine{779 \textcolor{preprocessor}{                   \#if defined (\_\_IPHONE\_11\_0) \&\& \_\_IPHONE\_OS\_VERSION\_MAX\_ALLOWED >= \_\_IPHONE\_11\_0}}
\DoxyCodeLine{780                     \textcolor{keywordflow}{if} (@available (iOS 11.0, *))}
\DoxyCodeLine{781                     \{}
\DoxyCodeLine{782                         addMethod (\textcolor{keyword}{@selector} (captureOutput:didFinishProcessingPhoto:\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}:), didFinishProcessingPhoto);}
\DoxyCodeLine{783                     \}}
\DoxyCodeLine{784                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{785 \textcolor{preprocessor}{                   \#endif}}
\DoxyCodeLine{786                     \{}
\DoxyCodeLine{787                         addMethod (\textcolor{keyword}{@selector} (captureOutput:didFinishProcessingPhotoSampleBuffer:previewPhotoSampleBuffer:resolvedSettings:bracketSettings:\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}:), didFinishProcessingPhotoSampleBuffer);}
\DoxyCodeLine{788                     \}}
\DoxyCodeLine{789 }
\DoxyCodeLine{790                     addIvar<StillPictureTaker*> (\textcolor{stringliteral}{"{}owner"{}});}
\DoxyCodeLine{791 }
\DoxyCodeLine{792                     registerClass();}
\DoxyCodeLine{793                 \}}
\DoxyCodeLine{794 }
\DoxyCodeLine{795                 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{796                 \textcolor{keyword}{static} StillPictureTaker\& getOwner (\textcolor{keywordtype}{id} \textcolor{keyword}{self}) \{ \textcolor{keywordflow}{return} *getIvar<StillPictureTaker*> (\textcolor{keyword}{self}, \textcolor{stringliteral}{"{}owner"{}}); \}}
\DoxyCodeLine{797                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} setOwner (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, StillPictureTaker* \mbox{\hyperlink{namespacegl_ad0bd70fc9115453f6f5f5ac53accea65}{t}}) \{ object\_setInstanceVariable (\textcolor{keyword}{self}, \textcolor{stringliteral}{"{}owner"{}}, \mbox{\hyperlink{namespacegl_ad0bd70fc9115453f6f5f5ac53accea65}{t}}); \}}
\DoxyCodeLine{798 }
\DoxyCodeLine{799             \textcolor{keyword}{private}:}
\DoxyCodeLine{800                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} willBeginCaptureForSettings (\textcolor{keywordtype}{id}, \textcolor{keywordtype}{SEL}, AVCapturePhotoOutput*, AVCaptureResolvedPhotoSettings*)}
\DoxyCodeLine{801                 \{}
\DoxyCodeLine{802                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}willBeginCaptureForSettings()"{}});}
\DoxyCodeLine{803                 \}}
\DoxyCodeLine{804 }
\DoxyCodeLine{805                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} willCaptureForSettings (\textcolor{keywordtype}{id}, \textcolor{keywordtype}{SEL}, AVCapturePhotoOutput*, AVCaptureResolvedPhotoSettings*)}
\DoxyCodeLine{806                 \{}
\DoxyCodeLine{807                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}willCaptureForSettings()"{}});}
\DoxyCodeLine{808                 \}}
\DoxyCodeLine{809 }
\DoxyCodeLine{810                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} didCaptureForSettings (\textcolor{keywordtype}{id}, \textcolor{keywordtype}{SEL}, AVCapturePhotoOutput*, AVCaptureResolvedPhotoSettings*)}
\DoxyCodeLine{811                 \{}
\DoxyCodeLine{812                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}didCaptureForSettings()"{}});}
\DoxyCodeLine{813                 \}}
\DoxyCodeLine{814 }
\DoxyCodeLine{815                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} didFinishCaptureForSettings (\textcolor{keywordtype}{id}, \textcolor{keywordtype}{SEL}, AVCapturePhotoOutput*, AVCaptureResolvedPhotoSettings*, NSError* \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{816                 \{}
\DoxyCodeLine{817                     \mbox{\hyperlink{class_string}{String}} errorString = \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} != nil ? \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription) : \mbox{\hyperlink{class_string}{String}}();}
\DoxyCodeLine{818                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (errorString);}
\DoxyCodeLine{819 }
\DoxyCodeLine{820                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}didFinishCaptureForSettings(), error = "{}} + errorString);}
\DoxyCodeLine{821                 \}}
\DoxyCodeLine{822 }
\DoxyCodeLine{823                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} didFinishProcessingPhoto (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, \textcolor{keywordtype}{SEL}, AVCapturePhotoOutput*, AVCapturePhoto* capturePhoto, NSError* \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{824                 \{}
\DoxyCodeLine{825                     getOwner (\textcolor{keyword}{self}).takingPicture = \textcolor{keyword}{false};}
\DoxyCodeLine{826 }
\DoxyCodeLine{827                     \mbox{\hyperlink{class_string}{String}} errorString = \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} != nil ? \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription) : \mbox{\hyperlink{class_string}{String}}();}
\DoxyCodeLine{828                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (errorString);}
\DoxyCodeLine{829 }
\DoxyCodeLine{830                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}didFinishProcessingPhoto(), error = "{}} + errorString);}
\DoxyCodeLine{831 }
\DoxyCodeLine{832                     \textcolor{keywordflow}{if} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} != nil)}
\DoxyCodeLine{833                     \{}
\DoxyCodeLine{834                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still picture capture failed, error: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription));}
\DoxyCodeLine{835                         \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{836                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{837                     \}}
\DoxyCodeLine{838 }
\DoxyCodeLine{839                     \textcolor{keyword}{auto}* imageOrientation = (NSNumber *) capturePhoto.metadata[(NSString*) kCGImagePropertyOrientation];}
\DoxyCodeLine{840 }
\DoxyCodeLine{841                     \textcolor{keyword}{auto}* uiImage = getImageWithCorrectOrientation ((CGImagePropertyOrientation) imageOrientation.unsignedIntValue,}
\DoxyCodeLine{842                                                                     [capturePhoto CGImageRepresentation]);}
\DoxyCodeLine{843 }
\DoxyCodeLine{844                     \textcolor{keyword}{auto}* imageData = UIImageJPEGRepresentation (uiImage, 0.f);}
\DoxyCodeLine{845 }
\DoxyCodeLine{846                     \textcolor{keyword}{auto} \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}} = \mbox{\hyperlink{class_image_file_format_aa5cf7b6f03682432ae93df3c3defc2b7}{ImageFileFormat::loadFrom}} (imageData.bytes, (\textcolor{keywordtype}{size\_t}) imageData.length);}
\DoxyCodeLine{847 }
\DoxyCodeLine{848                     getOwner (\textcolor{keyword}{self}).callListeners (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{849 }
\DoxyCodeLine{850                     \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([\textcolor{keyword}{self}, \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}]() \{ getOwner (\textcolor{keyword}{self}).notifyPictureTaken (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}); \});}
\DoxyCodeLine{851                 \}}
\DoxyCodeLine{852 }
\DoxyCodeLine{853                 \textcolor{keyword}{static} UIImage* getImageWithCorrectOrientation (CGImagePropertyOrientation imageOrientation,}
\DoxyCodeLine{854                                                                 CGImageRef imageData)}
\DoxyCodeLine{855                 \{}
\DoxyCodeLine{856                     \textcolor{keyword}{auto} origWidth  = CGImageGetWidth (imageData);}
\DoxyCodeLine{857                     \textcolor{keyword}{auto} origHeight = CGImageGetHeight (imageData);}
\DoxyCodeLine{858 }
\DoxyCodeLine{859                     \textcolor{keyword}{auto} targetSize = getTargetImageDimensionFor (imageOrientation, imageData);}
\DoxyCodeLine{860 }
\DoxyCodeLine{861                     UIGraphicsBeginImageContext (targetSize);}
\DoxyCodeLine{862                     CGContextRef context = UIGraphicsGetCurrentContext();}
\DoxyCodeLine{863 }
\DoxyCodeLine{864                     \textcolor{keywordflow}{switch} (imageOrientation)}
\DoxyCodeLine{865                     \{}
\DoxyCodeLine{866                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationUp:}
\DoxyCodeLine{867                             CGContextScaleCTM (context, 1.0, -\/1.0);}
\DoxyCodeLine{868                             CGContextTranslateCTM (context, 0.0, -\/targetSize.height);}
\DoxyCodeLine{869                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{870                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationRight:}
\DoxyCodeLine{871                             CGContextRotateCTM (context, 90 * \mbox{\hyperlink{struct_math_constants}{MathConstants<CGFloat>::pi}} / 180);}
\DoxyCodeLine{872                             CGContextScaleCTM (context, targetSize.height / origHeight, -\/targetSize.width / origWidth);}
\DoxyCodeLine{873                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{874                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationDown:}
\DoxyCodeLine{875                             CGContextTranslateCTM (context, targetSize.width, 0.0);}
\DoxyCodeLine{876                             CGContextScaleCTM (context, -\/1.0, 1.0);}
\DoxyCodeLine{877                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{878                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationLeft:}
\DoxyCodeLine{879                             CGContextRotateCTM (context, -\/90 * \mbox{\hyperlink{struct_math_constants}{MathConstants<CGFloat>::pi}} / 180);}
\DoxyCodeLine{880                             CGContextScaleCTM (context, targetSize.height / origHeight, -\/targetSize.width / origWidth);}
\DoxyCodeLine{881                             CGContextTranslateCTM (context, -\/targetSize.width, -\/targetSize.height);}
\DoxyCodeLine{882                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{883                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationUpMirrored:}
\DoxyCodeLine{884                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationDownMirrored:}
\DoxyCodeLine{885                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationLeftMirrored:}
\DoxyCodeLine{886                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationRightMirrored:}
\DoxyCodeLine{887                         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{888                             \textcolor{comment}{// Not implemented.}}
\DoxyCodeLine{889                             \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{890                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{891                     \}}
\DoxyCodeLine{892 }
\DoxyCodeLine{893                     CGContextDrawImage (context, CGRectMake (0, 0, targetSize.width, targetSize.height), imageData);}
\DoxyCodeLine{894 }
\DoxyCodeLine{895                     UIImage* correctedImage = UIGraphicsGetImageFromCurrentImageContext();}
\DoxyCodeLine{896                     UIGraphicsEndImageContext();}
\DoxyCodeLine{897 }
\DoxyCodeLine{898                     \textcolor{keywordflow}{return} correctedImage;}
\DoxyCodeLine{899                 \}}
\DoxyCodeLine{900 }
\DoxyCodeLine{901                 \textcolor{keyword}{static} CGSize getTargetImageDimensionFor (CGImagePropertyOrientation imageOrientation,}
\DoxyCodeLine{902                                                           CGImageRef imageData)}
\DoxyCodeLine{903                 \{}
\DoxyCodeLine{904                     \textcolor{keyword}{auto} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}} = CGImageGetWidth (imageData);}
\DoxyCodeLine{905                     \textcolor{keyword}{auto} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}} = CGImageGetHeight (imageData);}
\DoxyCodeLine{906 }
\DoxyCodeLine{907                     \textcolor{keywordflow}{switch} (imageOrientation)}
\DoxyCodeLine{908                     \{}
\DoxyCodeLine{909                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationUp:}
\DoxyCodeLine{910                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationUpMirrored:}
\DoxyCodeLine{911                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationDown:}
\DoxyCodeLine{912                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationDownMirrored:}
\DoxyCodeLine{913                             \textcolor{keywordflow}{return} CGSizeMake ((CGFloat) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}}, (CGFloat) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}});}
\DoxyCodeLine{914                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationRight:}
\DoxyCodeLine{915                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationRightMirrored:}
\DoxyCodeLine{916                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationLeft:}
\DoxyCodeLine{917                         \textcolor{keywordflow}{case} kCGImagePropertyOrientationLeftMirrored:}
\DoxyCodeLine{918                             \textcolor{keywordflow}{return} CGSizeMake ((CGFloat) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}}, (CGFloat) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}});}
\DoxyCodeLine{919                     \}}
\DoxyCodeLine{920 }
\DoxyCodeLine{921                     \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{922                     \textcolor{keywordflow}{return} CGSizeMake ((CGFloat) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a6941a8c76ca6b528123053a8dede2ba2}{width}}, (CGFloat) \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a2747ecebff013026e24ea04c2a88b449}{height}});}
\DoxyCodeLine{923                 \}}
\DoxyCodeLine{924 }
\DoxyCodeLine{925                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} didFinishProcessingPhotoSampleBuffer (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, \textcolor{keywordtype}{SEL}, AVCapturePhotoOutput*,}
\DoxyCodeLine{926                                                                   CMSampleBufferRef imageBuffer, CMSampleBufferRef imagePreviewBuffer,}
\DoxyCodeLine{927                                                                   AVCaptureResolvedPhotoSettings*, AVCaptureBracketedStillImageSettings*,}
\DoxyCodeLine{928                                                                   NSError* \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{929                 \{}
\DoxyCodeLine{930                     getOwner (\textcolor{keyword}{self}).takingPicture = \textcolor{keyword}{false};}
\DoxyCodeLine{931 }
\DoxyCodeLine{932                     \mbox{\hyperlink{class_string}{String}} errorString = \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} != nil ? \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription) : \mbox{\hyperlink{class_string}{String}}();}
\DoxyCodeLine{933                     \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (errorString);}
\DoxyCodeLine{934 }
\DoxyCodeLine{935                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}didFinishProcessingPhotoSampleBuffer(), error = "{}} + errorString);}
\DoxyCodeLine{936 }
\DoxyCodeLine{937                     \textcolor{keywordflow}{if} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} != nil)}
\DoxyCodeLine{938                     \{}
\DoxyCodeLine{939                         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Still picture capture failed, error: "{}} + \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription));}
\DoxyCodeLine{940                         \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{941                         \textcolor{keywordflow}{return};}
\DoxyCodeLine{942                     \}}
\DoxyCodeLine{943 }
\DoxyCodeLine{944                     NSData* origImageData = [AVCapturePhotoOutput JPEGPhotoDataRepresentationForJPEGSampleBuffer: imageBuffer previewPhotoSampleBuffer: imagePreviewBuffer];}
\DoxyCodeLine{945                     \textcolor{keyword}{auto} origImage = [UIImage imageWithData: origImageData];}
\DoxyCodeLine{946                     \textcolor{keyword}{auto} imageOrientation = uiImageOrientationToCGImageOrientation (origImage.imageOrientation);}
\DoxyCodeLine{947 }
\DoxyCodeLine{948                     \textcolor{keyword}{auto}* uiImage = getImageWithCorrectOrientation (imageOrientation, origImage.CGImage);}
\DoxyCodeLine{949 }
\DoxyCodeLine{950                     \textcolor{keyword}{auto}* imageData = UIImageJPEGRepresentation (uiImage, 0.f);}
\DoxyCodeLine{951 }
\DoxyCodeLine{952                     \textcolor{keyword}{auto} \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}} = \mbox{\hyperlink{class_image_file_format_aa5cf7b6f03682432ae93df3c3defc2b7}{ImageFileFormat::loadFrom}} (imageData.bytes, (\textcolor{keywordtype}{size\_t}) imageData.length);}
\DoxyCodeLine{953 }
\DoxyCodeLine{954                     getOwner (\textcolor{keyword}{self}).callListeners (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{955 }
\DoxyCodeLine{956                     \mbox{\hyperlink{class_message_manager_acfe6da5271c2ab76fdb0414b235ed095}{MessageManager::callAsync}} ([\textcolor{keyword}{self}, \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}]() \{ getOwner (\textcolor{keyword}{self}).notifyPictureTaken (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}); \});}
\DoxyCodeLine{957                 \}}
\DoxyCodeLine{958 }
\DoxyCodeLine{959                 \textcolor{keyword}{static} CGImagePropertyOrientation uiImageOrientationToCGImageOrientation (UIImageOrientation orientation)}
\DoxyCodeLine{960                 \{}
\DoxyCodeLine{961                     \textcolor{keywordflow}{switch} (orientation)}
\DoxyCodeLine{962                     \{}
\DoxyCodeLine{963                         \textcolor{keywordflow}{case} UIImageOrientationUp:            \textcolor{keywordflow}{return} kCGImagePropertyOrientationUp;}
\DoxyCodeLine{964                         \textcolor{keywordflow}{case} UIImageOrientationDown:          \textcolor{keywordflow}{return} kCGImagePropertyOrientationDown;}
\DoxyCodeLine{965                         \textcolor{keywordflow}{case} UIImageOrientationLeft:          \textcolor{keywordflow}{return} kCGImagePropertyOrientationLeft;}
\DoxyCodeLine{966                         \textcolor{keywordflow}{case} UIImageOrientationRight:         \textcolor{keywordflow}{return} kCGImagePropertyOrientationRight;}
\DoxyCodeLine{967                         \textcolor{keywordflow}{case} UIImageOrientationUpMirrored:    \textcolor{keywordflow}{return} kCGImagePropertyOrientationUpMirrored;}
\DoxyCodeLine{968                         \textcolor{keywordflow}{case} UIImageOrientationDownMirrored:  \textcolor{keywordflow}{return} kCGImagePropertyOrientationDownMirrored;}
\DoxyCodeLine{969                         \textcolor{keywordflow}{case} UIImageOrientationLeftMirrored:  \textcolor{keywordflow}{return} kCGImagePropertyOrientationLeftMirrored;}
\DoxyCodeLine{970                         \textcolor{keywordflow}{case} UIImageOrientationRightMirrored: \textcolor{keywordflow}{return} kCGImagePropertyOrientationRightMirrored;}
\DoxyCodeLine{971                     \}}
\DoxyCodeLine{972                 \}}
\DoxyCodeLine{973             \};}
\DoxyCodeLine{974 \textcolor{preprocessor}{           \#endif}}
\DoxyCodeLine{975 }
\DoxyCodeLine{976             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{977             \textcolor{keywordtype}{void} callListeners (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\& \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}})}
\DoxyCodeLine{978             \{}
\DoxyCodeLine{979                 captureSession.callListeners (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{980             \}}
\DoxyCodeLine{981 }
\DoxyCodeLine{982             \textcolor{keywordtype}{void} notifyPictureTaken (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\& \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}})}
\DoxyCodeLine{983             \{}
\DoxyCodeLine{984                 captureSession.notifyPictureTaken (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{985             \}}
\DoxyCodeLine{986 }
\DoxyCodeLine{987             CaptureSession\& captureSession;}
\DoxyCodeLine{988             AVCaptureOutput* captureOutput;}
\DoxyCodeLine{989 }
\DoxyCodeLine{990             std::unique\_ptr<NSObject, NSObjectDeleter> photoOutputDelegate;}
\DoxyCodeLine{991 }
\DoxyCodeLine{992             \textcolor{keywordtype}{bool} takingPicture = \textcolor{keyword}{false};}
\DoxyCodeLine{993         \};}
\DoxyCodeLine{994 }
\DoxyCodeLine{995         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{996         \textcolor{comment}{// NB: FileOutputRecordingDelegateClass callbacks can be called from any thread (incl.}}
\DoxyCodeLine{997         \textcolor{comment}{// the message thread), so waiting for an event when stopping recording is not an}}
\DoxyCodeLine{998         \textcolor{comment}{// option and VideoRecorder must be alive at all times in order to get stopped}}
\DoxyCodeLine{999         \textcolor{comment}{// recording callback.}}
\DoxyCodeLine{1000         \textcolor{keyword}{class }VideoRecorder}
\DoxyCodeLine{1001         \{}
\DoxyCodeLine{1002         \textcolor{keyword}{public}:}
\DoxyCodeLine{1003             VideoRecorder (CaptureSession\& session)}
\DoxyCodeLine{1004                 : movieFileOutput ([AVCaptureMovieFileOutput new]),}
\DoxyCodeLine{1005                   delegate (nullptr)}
\DoxyCodeLine{1006             \{}
\DoxyCodeLine{1007                 \textcolor{keyword}{static} FileOutputRecordingDelegateClass cls;}
\DoxyCodeLine{1008                 delegate.reset ([cls.createInstance() init]);}
\DoxyCodeLine{1009                 FileOutputRecordingDelegateClass::setOwner (delegate.get(), \textcolor{keyword}{this});}
\DoxyCodeLine{1010 }
\DoxyCodeLine{1011                 session.addOutputIfPossible (movieFileOutput);}
\DoxyCodeLine{1012             \}}
\DoxyCodeLine{1013 }
\DoxyCodeLine{1014             \string~VideoRecorder()}
\DoxyCodeLine{1015             \{}
\DoxyCodeLine{1016                 \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac33ca230910ae42b3171bd149ef0f84e}{stopRecording}}();}
\DoxyCodeLine{1017 }
\DoxyCodeLine{1018                 \textcolor{comment}{// Shutting down a device while recording will stop the recording}}
\DoxyCodeLine{1019                 \textcolor{comment}{// abruptly and the recording will be lost.}}
\DoxyCodeLine{1020                 \mbox{\hyperlink{group__juce__core-system_ga1f96ab6751237979b907a54f52a7296a}{jassert}} (! recordingInProgress);}
\DoxyCodeLine{1021             \}}
\DoxyCodeLine{1022 }
\DoxyCodeLine{1023             \textcolor{keywordtype}{void} startRecording (\textcolor{keyword}{const} \mbox{\hyperlink{class_file}{File}}\& file, AVCaptureVideoOrientation orientationToUse)}
\DoxyCodeLine{1024             \{}
\DoxyCodeLine{1025 \textcolor{preprocessor}{               \#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{1026                 \textcolor{keywordflow}{if} (@available (iOS 10.0, *))}
\DoxyCodeLine{1027                     printVideoOutputDebugInfo (movieFileOutput);}
\DoxyCodeLine{1028 \textcolor{preprocessor}{               \#endif}}
\DoxyCodeLine{1029 }
\DoxyCodeLine{1030                 \textcolor{keyword}{auto} url = [NSURL fileURLWithPath: \mbox{\hyperlink{namespacejuce_aad733be42bb4bbaddc08213b864faf9c}{juceStringToNS}} (file.\mbox{\hyperlink{class_file_ab46bb1ff1b9e41ebd907c51d4d6e8743}{getFullPathName}}())}
\DoxyCodeLine{1031                                       isDirectory: NO];}
\DoxyCodeLine{1032 }
\DoxyCodeLine{1033                 auto outputConnection = [movieFileOutput connectionWithMediaType: AVMediaTypeVideo];}
\DoxyCodeLine{1034                 outputConnection.videoOrientation = orientationToUse;}
\DoxyCodeLine{1035 }
\DoxyCodeLine{1036                 [movieFileOutput startRecordingToOutputFileURL: url recordingDelegate: delegate.\mbox{\hyperlink{namespacedsp_ab70e205bff92b09aa297e479676b5bc8}{get}}()];}
\DoxyCodeLine{1037             \}}
\DoxyCodeLine{1038 }
\DoxyCodeLine{1039             \textcolor{keywordtype}{void} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac33ca230910ae42b3171bd149ef0f84e}{stopRecording}}()}
\DoxyCodeLine{1040             \{}
\DoxyCodeLine{1041                 [movieFileOutput \mbox{\hyperlink{struct_camera_device_1_1_pimpl_ac33ca230910ae42b3171bd149ef0f84e}{stopRecording}}];}
\DoxyCodeLine{1042             \}}
\DoxyCodeLine{1043 }
\DoxyCodeLine{1044             \mbox{\hyperlink{class_time}{Time}} \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a140af780d9abb52ff7f4408c47a69beb}{getTimeOfFirstRecordedFrame}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{1045 \textcolor{keyword}{            }\{}
\DoxyCodeLine{1046                 \textcolor{keywordflow}{return} \mbox{\hyperlink{class_time}{Time}} (firstRecordedFrameTimeMs.get());}
\DoxyCodeLine{1047             \}}
\DoxyCodeLine{1048 }
\DoxyCodeLine{1049         \textcolor{keyword}{private}:}
\DoxyCodeLine{1050             \textcolor{keyword}{static} \textcolor{keywordtype}{void} printVideoOutputDebugInfo (AVCaptureMovieFileOutput* \mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}})}
\DoxyCodeLine{1051             \{}
\DoxyCodeLine{1052                 \mbox{\hyperlink{group__juce__core-maths_ga5158e6e8faa5553204f90af596fafaf5}{ignoreUnused}} (\mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}});}
\DoxyCodeLine{1053 }
\DoxyCodeLine{1054                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Available video codec types:"{}});}
\DoxyCodeLine{1055 }
\DoxyCodeLine{1056 \textcolor{preprocessor}{               \#if JUCE\_CAMERA\_LOG\_ENABLED}}
\DoxyCodeLine{1057                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{id} \mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}} \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} \mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}}.availableVideoCodecTypes)}
\DoxyCodeLine{1058                     JUCE\_CAMERA\_LOG (\mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{namespacegl_aeba9cad8d6b4f72e1da983fe48c14132}{type}}));}
\DoxyCodeLine{1059 \textcolor{preprocessor}{               \#endif}}
\DoxyCodeLine{1060 }
\DoxyCodeLine{1061                 JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Output settings per video connection:"{}});}
\DoxyCodeLine{1062 }
\DoxyCodeLine{1063 \textcolor{preprocessor}{               \#if JUCE\_CAMERA\_LOG\_ENABLED}}
\DoxyCodeLine{1064                 \textcolor{keywordflow}{for} (AVCaptureConnection* connection \mbox{\hyperlink{namespacegl_a72039bf7996167e32bca54980c5595e4}{in}} \mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}}.connections)}
\DoxyCodeLine{1065                     JUCE\_CAMERA\_LOG (\mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} ([[\mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}} outputSettingsForConnection: connection] description]));}
\DoxyCodeLine{1066 \textcolor{preprocessor}{               \#endif}}
\DoxyCodeLine{1067             \}}
\DoxyCodeLine{1068 }
\DoxyCodeLine{1069             \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1070             \textcolor{keyword}{struct }FileOutputRecordingDelegateClass    : \textcolor{keyword}{public} ObjCClass<NSObject<AVCaptureFileOutputRecordingDelegate>>}
\DoxyCodeLine{1071             \{}
\DoxyCodeLine{1072                 FileOutputRecordingDelegateClass()  : ObjCClass<NSObject<AVCaptureFileOutputRecordingDelegate>> (\textcolor{stringliteral}{"{}FileOutputRecordingDelegateClass\_"{}})}
\DoxyCodeLine{1073                 \{}
\DoxyCodeLine{1074                     addMethod (\textcolor{keyword}{@selector} (captureOutput:didStartRecordingToOutputFileAtURL:fromConnections:),        started);}
\DoxyCodeLine{1075                     addMethod (\textcolor{keyword}{@selector} (captureOutput:didFinishRecordingToOutputFileAtURL:fromConnections:\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}:), stopped);}
\DoxyCodeLine{1076 }
\DoxyCodeLine{1077                     addIvar<VideoRecorder*> (\textcolor{stringliteral}{"{}owner"{}});}
\DoxyCodeLine{1078 }
\DoxyCodeLine{1079                     registerClass();}
\DoxyCodeLine{1080                 \}}
\DoxyCodeLine{1081 }
\DoxyCodeLine{1082                 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1083                 \textcolor{keyword}{static} VideoRecorder\& getOwner (\textcolor{keywordtype}{id} \textcolor{keyword}{self})         \{ \textcolor{keywordflow}{return} *getIvar<VideoRecorder*> (\textcolor{keyword}{self}, \textcolor{stringliteral}{"{}owner"{}}); \}}
\DoxyCodeLine{1084                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} setOwner (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, VideoRecorder* \mbox{\hyperlink{namespacegl_aaa813f59532257ed092c4fad1b443fa5}{r}}) \{ object\_setInstanceVariable (\textcolor{keyword}{self}, \textcolor{stringliteral}{"{}owner"{}}, \mbox{\hyperlink{namespacegl_aaa813f59532257ed092c4fad1b443fa5}{r}}); \}}
\DoxyCodeLine{1085 }
\DoxyCodeLine{1086             \textcolor{keyword}{private}:}
\DoxyCodeLine{1087                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} started (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, \textcolor{keywordtype}{SEL}, AVCaptureFileOutput*, NSURL*, NSArray<AVCaptureConnection*>*)}
\DoxyCodeLine{1088                 \{}
\DoxyCodeLine{1089                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Started recording"{}});}
\DoxyCodeLine{1090 }
\DoxyCodeLine{1091                     getOwner (\textcolor{keyword}{self}).firstRecordedFrameTimeMs.set (\mbox{\hyperlink{class_time_a9acf1454101b83bc3c77b435778d698e}{Time::getCurrentTime}}().toMilliseconds());}
\DoxyCodeLine{1092                     getOwner (\textcolor{keyword}{self}).recordingInProgress = \textcolor{keyword}{true};}
\DoxyCodeLine{1093                 \}}
\DoxyCodeLine{1094 }
\DoxyCodeLine{1095                 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stopped (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, \textcolor{keywordtype}{SEL}, AVCaptureFileOutput*, NSURL*, NSArray<AVCaptureConnection*>*, NSError* \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{1096                 \{}
\DoxyCodeLine{1097                     \mbox{\hyperlink{class_string}{String}} errorString;}
\DoxyCodeLine{1098                     \textcolor{keywordtype}{bool} recordingPlayable = \textcolor{keyword}{true};}
\DoxyCodeLine{1099 }
\DoxyCodeLine{1100                     \textcolor{comment}{// There might have been an error in the recording, yet there may be a playable file...}}
\DoxyCodeLine{1101                     \textcolor{keywordflow}{if} ([\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} \mbox{\hyperlink{structcode}{code}}] != noErr)}
\DoxyCodeLine{1102                     \{}
\DoxyCodeLine{1103                         \textcolor{keywordtype}{id} \mbox{\hyperlink{namespacegl_ad24be0b39bf5b7d31f7c100de8508670}{value}} = [[\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}} userInfo] objectForKey: AVErrorRecordingSuccessfullyFinishedKey];}
\DoxyCodeLine{1104 }
\DoxyCodeLine{1105                         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacegl_ad24be0b39bf5b7d31f7c100de8508670}{value}} != nil \&\& ! [\mbox{\hyperlink{namespacegl_ad24be0b39bf5b7d31f7c100de8508670}{value}} boolValue])}
\DoxyCodeLine{1106                             recordingPlayable = \textcolor{keyword}{false};}
\DoxyCodeLine{1107 }
\DoxyCodeLine{1108                         errorString = \mbox{\hyperlink{namespacejuce_a42e5f26f6fd7b644c5f6f44728b0c03b}{nsStringToJuce}} (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}}.localizedDescription) + \textcolor{stringliteral}{"{}, playable: "{}} + \mbox{\hyperlink{class_string}{String}} ((\textcolor{keywordtype}{int}) recordingPlayable);}
\DoxyCodeLine{1109                     \}}
\DoxyCodeLine{1110 }
\DoxyCodeLine{1111                     JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}Stopped recording, error = "{}} + errorString);}
\DoxyCodeLine{1112 }
\DoxyCodeLine{1113                     getOwner (\textcolor{keyword}{self}).recordingInProgress = \textcolor{keyword}{false};}
\DoxyCodeLine{1114                 \}}
\DoxyCodeLine{1115             \};}
\DoxyCodeLine{1116 }
\DoxyCodeLine{1117             AVCaptureMovieFileOutput* movieFileOutput;}
\DoxyCodeLine{1118             std::unique\_ptr<NSObject<AVCaptureFileOutputRecordingDelegate>, NSObjectDeleter> delegate;}
\DoxyCodeLine{1119             \textcolor{keywordtype}{bool} recordingInProgress = \textcolor{keyword}{false};}
\DoxyCodeLine{1120             \mbox{\hyperlink{struct_atomic}{Atomic<int64>}} firstRecordedFrameTimeMs \{ 0 \};}
\DoxyCodeLine{1121         \};}
\DoxyCodeLine{1122 }
\DoxyCodeLine{1123         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1124         \textcolor{keywordtype}{void} addOutputIfPossible (AVCaptureOutput* \mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}})}
\DoxyCodeLine{1125         \{}
\DoxyCodeLine{1126             dispatch\_async (captureSessionQueue,\string^}
\DoxyCodeLine{1127                             \{}
\DoxyCodeLine{1128                                 \textcolor{keywordflow}{if} ([captureSession.get() canAddOutput: \mbox{\hyperlink{namespacegl_a6feaa3453ce5f1535f7b2709b198b7b6}{output}}])}
\DoxyCodeLine{1129                                 \{}
\DoxyCodeLine{1130                                     [captureSession.get() beginConfiguration];}
\DoxyCodeLine{1131                                     [captureSession.get() addOutput: output];}
\DoxyCodeLine{1132                                     [captureSession.get() commitConfiguration];}
\DoxyCodeLine{1133 }
\DoxyCodeLine{1134                                     return;}
\DoxyCodeLine{1135                                 \}}
\DoxyCodeLine{1136 }
\DoxyCodeLine{1137                                 \textcolor{comment}{// Can't add output to camera session!}}
\DoxyCodeLine{1138                                 \mbox{\hyperlink{group__juce__core-system_gadc044ce5efecbecf2f5a44cd00db67b3}{jassertfalse}};}
\DoxyCodeLine{1139                             \});}
\DoxyCodeLine{1140         \}}
\DoxyCodeLine{1141 }
\DoxyCodeLine{1142         \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1143         \textcolor{keywordtype}{void} cameraSessionStarted()}
\DoxyCodeLine{1144         \{}
\DoxyCodeLine{1145             sessionStarted = \textcolor{keyword}{true};}
\DoxyCodeLine{1146 }
\DoxyCodeLine{1147             owner.cameraSessionStarted();}
\DoxyCodeLine{1148         \}}
\DoxyCodeLine{1149 }
\DoxyCodeLine{1150         \textcolor{keywordtype}{void} cameraSessionRuntimeError (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{1151         \{}
\DoxyCodeLine{1152             owner.cameraSessionRuntimeError (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{1153         \}}
\DoxyCodeLine{1154 }
\DoxyCodeLine{1155         \textcolor{keywordtype}{void} callListeners (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\& \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}})}
\DoxyCodeLine{1156         \{}
\DoxyCodeLine{1157             owner.callListeners (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{1158         \}}
\DoxyCodeLine{1159 }
\DoxyCodeLine{1160         \textcolor{keywordtype}{void} notifyPictureTaken (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\& \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}})}
\DoxyCodeLine{1161         \{}
\DoxyCodeLine{1162             owner.notifyPictureTaken (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{1163         \}}
\DoxyCodeLine{1164 }
\DoxyCodeLine{1165         \mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}}\& owner;}
\DoxyCodeLine{1166 }
\DoxyCodeLine{1167         dispatch\_queue\_t captureSessionQueue;}
\DoxyCodeLine{1168         std::unique\_ptr<AVCaptureSession, NSObjectDeleter> captureSession;}
\DoxyCodeLine{1169         std::unique\_ptr<NSObject, NSObjectDeleter> delegate;}
\DoxyCodeLine{1170 }
\DoxyCodeLine{1171         StillPictureTaker stillPictureTaker;}
\DoxyCodeLine{1172         VideoRecorder videoRecorder;}
\DoxyCodeLine{1173 }
\DoxyCodeLine{1174         AVCaptureDevice* cameraDevice = nil;}
\DoxyCodeLine{1175         AVCaptureVideoPreviewLayer* previewLayer = nil;}
\DoxyCodeLine{1176 }
\DoxyCodeLine{1177         \textcolor{keywordtype}{bool} sessionStarted = \textcolor{keyword}{false};}
\DoxyCodeLine{1178 }
\DoxyCodeLine{1179         \mbox{\hyperlink{class_waitable_event}{WaitableEvent}} sessionClosedEvent;}
\DoxyCodeLine{1180 }
\DoxyCodeLine{1181         \textcolor{keyword}{static} \textcolor{keywordtype}{int} numCaptureSessions;}
\DoxyCodeLine{1182     \};}
\DoxyCodeLine{1183 }
\DoxyCodeLine{1184     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1185     \textcolor{keywordtype}{void} cameraSessionStarted()}
\DoxyCodeLine{1186     \{}
\DoxyCodeLine{1187         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraSessionStarted()"{}});}
\DoxyCodeLine{1188 }
\DoxyCodeLine{1189         cameraOpenCallback (cameraId, \{\});}
\DoxyCodeLine{1190     \}}
\DoxyCodeLine{1191 }
\DoxyCodeLine{1192     \textcolor{keywordtype}{void} cameraSessionRuntimeError (\textcolor{keyword}{const} \mbox{\hyperlink{class_string}{String}}\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}})}
\DoxyCodeLine{1193     \{}
\DoxyCodeLine{1194         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}cameraSessionRuntimeError(), error = "{}} + \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{1195 }
\DoxyCodeLine{1196         \textcolor{keywordflow}{if} (! notifiedOfCameraOpening)}
\DoxyCodeLine{1197         \{}
\DoxyCodeLine{1198             cameraOpenCallback (\{\}, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{1199         \}}
\DoxyCodeLine{1200         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1201         \{}
\DoxyCodeLine{1202             \textcolor{keywordflow}{if} (owner.onErrorOccurred != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1203                 owner.onErrorOccurred (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_af44443f87d7b66dff07b3d884445dca1}{error}});}
\DoxyCodeLine{1204         \}}
\DoxyCodeLine{1205     \}}
\DoxyCodeLine{1206 }
\DoxyCodeLine{1207     \textcolor{keywordtype}{void} callListeners (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\& \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}})}
\DoxyCodeLine{1208     \{}
\DoxyCodeLine{1209         \textcolor{keyword}{const} \mbox{\hyperlink{class_generic_scoped_lock}{ScopedLock}} sl (listenerLock);}
\DoxyCodeLine{1210         listeners.call ([=] (Listener\& l) \{ l.imageReceived (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}}); \});}
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212         \textcolor{keywordflow}{if} (listeners.size() == 1)}
\DoxyCodeLine{1213             triggerStillPictureCapture();}
\DoxyCodeLine{1214     \}}
\DoxyCodeLine{1215 }
\DoxyCodeLine{1216     \textcolor{keywordtype}{void} notifyPictureTaken (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\& \mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}})}
\DoxyCodeLine{1217     \{}
\DoxyCodeLine{1218         JUCE\_CAMERA\_LOG (\textcolor{stringliteral}{"{}notifyPictureTaken()"{}});}
\DoxyCodeLine{1219 }
\DoxyCodeLine{1220         \textcolor{keywordflow}{if} (pictureTakenCallback != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{1221             pictureTakenCallback (\mbox{\hyperlink{group__juce__gui__basics-accessibility_ggaf1349587ab6cac7e882cd63e1976682ca78805a221a988e79ef3f42d7c5bfd418}{image}});}
\DoxyCodeLine{1222     \}}
\DoxyCodeLine{1223 }
\DoxyCodeLine{1224     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1225     \textcolor{keywordtype}{void} triggerStillPictureCapture()}
\DoxyCodeLine{1226     \{}
\DoxyCodeLine{1227         captureSession.takeStillPicture();}
\DoxyCodeLine{1228     \}}
\DoxyCodeLine{1229 }
\DoxyCodeLine{1230     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1231     CameraDevice\& owner;}
\DoxyCodeLine{1232     \mbox{\hyperlink{class_string}{String}} cameraId;}
\DoxyCodeLine{1233     \mbox{\hyperlink{struct_camera_device_1_1_pimpl_aee53ed6db5b8ec3bdb39289775eabb76}{InternalOpenCameraResultCallback}} cameraOpenCallback;}
\DoxyCodeLine{1234 }
\DoxyCodeLine{1235     \mbox{\hyperlink{class_critical_section}{CriticalSection}} listenerLock;}
\DoxyCodeLine{1236     \mbox{\hyperlink{class_listener_list}{ListenerList<Listener>}} listeners;}
\DoxyCodeLine{1237 }
\DoxyCodeLine{1238     \mbox{\hyperlink{namespacejuce_a7959b0b488fde11032d8151bf10669a4}{std::function}}<\mbox{\hyperlink{png_8h_aa8c59027f9ab2769342f248709d68d17}{void}} (\textcolor{keyword}{const} \mbox{\hyperlink{class_image}{Image}}\&)> pictureTakenCallback;}
\DoxyCodeLine{1239 }
\DoxyCodeLine{1240     CaptureSession captureSession;}
\DoxyCodeLine{1241 }
\DoxyCodeLine{1242     \textcolor{keywordtype}{bool} notifiedOfCameraOpening = \textcolor{keyword}{false};}
\DoxyCodeLine{1243 }
\DoxyCodeLine{1244     \textcolor{keyword}{friend} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_viewer_component}{CameraDevice::ViewerComponent}};}
\DoxyCodeLine{1245 }
\DoxyCodeLine{1246     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1247     \mbox{\hyperlink{group__juce__core-system_ga6ab7a603bf4435c7cb286b1744366eb2}{JUCE\_DECLARE\_NON\_COPYABLE}} (\mbox{\hyperlink{struct_camera_device_1_1_pimpl_a5693c517fa4eedd5b9ccf84308cdcd19}{Pimpl}})}
\DoxyCodeLine{1248 \};}
\DoxyCodeLine{1249 }
\DoxyCodeLine{1250 \textcolor{keywordtype}{int} CameraDevice::Pimpl::CaptureSession::numCaptureSessions = 0;}
\DoxyCodeLine{1251 }
\DoxyCodeLine{1252 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1253 \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_viewer_component}{CameraDevice::ViewerComponent}}  : \textcolor{keyword}{public} UIViewComponent}
\DoxyCodeLine{1254 \{}
\DoxyCodeLine{1255     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1256     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_camera_device_1_1_viewer_component_1_1_juce_camera_device_viewer_class}{JuceCameraDeviceViewerClass}}    : \textcolor{keyword}{public} ObjCClass<UIView>}
\DoxyCodeLine{1257     \{}
\DoxyCodeLine{1258         \mbox{\hyperlink{struct_camera_device_1_1_viewer_component_1_1_juce_camera_device_viewer_class_a9111a50e8788c457b583e55d1dea3a79}{JuceCameraDeviceViewerClass}}()  : ObjCClass<UIView> (\textcolor{stringliteral}{"{}JuceCameraDeviceViewerClass\_"{}})}
\DoxyCodeLine{1259         \{}
\DoxyCodeLine{1260             addMethod (\textcolor{keyword}{@selector} (layoutSubviews), layoutSubviews);}
\DoxyCodeLine{1261 }
\DoxyCodeLine{1262             registerClass();}
\DoxyCodeLine{1263         \}}
\DoxyCodeLine{1264 }
\DoxyCodeLine{1265     \textcolor{keyword}{private}:}
\DoxyCodeLine{1266         \textcolor{keyword}{static} \textcolor{keywordtype}{void} layoutSubviews (\textcolor{keywordtype}{id} \textcolor{keyword}{self}, \textcolor{keywordtype}{SEL})}
\DoxyCodeLine{1267         \{}
\DoxyCodeLine{1268             sendSuperclassMessage<void> (\textcolor{keyword}{self}, \textcolor{keyword}{@selector} (layoutSubviews));}
\DoxyCodeLine{1269 }
\DoxyCodeLine{1270             UIView* asUIView = (UIView*) \textcolor{keyword}{self};}
\DoxyCodeLine{1271 }
\DoxyCodeLine{1272             updateOrientation (\textcolor{keyword}{self});}
\DoxyCodeLine{1273 }
\DoxyCodeLine{1274             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* previewLayer = getPreviewLayer (\textcolor{keyword}{self}))}
\DoxyCodeLine{1275                 previewLayer.frame = asUIView.bounds;}
\DoxyCodeLine{1276         \}}
\DoxyCodeLine{1277 }
\DoxyCodeLine{1278         \textcolor{keyword}{static} AVCaptureVideoPreviewLayer* getPreviewLayer (\textcolor{keywordtype}{id} \textcolor{keyword}{self})}
\DoxyCodeLine{1279         \{}
\DoxyCodeLine{1280             UIView* asUIView = (UIView*) \textcolor{keyword}{self};}
\DoxyCodeLine{1281 }
\DoxyCodeLine{1282             \textcolor{keywordflow}{if} (asUIView.layer.sublayers != nil \&\& [asUIView.layer.sublayers \mbox{\hyperlink{namespacegl_ad51b1b50b16ae6a9961a1632cb21be63}{count}}] > 0)}
\DoxyCodeLine{1283                 \textcolor{keywordflow}{if} ([asUIView.layer.sublayers[0] isKindOfClass: [AVCaptureVideoPreviewLayer \textcolor{keyword}{class}]])}
\DoxyCodeLine{1284                      \textcolor{keywordflow}{return} (AVCaptureVideoPreviewLayer*) asUIView.layer.sublayers[0];}
\DoxyCodeLine{1285 }
\DoxyCodeLine{1286             \textcolor{keywordflow}{return} nil;}
\DoxyCodeLine{1287         \}}
\DoxyCodeLine{1288 }
\DoxyCodeLine{1289         \textcolor{keyword}{static} \textcolor{keywordtype}{void} updateOrientation (\textcolor{keywordtype}{id} \textcolor{keyword}{self})}
\DoxyCodeLine{1290         \{}
\DoxyCodeLine{1291             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* previewLayer = getPreviewLayer (\textcolor{keyword}{self}))}
\DoxyCodeLine{1292             \{}
\DoxyCodeLine{1293                 UIDeviceOrientation o = [UIDevice currentDevice].orientation;}
\DoxyCodeLine{1294 }
\DoxyCodeLine{1295                 \textcolor{keywordflow}{if} (UIDeviceOrientationIsPortrait (o) || UIDeviceOrientationIsLandscape (o))}
\DoxyCodeLine{1296                 \{}
\DoxyCodeLine{1297                     \textcolor{keywordflow}{if} (previewLayer.connection != nil)}
\DoxyCodeLine{1298                         previewLayer.connection.videoOrientation = (AVCaptureVideoOrientation) o;}
\DoxyCodeLine{1299                 \}}
\DoxyCodeLine{1300             \}}
\DoxyCodeLine{1301         \}}
\DoxyCodeLine{1302     \};}
\DoxyCodeLine{1303 }
\DoxyCodeLine{1304     \mbox{\hyperlink{struct_camera_device_1_1_viewer_component_aa2953d6c88d135bab35a703fcf7276f9}{ViewerComponent}} (CameraDevice\& device)}
\DoxyCodeLine{1305     \{}
\DoxyCodeLine{1306         \textcolor{keyword}{static} JuceCameraDeviceViewerClass cls;}
\DoxyCodeLine{1307 }
\DoxyCodeLine{1308         \textcolor{comment}{// Initial size that can be overridden later.}}
\DoxyCodeLine{1309         setSize (640, 480);}
\DoxyCodeLine{1310 }
\DoxyCodeLine{1311         \textcolor{keyword}{auto} view = [cls.createInstance() init];}
\DoxyCodeLine{1312         setView (view);}
\DoxyCodeLine{1313 }
\DoxyCodeLine{1314         \textcolor{keyword}{auto}* previewLayer = device.pimpl-\/>captureSession.createPreviewLayer();}
\DoxyCodeLine{1315         previewLayer.frame = view.bounds;}
\DoxyCodeLine{1316 }
\DoxyCodeLine{1317         UIInterfaceOrientation statusBarOrientation = [UIApplication sharedApplication].statusBarOrientation;}
\DoxyCodeLine{1318         AVCaptureVideoOrientation videoOrientation = statusBarOrientation != UIInterfaceOrientationUnknown}
\DoxyCodeLine{1319                                                    ? (AVCaptureVideoOrientation) statusBarOrientation}
\DoxyCodeLine{1320                                                    : AVCaptureVideoOrientationPortrait;}
\DoxyCodeLine{1321 }
\DoxyCodeLine{1322         previewLayer.connection.videoOrientation = videoOrientation;}
\DoxyCodeLine{1323 }
\DoxyCodeLine{1324         [view.layer addSublayer: previewLayer];}
\DoxyCodeLine{1325     \}}
\DoxyCodeLine{1326 \};}
\DoxyCodeLine{1327 }
\DoxyCodeLine{1328 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{1329 \mbox{\hyperlink{class_string}{String}} CameraDevice::getFileExtension()}
\DoxyCodeLine{1330 \{}
\DoxyCodeLine{1331     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}.mov"{}};}
\DoxyCodeLine{1332 \}}
\DoxyCodeLine{1333 }
\DoxyCodeLine{1334 \textcolor{preprocessor}{\#if JUCE\_USE\_NEW\_CAMERA\_API}}
\DoxyCodeLine{1335  \mbox{\hyperlink{group__juce__core-system_ga157f2229764b17137d8814bec95df109}{JUCE\_END\_IGNORE\_WARNINGS\_GCC\_LIKE}}}
\DoxyCodeLine{1336 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
