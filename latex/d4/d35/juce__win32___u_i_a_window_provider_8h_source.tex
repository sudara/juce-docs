\hypertarget{juce__win32___u_i_a_window_provider_8h_source}{}\doxysection{juce\+\_\+win32\+\_\+\+UIAWindow\+Provider.\+h}
\label{juce__win32___u_i_a_window_provider_8h_source}\index{build/juce\_gui\_basics/native/accessibility/juce\_win32\_UIAWindowProvider.h@{build/juce\_gui\_basics/native/accessibility/juce\_win32\_UIAWindowProvider.h}}
\mbox{\hyperlink{juce__win32___u_i_a_window_provider_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{3 \textcolor{comment}{}}
\DoxyCodeLine{4 \textcolor{comment}{   This file is part of the JUCE library.}}
\DoxyCodeLine{5 \textcolor{comment}{   Copyright (c) 2020 -\/ Raw Material Software Limited}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{   JUCE is an open source library subject to commercial or open-\/source}}
\DoxyCodeLine{8 \textcolor{comment}{   licensing.}}
\DoxyCodeLine{9 \textcolor{comment}{}}
\DoxyCodeLine{10 \textcolor{comment}{   By using JUCE, you agree to the terms of both the JUCE 6 End-\/User License}}
\DoxyCodeLine{11 \textcolor{comment}{   Agreement and JUCE Privacy Policy (both effective as of the 16th June 2020).}}
\DoxyCodeLine{12 \textcolor{comment}{}}
\DoxyCodeLine{13 \textcolor{comment}{   End User License Agreement: www.juce.com/juce-\/6-\/licence}}
\DoxyCodeLine{14 \textcolor{comment}{   Privacy Policy: www.juce.com/juce-\/privacy-\/policy}}
\DoxyCodeLine{15 \textcolor{comment}{}}
\DoxyCodeLine{16 \textcolor{comment}{   Or: You may also use this code under the terms of the GPL v3 (see}}
\DoxyCodeLine{17 \textcolor{comment}{   www.gnu.org/licenses).}}
\DoxyCodeLine{18 \textcolor{comment}{}}
\DoxyCodeLine{19 \textcolor{comment}{   JUCE IS PROVIDED "{}AS IS"{} WITHOUT ANY WARRANTY, AND ALL WARRANTIES, WHETHER}}
\DoxyCodeLine{20 \textcolor{comment}{   EXPRESSED OR IMPLIED, INCLUDING MERCHANTABILITY AND FITNESS FOR PURPOSE, ARE}}
\DoxyCodeLine{21 \textcolor{comment}{   DISCLAIMED.}}
\DoxyCodeLine{22 \textcolor{comment}{}}
\DoxyCodeLine{23 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{24 \textcolor{comment}{*/}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacejuce}{juce}}}
\DoxyCodeLine{27 \{}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{30 \textcolor{keyword}{class }\mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider}{UIAWindowProvider}} : \textcolor{keyword}{public} \mbox{\hyperlink{classjuce_1_1_u_i_a_provider_base}{UIAProviderBase}},}
\DoxyCodeLine{31                           \textcolor{keyword}{public} \mbox{\hyperlink{classjuce_1_1_com_base_class_helper}{ComBaseClassHelper}}<ComTypes::IWindowProvider>}
\DoxyCodeLine{32 \{}
\DoxyCodeLine{33 \textcolor{keyword}{public}:}
\DoxyCodeLine{34     \textcolor{keyword}{using} \mbox{\hyperlink{classjuce_1_1_u_i_a_provider_base_ae6ed5c67016c257a80661f180ed7eb7a}{UIAProviderBase::UIAProviderBase}};}
\DoxyCodeLine{35 }
\DoxyCodeLine{36     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{37     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_ae4992d8e4a1ebd1440bb715aec0ce5f0}{SetVisualState}} (\mbox{\hyperlink{namespacejuce_1_1_com_types_ae2485e09766615b24c6a050726c880c6}{ComTypes::WindowVisualState}} state)\textcolor{keyword}{ override}}
\DoxyCodeLine{38 \textcolor{keyword}{    }\{}
\DoxyCodeLine{39         \textcolor{keywordflow}{if} (! \mbox{\hyperlink{classjuce_1_1_u_i_a_provider_base_aee4ce572d15493baa9d12a66b283dd49}{isElementValid}}())}
\DoxyCodeLine{40             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_ELEMENTNOTAVAILABLE;}
\DoxyCodeLine{41 }
\DoxyCodeLine{42         \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* peer = getPeer())}
\DoxyCodeLine{43         \{}
\DoxyCodeLine{44             \textcolor{keywordflow}{switch} (state)}
\DoxyCodeLine{45             \{}
\DoxyCodeLine{46                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacejuce_1_1_com_types_ae2485e09766615b24c6a050726c880c6a875f30f7e2f351199d92c7aa136242c6}{ComTypes::WindowVisualState\_Maximized}}:}
\DoxyCodeLine{47                     peer-\/>setFullScreen (\textcolor{keyword}{true});}
\DoxyCodeLine{48                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacejuce_1_1_com_types_ae2485e09766615b24c6a050726c880c6a01e71d9636c166a5f404534c332b146c}{ComTypes::WindowVisualState\_Minimized}}:}
\DoxyCodeLine{51                     peer-\/>setMinimised (\textcolor{keyword}{true});}
\DoxyCodeLine{52                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{53 }
\DoxyCodeLine{54                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacejuce_1_1_com_types_ae2485e09766615b24c6a050726c880c6a71164aac3522d6521f0016540292e8c5}{ComTypes::WindowVisualState\_Normal}}:}
\DoxyCodeLine{55                     peer-\/>setFullScreen (\textcolor{keyword}{false});}
\DoxyCodeLine{56                     peer-\/>setMinimised (\textcolor{keyword}{false});}
\DoxyCodeLine{57                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{58 }
\DoxyCodeLine{59                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{60                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{61             \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63             \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{64         \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66         \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{67     \}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_af77bc5970af1df8764efe721d767122a}{Close}}()\textcolor{keyword}{ override}}
\DoxyCodeLine{70 \textcolor{keyword}{    }\{}
\DoxyCodeLine{71         \textcolor{keywordflow}{if} (! \mbox{\hyperlink{classjuce_1_1_u_i_a_provider_base_aee4ce572d15493baa9d12a66b283dd49}{isElementValid}}())}
\DoxyCodeLine{72             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_ELEMENTNOTAVAILABLE;}
\DoxyCodeLine{73 }
\DoxyCodeLine{74         \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* peer = getPeer())}
\DoxyCodeLine{75         \{}
\DoxyCodeLine{76             peer-\/>handleUserClosingWindow();}
\DoxyCodeLine{77             \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{78         \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80         \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{81     \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_a1cc365d5be173423c966e8a36d592e0b}{WaitForInputIdle}} (\textcolor{keywordtype}{int}, BOOL* pRetVal)\textcolor{keyword}{ override}}
\DoxyCodeLine{84 \textcolor{keyword}{    }\{}
\DoxyCodeLine{85         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a8bed7e9b52b4c0208d41ac6d2052d05e}{withCheckedComArgs}} (pRetVal, *\textcolor{keyword}{this}, []}
\DoxyCodeLine{86         \{}
\DoxyCodeLine{87             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{88         \});}
\DoxyCodeLine{89     \}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_af95fb8b414464023cde676a7859136fd}{get\_CanMaximize}} (BOOL* pRetVal)\textcolor{keyword}{ override}}
\DoxyCodeLine{92 \textcolor{keyword}{    }\{}
\DoxyCodeLine{93         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a8bed7e9b52b4c0208d41ac6d2052d05e}{withCheckedComArgs}} (pRetVal, *\textcolor{keyword}{this}, [\&]() -\/> HRESULT}
\DoxyCodeLine{94         \{}
\DoxyCodeLine{95             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* peer = getPeer())}
\DoxyCodeLine{96             \{}
\DoxyCodeLine{97                 *pRetVal = (peer-\/>getStyleFlags() \& \mbox{\hyperlink{class_component_peer_a94a21f91c61f8211774d6f43243a6ddcab56ba75cd98f8e630a907c3a8a4836c8}{ComponentPeer::windowHasMaximiseButton}}) != 0;}
\DoxyCodeLine{98                 \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{99             \}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{102         \});}
\DoxyCodeLine{103     \}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_ada5438f9f60f266c27b075b3ea9b8324}{get\_CanMinimize}} (BOOL* pRetVal)\textcolor{keyword}{ override}}
\DoxyCodeLine{106 \textcolor{keyword}{    }\{}
\DoxyCodeLine{107         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a8bed7e9b52b4c0208d41ac6d2052d05e}{withCheckedComArgs}} (pRetVal, *\textcolor{keyword}{this}, [\&]() -\/> HRESULT}
\DoxyCodeLine{108         \{}
\DoxyCodeLine{109             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* peer = getPeer())}
\DoxyCodeLine{110             \{}
\DoxyCodeLine{111                 *pRetVal = (peer-\/>getStyleFlags() \& \mbox{\hyperlink{class_component_peer_a94a21f91c61f8211774d6f43243a6ddca01571bf1cfc4e3bc17198b593e64750a}{ComponentPeer::windowHasMinimiseButton}}) != 0;}
\DoxyCodeLine{112                 \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{113             \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{116         \});}
\DoxyCodeLine{117     \}}
\DoxyCodeLine{118 }
\DoxyCodeLine{119     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_a003091b4f64d0d5d30003bb25a286d9c}{get\_IsModal}} (BOOL* pRetVal)\textcolor{keyword}{ override}}
\DoxyCodeLine{120 \textcolor{keyword}{    }\{}
\DoxyCodeLine{121         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a8bed7e9b52b4c0208d41ac6d2052d05e}{withCheckedComArgs}} (pRetVal, *\textcolor{keyword}{this}, [\&]() -\/> HRESULT}
\DoxyCodeLine{122         \{}
\DoxyCodeLine{123             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* peer = getPeer())}
\DoxyCodeLine{124             \{}
\DoxyCodeLine{125                 *pRetVal = peer-\/>getComponent().isCurrentlyModal();}
\DoxyCodeLine{126                 \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{127             \}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{130         \});}
\DoxyCodeLine{131     \}}
\DoxyCodeLine{132 }
\DoxyCodeLine{133     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_a9c0e4af55da133c7d07bc04f15e0775d}{get\_WindowVisualState}} (\mbox{\hyperlink{namespacejuce_1_1_com_types_ae2485e09766615b24c6a050726c880c6}{ComTypes::WindowVisualState}}* pRetVal)\textcolor{keyword}{ override}}
\DoxyCodeLine{134 \textcolor{keyword}{    }\{}
\DoxyCodeLine{135         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a8bed7e9b52b4c0208d41ac6d2052d05e}{withCheckedComArgs}} (pRetVal, *\textcolor{keyword}{this}, [\&]() -\/> HRESULT}
\DoxyCodeLine{136         \{}
\DoxyCodeLine{137             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* peer = getPeer())}
\DoxyCodeLine{138             \{}
\DoxyCodeLine{139                 \textcolor{keywordflow}{if} (peer-\/>isFullScreen())}
\DoxyCodeLine{140                     *pRetVal = \mbox{\hyperlink{namespacejuce_1_1_com_types_ae2485e09766615b24c6a050726c880c6a875f30f7e2f351199d92c7aa136242c6}{ComTypes::WindowVisualState\_Maximized}};}
\DoxyCodeLine{141                 \textcolor{keywordflow}{else} if (peer-\/>isMinimised())}
\DoxyCodeLine{142                     *pRetVal = \mbox{\hyperlink{namespacejuce_1_1_com_types_ae2485e09766615b24c6a050726c880c6a01e71d9636c166a5f404534c332b146c}{ComTypes::WindowVisualState\_Minimized}};}
\DoxyCodeLine{143                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{144                     *pRetVal = \mbox{\hyperlink{namespacejuce_1_1_com_types_ae2485e09766615b24c6a050726c880c6a71164aac3522d6521f0016540292e8c5}{ComTypes::WindowVisualState\_Normal}};}
\DoxyCodeLine{145 }
\DoxyCodeLine{146                 \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{147             \}}
\DoxyCodeLine{148 }
\DoxyCodeLine{149             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{150         \});}
\DoxyCodeLine{151     \}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_ae8dba0d9663ab94d785ec0c45e4cc569}{get\_WindowInteractionState}} (\mbox{\hyperlink{namespacejuce_1_1_com_types_ab114d90d028b1ca02b04e156d47409f1}{ComTypes::WindowInteractionState}}* pRetVal)\textcolor{keyword}{ override}}
\DoxyCodeLine{154 \textcolor{keyword}{    }\{}
\DoxyCodeLine{155         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a8bed7e9b52b4c0208d41ac6d2052d05e}{withCheckedComArgs}} (pRetVal, *\textcolor{keyword}{this}, [\&]() -\/> HRESULT}
\DoxyCodeLine{156         \{}
\DoxyCodeLine{157             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* peer = getPeer())}
\DoxyCodeLine{158             \{}
\DoxyCodeLine{159                 *pRetVal = peer-\/>getComponent().isCurrentlyBlockedByAnotherModalComponent()}
\DoxyCodeLine{160                     ? \mbox{\hyperlink{namespacejuce_1_1_com_types_ab114d90d028b1ca02b04e156d47409f1a0baf5b35f1e24315ee5042c63f9dff53}{ComTypes::WindowInteractionState::WindowInteractionState\_BlockedByModalWindow}}}
\DoxyCodeLine{161                     : \mbox{\hyperlink{namespacejuce_1_1_com_types_ab114d90d028b1ca02b04e156d47409f1aa191fa6f1af47aceab43516d77370cb7}{ComTypes::WindowInteractionState::WindowInteractionState\_Running}};}
\DoxyCodeLine{162 }
\DoxyCodeLine{163                 \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{164             \}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{167         \});}
\DoxyCodeLine{168     \}}
\DoxyCodeLine{169 }
\DoxyCodeLine{170     \mbox{\hyperlink{juce__win32___com_smart_ptr_8h_adf7ea5b8ae4dd1bb0ef1193c5c758eba}{JUCE\_COMRESULT}} \mbox{\hyperlink{classjuce_1_1_u_i_a_window_provider_a78f9c05370f9a3a3deb2453242ad94c8}{get\_IsTopmost}} (BOOL* pRetVal)\textcolor{keyword}{ override}}
\DoxyCodeLine{171 \textcolor{keyword}{    }\{}
\DoxyCodeLine{172         \textcolor{keywordflow}{return} \mbox{\hyperlink{namespacejuce_a8bed7e9b52b4c0208d41ac6d2052d05e}{withCheckedComArgs}} (pRetVal, *\textcolor{keyword}{this}, [\&]() -\/> HRESULT}
\DoxyCodeLine{173         \{}
\DoxyCodeLine{174             \textcolor{keywordflow}{if} (\textcolor{keyword}{auto}* peer = getPeer())}
\DoxyCodeLine{175             \{}
\DoxyCodeLine{176                 *pRetVal = peer-\/>isFocused();}
\DoxyCodeLine{177                 \textcolor{keywordflow}{return} S\_OK;}
\DoxyCodeLine{178             \}}
\DoxyCodeLine{179 }
\DoxyCodeLine{180             \textcolor{keywordflow}{return} (HRESULT) UIA\_E\_NOTSUPPORTED;}
\DoxyCodeLine{181         \});}
\DoxyCodeLine{182     \}}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{keyword}{private}:}
\DoxyCodeLine{185     \mbox{\hyperlink{class_component_peer}{ComponentPeer}}* getPeer()\textcolor{keyword}{ const}}
\DoxyCodeLine{186 \textcolor{keyword}{    }\{}
\DoxyCodeLine{187         \textcolor{keywordflow}{return} \mbox{\hyperlink{classjuce_1_1_u_i_a_provider_base_a9a977d439e4162efbfd008d4221eda9d}{getHandler}}().\mbox{\hyperlink{class_accessibility_handler_acb0f1a9ba27ae6d444307259ec1dfc62}{getComponent}}().\mbox{\hyperlink{class_component_a6a137109881ef1e268ee5ec51a633269}{getPeer}}();}
\DoxyCodeLine{188     \}}
\DoxyCodeLine{189 }
\DoxyCodeLine{190     \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{191     \mbox{\hyperlink{group__juce__core-system_ga851b02724a8158a7f746c66b5758b3dd}{JUCE\_DECLARE\_NON\_COPYABLE\_WITH\_LEAK\_DETECTOR}} (UIAWindowProvider)}
\DoxyCodeLine{192 \};}
\DoxyCodeLine{193 }
\DoxyCodeLine{194 \} \textcolor{comment}{// namespace juce}}

\end{DoxyCode}
