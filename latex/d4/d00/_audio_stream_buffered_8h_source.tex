\hypertarget{_audio_stream_buffered_8h_source}{}\doxysection{Audio\+Stream\+Buffered.\+h}
\label{_audio_stream_buffered_8h_source}\index{build/juce\_audio\_devices/native/oboe/src/opensles/AudioStreamBuffered.h@{build/juce\_audio\_devices/native/oboe/src/opensles/AudioStreamBuffered.h}}
\mbox{\hyperlink{_audio_stream_buffered_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright (C) 2016 The Android Open Source Project}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{ * you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{11 \textcolor{comment}{ * distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{12 \textcolor{comment}{ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{13 \textcolor{comment}{ * See the License for the specific language governing permissions and}}
\DoxyCodeLine{14 \textcolor{comment}{ * limitations under the License.}}
\DoxyCodeLine{15 \textcolor{comment}{ */}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#ifndef OBOE\_STREAM\_BUFFERED\_H}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#define OBOE\_STREAM\_BUFFERED\_H}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <cstring>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <cassert>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_oboe_debug_8h}{common/OboeDebug.h}}"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_audio_stream_8h}{oboe/AudioStream.h}}"{}}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_audio_stream_callback_8h}{oboe/AudioStreamCallback.h}}"{}}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_fifo_buffer_8h}{fifo/FifoBuffer.h}}"{}}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoboe}{oboe}} \{}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{comment}{// A stream that contains a FIFO buffer.}}
\DoxyCodeLine{30 \textcolor{comment}{// This is used to implement blocking reads and writes.}}
\DoxyCodeLine{31 \textcolor{keyword}{class }\mbox{\hyperlink{classoboe_1_1_audio_stream_buffered}{AudioStreamBuffered}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoboe_1_1_audio_stream}{AudioStream}} \{}
\DoxyCodeLine{32 \textcolor{keyword}{public}:}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_a5cb215e39083b3b916a569b36361e378}{AudioStreamBuffered}}();}
\DoxyCodeLine{35     \textcolor{keyword}{explicit} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_a5cb215e39083b3b916a569b36361e378}{AudioStreamBuffered}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoboe_1_1_audio_stream_builder}{AudioStreamBuilder}} \&builder);}
\DoxyCodeLine{36 }
\DoxyCodeLine{37     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_a8c416dd8ee5e15f600271dd55d3427b0}{allocateFifo}}();}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 }
\DoxyCodeLine{40     \mbox{\hyperlink{classoboe_1_1_result_with_value}{ResultWithValue<int32\_t>}} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_ab9979f822fbd21a48120815f7172b74d}{write}}(\textcolor{keyword}{const} \textcolor{keywordtype}{void} *buffer,}
\DoxyCodeLine{41                   int32\_t numFrames,}
\DoxyCodeLine{42                   int64\_t timeoutNanoseconds) \textcolor{keyword}{override};}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \mbox{\hyperlink{classoboe_1_1_result_with_value}{ResultWithValue<int32\_t>}} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_af7bccba4ce8c602da1b2f43ede05a9ec}{read}}(\textcolor{keywordtype}{void} *buffer,}
\DoxyCodeLine{45                  int32\_t numFrames,}
\DoxyCodeLine{46                  int64\_t timeoutNanoseconds) \textcolor{keyword}{override};}
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \mbox{\hyperlink{classoboe_1_1_result_with_value}{ResultWithValue<int32\_t>}} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_af6a2cdda3ea49f7969283b2ae6309981}{setBufferSizeInFrames}}(int32\_t requestedFrames) \textcolor{keyword}{override};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     int32\_t \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_aa4a34afbfb91cd8afb714e2aaa8ceae2}{getBufferCapacityInFrames}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \mbox{\hyperlink{classoboe_1_1_result_with_value}{ResultWithValue<int32\_t>}} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_aacd84a863127385260c208d945986ac5}{getXRunCount}}()\textcolor{keyword}{ override }\{}
\DoxyCodeLine{53         \textcolor{keywordflow}{return} \mbox{\hyperlink{classoboe_1_1_result_with_value}{ResultWithValue<int32\_t>}}(mXRunCount);}
\DoxyCodeLine{54     \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_af9996bbf7cef93e9cd187c6c77a0da34}{isXRunCountSupported}}() \textcolor{keyword}{const override};}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keyword}{protected}:}
\DoxyCodeLine{59 }
\DoxyCodeLine{60     \mbox{\hyperlink{namespaceoboe_af85fc9910a287df6c5df0ed396bb75cd}{DataCallbackResult}} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_ac268d7fc5cf579113f1fff987ee66e66}{onDefaultCallback}}(\textcolor{keywordtype}{void} *audioData, \textcolor{keywordtype}{int} numFrames) \textcolor{keyword}{override};}
\DoxyCodeLine{61 }
\DoxyCodeLine{62     \textcolor{comment}{// If there is no callback then we need a FIFO between the App and OpenSL ES.}}
\DoxyCodeLine{63     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_a4b371599748c4dba0f397188d22c1f36}{usingFIFO}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} !\mbox{\hyperlink{classoboe_1_1_audio_stream_base_a9a54d38b985a2eb12c6972104dc0ce73}{isDataCallbackSpecified}}(); \}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65     \textcolor{keyword}{virtual} \mbox{\hyperlink{class_result}{Result}} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_a2fde4543dcba445973a0671c946a6a3a}{updateServiceFrameCounter}}() = 0;}
\DoxyCodeLine{66 }
\DoxyCodeLine{67     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_a69e0457368a140f47a59ea279678d783}{updateFramesRead}}() \textcolor{keyword}{override};}
\DoxyCodeLine{68     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoboe_1_1_audio_stream_buffered_aa04e92f5ccc531c235a6de22d9d012b3}{updateFramesWritten}}() \textcolor{keyword}{override};}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{keyword}{private}:}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     int64\_t predictNextCallbackTime();}
\DoxyCodeLine{73 }
\DoxyCodeLine{74     \textcolor{keywordtype}{void} markCallbackTime(int32\_t numFrames);}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{comment}{// Read or write to the FIFO.}}
\DoxyCodeLine{77     \textcolor{comment}{// Only pass one pointer and set the other to nullptr.}}
\DoxyCodeLine{78     \mbox{\hyperlink{classoboe_1_1_result_with_value}{ResultWithValue<int32\_t>}} transfer(\textcolor{keywordtype}{void} *\mbox{\hyperlink{namespacegl_af6016756015f6ac27d6bc6de2fbb4f52}{readBuffer}},}
\DoxyCodeLine{79             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *\mbox{\hyperlink{namespacegl_a23154b7807e0d197a094a3f709b241fd}{writeBuffer}},}
\DoxyCodeLine{80             int32\_t numFrames,}
\DoxyCodeLine{81             int64\_t timeoutNanoseconds);}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     \textcolor{keywordtype}{void} incrementXRunCount() \{}
\DoxyCodeLine{84         ++mXRunCount;}
\DoxyCodeLine{85     \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87     std::unique\_ptr<FifoBuffer>   mFifoBuffer\{\};}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     int64\_t mBackgroundRanAtNanoseconds = 0;}
\DoxyCodeLine{90     int32\_t mLastBackgroundSize = 0;}
\DoxyCodeLine{91     int32\_t mXRunCount = 0;}
\DoxyCodeLine{92 \};}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 \} \textcolor{comment}{// namespace oboe}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//OBOE\_STREAM\_BUFFERED\_H}}

\end{DoxyCode}
