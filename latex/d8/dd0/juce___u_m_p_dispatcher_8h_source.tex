\hypertarget{juce___u_m_p_dispatcher_8h_source}{}\doxysection{juce\+\_\+\+UMPDispatcher.\+h}
\label{juce___u_m_p_dispatcher_8h_source}\index{build/juce\_audio\_basics/midi/ump/juce\_UMPDispatcher.h@{build/juce\_audio\_basics/midi/ump/juce\_UMPDispatcher.h}}
\mbox{\hyperlink{juce___u_m_p_dispatcher_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{5 \textcolor{comment}{/*}}
\DoxyCodeLine{6 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{7 \textcolor{comment}{}}
\DoxyCodeLine{8 \textcolor{comment}{   This file is part of the JUCE library.}}
\DoxyCodeLine{9 \textcolor{comment}{   Copyright (c) 2020 -\/ Raw Material Software Limited}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{   JUCE is an open source library subject to commercial or open-\/source}}
\DoxyCodeLine{12 \textcolor{comment}{   licensing.}}
\DoxyCodeLine{13 \textcolor{comment}{}}
\DoxyCodeLine{14 \textcolor{comment}{   The code included in this file is provided under the terms of the ISC license}}
\DoxyCodeLine{15 \textcolor{comment}{   http://www.isc.org/downloads/software-\/support-\/policy/isc-\/license. Permission}}
\DoxyCodeLine{16 \textcolor{comment}{   To use, copy, modify, and/or distribute this software for any purpose with or}}
\DoxyCodeLine{17 \textcolor{comment}{   without fee is hereby granted provided that the above copyright notice and}}
\DoxyCodeLine{18 \textcolor{comment}{   this permission notice appear in all copies.}}
\DoxyCodeLine{19 \textcolor{comment}{}}
\DoxyCodeLine{20 \textcolor{comment}{   JUCE IS PROVIDED "{}AS IS"{} WITHOUT ANY WARRANTY, AND ALL WARRANTIES, WHETHER}}
\DoxyCodeLine{21 \textcolor{comment}{   EXPRESSED OR IMPLIED, INCLUDING MERCHANTABILITY AND FITNESS FOR PURPOSE, ARE}}
\DoxyCodeLine{22 \textcolor{comment}{   DISCLAIMED.}}
\DoxyCodeLine{23 \textcolor{comment}{}}
\DoxyCodeLine{24 \textcolor{comment}{  ==============================================================================}}
\DoxyCodeLine{25 \textcolor{comment}{*/}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#ifndef DOXYGEN}}
\DoxyCodeLine{28 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceuniversal__midi__packets}{universal\_midi\_packets}}}
\DoxyCodeLine{29 \{}
\DoxyCodeLine{30 }
\DoxyCodeLine{37 \textcolor{keyword}{class }\mbox{\hyperlink{classuniversal__midi__packets_1_1_dispatcher}{Dispatcher}}}
\DoxyCodeLine{38 \{}
\DoxyCodeLine{39 \textcolor{keyword}{public}:}
\DoxyCodeLine{41     \textcolor{keywordtype}{void} \mbox{\hyperlink{classuniversal__midi__packets_1_1_dispatcher_a68f661a45fcda7e76c3597fa62947873}{reset}}() \{ currentPacketLen = 0; \}}
\DoxyCodeLine{42 }
\DoxyCodeLine{49     \textcolor{keyword}{template} <\textcolor{keyword}{typename} PacketCallbackFunction>}
\DoxyCodeLine{50     \textcolor{keywordtype}{void} \mbox{\hyperlink{classuniversal__midi__packets_1_1_dispatcher_afbb4ca1ef9a0c018415bb76297dd0a21}{dispatch}} (\textcolor{keyword}{const} uint32\_t* \mbox{\hyperlink{group__juce__core-files_ga3b8789907a46172ef0bdc8f656d6e355}{begin}},}
\DoxyCodeLine{51                    \textcolor{keyword}{const} uint32\_t* \mbox{\hyperlink{group__juce__core-files_ga4a3194f4f741f9bd653f28733358f62c}{end}},}
\DoxyCodeLine{52                    \textcolor{keywordtype}{double} timeStamp,}
\DoxyCodeLine{53                    PacketCallbackFunction\&\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}})}
\DoxyCodeLine{54     \{}
\DoxyCodeLine{55         std::for\_each (\mbox{\hyperlink{group__juce__core-files_ga3b8789907a46172ef0bdc8f656d6e355}{begin}}, \mbox{\hyperlink{group__juce__core-files_ga4a3194f4f741f9bd653f28733358f62c}{end}}, [\&] (uint32\_t word)}
\DoxyCodeLine{56         \{}
\DoxyCodeLine{57             nextPacket[currentPacketLen++] = word;}
\DoxyCodeLine{58 }
\DoxyCodeLine{59             \textcolor{keywordflow}{if} (currentPacketLen == \mbox{\hyperlink{structuniversal__midi__packets_1_1_utils_ab8be369da2c35963dda3db2221d660f4}{Utils::getNumWordsForMessageType}} (nextPacket.front()))}
\DoxyCodeLine{60             \{}
\DoxyCodeLine{61                 callback (View (nextPacket.data()), timeStamp);}
\DoxyCodeLine{62                 currentPacketLen = 0;}
\DoxyCodeLine{63             \}}
\DoxyCodeLine{64         \});}
\DoxyCodeLine{65     \}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{keyword}{private}:}
\DoxyCodeLine{68     std::array<uint32\_t, 4> nextPacket;}
\DoxyCodeLine{69     \textcolor{keywordtype}{size\_t} currentPacketLen = 0;}
\DoxyCodeLine{70 \};}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{80 \textcolor{comment}{}\textcolor{keyword}{class }\mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher}{BytestreamToUMPDispatcher}}}
\DoxyCodeLine{81 \{}
\DoxyCodeLine{82 \textcolor{keyword}{public}:}
\DoxyCodeLine{88     \textcolor{keyword}{explicit} \mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher_a65ebd283b7f77257c27ac8d271480bc8}{BytestreamToUMPDispatcher}} (\mbox{\hyperlink{namespaceuniversal__midi__packets_a326824bbd3be0be66cbe449db58db252}{PacketProtocol}} pp, \textcolor{keywordtype}{int} storageSize)}
\DoxyCodeLine{89         : concatenator (storageSize),}
\DoxyCodeLine{90           converter (pp)}
\DoxyCodeLine{91     \{\}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93     \textcolor{keywordtype}{void} \mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher_a7ae3069b92753da98c800081b8ec7843}{reset}}()}
\DoxyCodeLine{94     \{}
\DoxyCodeLine{95         concatenator.\mbox{\hyperlink{class_midi_data_concatenator_a1d3eaa05ed79ca3a6fec638a46a29f3c}{reset}}();}
\DoxyCodeLine{96         converter.\mbox{\hyperlink{classuniversal__midi__packets_1_1_generic_u_m_p_converter_ae131cd42b8d3690b132ed9c4511077ec}{reset}}();}
\DoxyCodeLine{97     \}}
\DoxyCodeLine{98 }
\DoxyCodeLine{106     \textcolor{keyword}{template} <\textcolor{keyword}{typename} PacketCallbackFunction>}
\DoxyCodeLine{107     \textcolor{keywordtype}{void} \mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher_a40aaab0cd1153aa59a80d0b067f05f7a}{dispatch}} (\textcolor{keyword}{const} uint8\_t* \mbox{\hyperlink{group__juce__core-files_ga3b8789907a46172ef0bdc8f656d6e355}{begin}},}
\DoxyCodeLine{108                    \textcolor{keyword}{const} uint8\_t* \mbox{\hyperlink{group__juce__core-files_ga4a3194f4f741f9bd653f28733358f62c}{end}},}
\DoxyCodeLine{109                    \textcolor{keywordtype}{double} timestamp,}
\DoxyCodeLine{110                    PacketCallbackFunction\&\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}})}
\DoxyCodeLine{111     \{}
\DoxyCodeLine{112         \textcolor{keyword}{using} CallbackPtr = \textcolor{keyword}{decltype} (std::addressof (\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}}));}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 \textcolor{preprocessor}{       \#if JUCE\_MINGW}}
\DoxyCodeLine{115 \textcolor{preprocessor}{        \#define JUCE\_MINGW\_HIDDEN\_VISIBILITY \_\_attribute\_\_ ((visibility ("{}hidden"{}})))}
\DoxyCodeLine{116 \textcolor{preprocessor}{       \#else}}
\DoxyCodeLine{117 \textcolor{preprocessor}{        \#define JUCE\_MINGW\_HIDDEN\_VISIBILITY}}
\DoxyCodeLine{118 \textcolor{preprocessor}{       \#endif}}
\DoxyCodeLine{119 }
\DoxyCodeLine{120         \textcolor{keyword}{struct }\mbox{\hyperlink{juce___u_m_p_dispatcher_8h_ad7649b46e3d7a6e4f1716d25d9282710}{JUCE\_MINGW\_HIDDEN\_VISIBILITY}} Callback}
\DoxyCodeLine{121         \{}
\DoxyCodeLine{122             Callback (\mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher}{BytestreamToUMPDispatcher}}\& d, CallbackPtr \mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}})}
\DoxyCodeLine{123                 : \mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher_a40aaab0cd1153aa59a80d0b067f05f7a}{dispatch}} (d), callbackPtr (\mbox{\hyperlink{namespacegl_a1bde49b4e268a18d021f931060e1cbb1}{c}}) \{\}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125             \textcolor{keywordtype}{void} handleIncomingMidiMessage (\textcolor{keywordtype}{void}*, \textcolor{keyword}{const} \mbox{\hyperlink{class_midi_message}{MidiMessage}}\& msg)\textcolor{keyword}{ const}}
\DoxyCodeLine{126 \textcolor{keyword}{            }\{}
\DoxyCodeLine{127                 \mbox{\hyperlink{structuniversal__midi__packets_1_1_conversion_a0ec921efc63dcb4500f23aa301a7cbaa}{Conversion::toMidi1}} (msg, [\&] (\textcolor{keyword}{const} \mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}}\& view)}
\DoxyCodeLine{128                 \{}
\DoxyCodeLine{129                     \mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher_a40aaab0cd1153aa59a80d0b067f05f7a}{dispatch}}.converter.convert (view, *callbackPtr);}
\DoxyCodeLine{130                 \});}
\DoxyCodeLine{131             \}}
\DoxyCodeLine{132 }
\DoxyCodeLine{133             \textcolor{keywordtype}{void} handlePartialSysexMessage (\textcolor{keywordtype}{void}*, \textcolor{keyword}{const} uint8\_t*, \textcolor{keywordtype}{int}, \textcolor{keywordtype}{double})\textcolor{keyword}{ const }\{\}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135             \mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher}{BytestreamToUMPDispatcher}}\& \mbox{\hyperlink{classuniversal__midi__packets_1_1_bytestream_to_u_m_p_dispatcher_a40aaab0cd1153aa59a80d0b067f05f7a}{dispatch}};}
\DoxyCodeLine{136             CallbackPtr callbackPtr = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{137         \};}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 \textcolor{preprocessor}{       \#undef JUCE\_MINGW\_HIDDEN\_VISIBILITY}}
\DoxyCodeLine{140 }
\DoxyCodeLine{141         Callback inputCallback \{ *\textcolor{keyword}{this}, \&\mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}} \};}
\DoxyCodeLine{142         concatenator.\mbox{\hyperlink{class_midi_data_concatenator_a886ed5f92950c02e7e1343c6aee415b9}{pushMidiData}} (\mbox{\hyperlink{group__juce__core-files_ga3b8789907a46172ef0bdc8f656d6e355}{begin}}, \textcolor{keywordtype}{int} (\mbox{\hyperlink{group__juce__core-files_ga4a3194f4f741f9bd653f28733358f62c}{end}} -\/ \mbox{\hyperlink{group__juce__core-files_ga3b8789907a46172ef0bdc8f656d6e355}{begin}}), timestamp, (\textcolor{keywordtype}{void}*) \textcolor{keyword}{nullptr}, inputCallback);}
\DoxyCodeLine{143     \}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 \textcolor{keyword}{private}:}
\DoxyCodeLine{146     \mbox{\hyperlink{class_midi_data_concatenator}{MidiDataConcatenator}} concatenator;}
\DoxyCodeLine{147     \mbox{\hyperlink{classuniversal__midi__packets_1_1_generic_u_m_p_converter}{GenericUMPConverter}} converter;}
\DoxyCodeLine{148 \};}
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \textcolor{comment}{//==============================================================================}}
\DoxyCodeLine{158 \textcolor{comment}{}\textcolor{keyword}{class }\mbox{\hyperlink{classuniversal__midi__packets_1_1_to_bytestream_dispatcher}{ToBytestreamDispatcher}}}
\DoxyCodeLine{159 \{}
\DoxyCodeLine{160 \textcolor{keyword}{public}:}
\DoxyCodeLine{165     \textcolor{keyword}{explicit} \mbox{\hyperlink{classuniversal__midi__packets_1_1_to_bytestream_dispatcher_ae53ec72736baf5ba73979a449435106c}{ToBytestreamDispatcher}} (\textcolor{keywordtype}{int} storageSize)}
\DoxyCodeLine{166         : converter (storageSize) \{\}}
\DoxyCodeLine{167 }
\DoxyCodeLine{169     \textcolor{keywordtype}{void} \mbox{\hyperlink{classuniversal__midi__packets_1_1_to_bytestream_dispatcher_a2052e97a2dafa06d26c6a2b966adffdf}{reset}}()}
\DoxyCodeLine{170     \{}
\DoxyCodeLine{171         dispatcher.\mbox{\hyperlink{classuniversal__midi__packets_1_1_dispatcher_a68f661a45fcda7e76c3597fa62947873}{reset}}();}
\DoxyCodeLine{172         converter.\mbox{\hyperlink{structuniversal__midi__packets_1_1_to_bytestream_converter_a25e712cbe9355204f12b12e7d9667196}{reset}}();}
\DoxyCodeLine{173     \}}
\DoxyCodeLine{174 }
\DoxyCodeLine{183     \textcolor{keyword}{template} <\textcolor{keyword}{typename} BytestreamMessageCallback>}
\DoxyCodeLine{184     \textcolor{keywordtype}{void} \mbox{\hyperlink{classuniversal__midi__packets_1_1_to_bytestream_dispatcher_a95f7b7a0e29513905179abb613e3d7f1}{dispatch}} (\textcolor{keyword}{const} uint32\_t* \mbox{\hyperlink{group__juce__core-files_ga3b8789907a46172ef0bdc8f656d6e355}{begin}},}
\DoxyCodeLine{185                    \textcolor{keyword}{const} uint32\_t* \mbox{\hyperlink{group__juce__core-files_ga4a3194f4f741f9bd653f28733358f62c}{end}},}
\DoxyCodeLine{186                    \textcolor{keywordtype}{double} timestamp,}
\DoxyCodeLine{187                    BytestreamMessageCallback\&\& \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}})}
\DoxyCodeLine{188     \{}
\DoxyCodeLine{189         dispatcher.\mbox{\hyperlink{classuniversal__midi__packets_1_1_dispatcher_afbb4ca1ef9a0c018415bb76297dd0a21}{dispatch}} (\mbox{\hyperlink{group__juce__core-files_ga3b8789907a46172ef0bdc8f656d6e355}{begin}}, \mbox{\hyperlink{group__juce__core-files_ga4a3194f4f741f9bd653f28733358f62c}{end}}, timestamp, [\&] (\textcolor{keyword}{const} \mbox{\hyperlink{classuniversal__midi__packets_1_1_view}{View}}\& view, \textcolor{keywordtype}{double} time)}
\DoxyCodeLine{190         \{}
\DoxyCodeLine{191             converter.\mbox{\hyperlink{structuniversal__midi__packets_1_1_to_bytestream_converter_adc79b4d0eb9e2184c3eedd9485470609}{convert}} (view, time, \mbox{\hyperlink{juce__linux___a_l_s_a_8cpp_a7d161ccbd94169c2108f6a40711e3a76}{callback}});}
\DoxyCodeLine{192         \});}
\DoxyCodeLine{193     \}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195 \textcolor{keyword}{private}:}
\DoxyCodeLine{196     \mbox{\hyperlink{classuniversal__midi__packets_1_1_dispatcher}{Dispatcher}} dispatcher;}
\DoxyCodeLine{197     \mbox{\hyperlink{structuniversal__midi__packets_1_1_to_bytestream_converter}{ToBytestreamConverter}} converter;}
\DoxyCodeLine{198 \};}
\DoxyCodeLine{199 }
\DoxyCodeLine{200 \}}
\DoxyCodeLine{201 }
\DoxyCodeLine{202 }
\DoxyCodeLine{203 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{204 }

\end{DoxyCode}
